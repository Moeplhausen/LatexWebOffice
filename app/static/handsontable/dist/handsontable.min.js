var Handsontable=function(e,t){t=t||{};var o=new Handsontable.Core(e,t);return o.init(),o};Handsontable.plugins={},function(e,t){"use strict";function o(){this.refCounter=0,this.init()}function n(){function e(){var e=this;e._registerTimeout(setTimeout(function(){e.updateSettings({observeChanges:!0})},0))}function o(e){return function(t,o){return"string"==typeof t[1]&&(t[1]=t[1].toLowerCase()),"string"==typeof o[1]&&(o[1]=o[1].toLowerCase()),t[1]===o[1]?0:null===t[1]||""===t[1]?1:null===o[1]||""===o[1]?-1:t[1]<o[1]?e?-1:1:t[1]>o[1]?e?1:-1:0}}function n(e){return function(t,o){if(t[1]===o[1])return 0;if(null===t[1])return 1;if(null===o[1])return-1;var n=new Date(t[1]),r=new Date(o[1]);return r>n?e?-1:1:n>r?e?1:-1:0}}function r(e){return"undefined"!=typeof e.sortColumn}var i=this;this.init=function(t){var o,n,r=this,s=r.getSettings().columnSorting;if(r.sortingEnabled=!!s,r.sortingEnabled){r.sortIndex=[];var c=a.call(r);"undefined"!=typeof c?(o=c.sortColumn,n=c.sortOrder):(o=s.column,n=s.sortOrder),i.sortByColumn.call(r,o,n),r.sort=function(){var e=Array.prototype.slice.call(arguments);return i.sortByColumn.apply(r,e)},"undefined"==typeof r.getSettings().observeChanges&&e.call(r),"afterInit"==t&&(l.call(r),r.addHook("afterCreateRow",i.afterCreateRow),r.addHook("afterRemoveRow",i.afterRemoveRow),r.addHook("afterLoadData",i.init))}else delete r.sort,r.removeHook("afterCreateRow",i.afterCreateRow),r.removeHook("afterRemoveRow",i.afterRemoveRow),r.removeHook("afterLoadData",i.init)},this.setSortingColumn=function(e,t){var o=this;return"undefined"==typeof e?(delete o.sortColumn,void delete o.sortOrder):(o.sortOrder=o.sortColumn===e&&"undefined"==typeof t?!o.sortOrder:"undefined"!=typeof t?t:!0,void(o.sortColumn=e))},this.sortByColumn=function(e,o){var n=this;i.setSortingColumn.call(n,e,o),"undefined"!=typeof n.sortColumn&&(t.hooks.run(n,"beforeColumnSort",n.sortColumn,n.sortOrder),i.sort.call(n),n.render(),s.call(n),t.hooks.run(n,"afterColumnSort",n.sortColumn,n.sortOrder))};var s=function(){var e=this,o={};"undefined"!=typeof e.sortColumn&&(o.sortColumn=e.sortColumn),"undefined"!=typeof e.sortOrder&&(o.sortOrder=e.sortOrder),(o.hasOwnProperty("sortColumn")||o.hasOwnProperty("sortOrder"))&&t.hooks.run(e,"persistentStateSave","columnSorting",o)},a=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","columnSorting",o),o.value},l=function(){function e(){var e=n.view.TBODY.querySelector("tr").querySelectorAll("th");return e.length}function o(o){var n=t.Dom.closest(o,"TH");return t.Dom.index(n)-e()}var n=this,r=t.eventManager(n);r.addEventListener(n.rootElement,"click",function(e){if(t.Dom.hasClass(e.target,"columnSorting")){var r=o(e.target);i.sortByColumn.call(n,r)}})};this.sort=function(){var e=this;if("undefined"!=typeof e.sortOrder){e.sortingEnabled=!1,e.sortIndex.length=0;for(var t=this.colOffset(),r=0,i=this.countRows()-e.getSettings().minSpareRows;i>r;r++)this.sortIndex.push([r,e.getDataAtCell(r,this.sortColumn+t)]);var s,a=e.getCellMeta(0,e.sortColumn);switch(a.type){case"date":s=n;break;default:s=o}this.sortIndex.sort(s(e.sortOrder));for(var r=this.sortIndex.length;r<e.countRows();r++)this.sortIndex.push([r,e.getDataAtCell(r,this.sortColumn+t)]);e.sortingEnabled=!0}},this.translateRow=function(e){var t=this;return t.sortingEnabled&&t.sortIndex&&t.sortIndex.length&&t.sortIndex[e]?t.sortIndex[e][0]:e},this.untranslateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length)for(var o=0;o<t.sortIndex.length;o++)if(t.sortIndex[o][0]==e)return o},this.getColHeader=function(e,o){this.getSettings().columnSorting&&e>=0&&t.Dom.addClass(o.querySelector(".colHeader"),"columnSorting")},this.afterCreateRow=function(e,t){var o=this;if(r(o)){for(var n=0;n<o.sortIndex.length;n++)o.sortIndex[n][0]>=e&&(o.sortIndex[n][0]+=t);for(var n=0;t>n;n++)o.sortIndex.splice(e+n,0,[e+n,o.getData()[e+n][o.sortColumn+o.colOffset()]]);s.call(o)}},this.afterRemoveRow=function(e,t){var o=this;if(r(o)){var n=i.translateRow.call(o,e);o.sortIndex.splice(e,t);for(var a=0;a<o.sortIndex.length;a++)o.sortIndex[a][0]>n&&(o.sortIndex[a][0]-=t);s.call(o)}},this.afterChangeSort=function(e){var t=this,o=!1,n={};if(e){for(var r=0;r<e.length;r++)if(e[r][1]==t.sortColumn){o=!0,n.row=i.translateRow.call(t,e[r][0]),n.col=e[r][1];break}o&&t._registerTimeout(setTimeout(function(){i.sort.call(t),t.render(),t.selectCell(i.untranslateRow.call(t,n.row),n.col)},0))}}}function r(e){var o=t.eventManager(e),n=function(e,t,o,n){n.setCellMeta(e,t,"comment",o),n.render()},r=function(e,t,o){n(e.from.row,e.from.col,t,o)},i=function(){var e=c();e.style.display="none",e.value=""},s=function(n){function s(t){if(o.removeEventListener(document,"mouseover"),"htCommentTextArea"!=t.target.className&&-1==t.target.innerHTML.indexOf("Comment")){var s=document.querySelector(".htCommentTextArea").value;s.trim().length>1&&r(n,s,e),a(),i()}}o.addEventListener(document,"mousedown",t.helper.proxy(s))},a=function(){o.removeEventListener(document,"mousedown"),o.addEventListener(document,"mousedown",t.helper.proxy(h))},l=function(o,n){var r=e.view.wt.wtTable.getCell(o.from),i=t.Dom.offset(r),a=e.getColWidth(o.from.col);n.style.position="absolute",n.style.left=i.left+a+"px",n.style.top=i.top+"px",n.style.zIndex=2,s(o,n)},c=function(e){var o=document.querySelector(".htComments");if(!o){o=document.createElement("DIV");var n=document.createElement("TEXTAREA");t.Dom.addClass(n,"htCommentTextArea"),o.appendChild(n),t.Dom.addClass(o,"htComments"),document.getElementsByTagName("body")[0].appendChild(o)}return e=e||"",document.querySelector(".htCommentTextArea").value=e,o},h=function(o){if(-1!=o.target.className.indexOf("htCommentCell")){a();var n=e.view.wt.wtTable.getCoords(o.target),r={from:new u(n.row,n.col)};t.Comments.showComment(r)}else"htCommentTextArea"!=o.target.className&&i()};return{init:function(){o.addEventListener(document,"mouseover",t.helper.proxy(h))},showComment:function(t){var o=e.getCellMeta(t.from.row,t.from.col),n="";o.comment&&(n=o.comment);var r=c(n);r.style.display="block",l(t,r)},removeComment:function(t,o){e.removeCellMeta(t,o,"comment"),e.render()},checkSelectionCommentsConsistency:function(){var t=!1,o=e.getSelectedRange().from;return e.getCellMeta(o.row,o.col).comment&&(t=!0),t}}}function i(t){var o,n=function(){e.localStorage[t+"__persistentStateKeys"]=JSON.stringify(o)},r=function(){var n=e.localStorage[t+"__persistentStateKeys"],r="string"==typeof n?JSON.parse(n):void 0;o=r?r:[]},i=function(){o=[],n()};r(),this.saveValue=function(r,i){e.localStorage[t+"_"+r]=JSON.stringify(i),-1==o.indexOf(r)&&(o.push(r),n())},this.loadValue=function(o,n){o="undefined"!=typeof o?o:n;var r=e.localStorage[t+"_"+o];return"undefined"==typeof r?void 0:JSON.parse(r)},this.reset=function(o){e.localStorage.removeItem(t+"_"+o)},this.resetAll=function(){for(var n=0;n<o.length;n++)e.localStorage.removeItem(t+"_"+o[n]);i()}}function s(){this.boundaries=null,this.callback=null}function a(){var e=[];return e.getInfo=function(e,t){for(var o=0,n=this.length;n>o;o++)if(this[o].row<=e&&this[o].row+this[o].rowspan-1>=e&&this[o].col<=t&&this[o].col+this[o].colspan-1>=t)return this[o]},e.setInfo=function(e){for(var t=0,o=this.length;o>t;t++)if(this[t].row===e.row&&this[t].col===e.col)return void(this[t]=e);this.push(e)},e.removeInfo=function(e,t){for(var o=0,n=this.length;n>o;o++)if(this[o].row===e&&this[o].col===t){this.splice(o,1);break}},e}function l(e){if(this.mergedCellInfoCollection=new a,Array.isArray(e))for(var t=0,o=e.length;o>t;t++)this.mergedCellInfoCollection.setInfo(e[t])}function c(){}function h(e,o){var n,r=function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};var e=10,t=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var o={position:"absolute",height:t+"px",width:t+"px","border-radius":parseInt(t/1.5,10)+"px"};for(var n in o)this.selectionHandles.styles.bottomRightHitArea[n]=o[n],this.selectionHandles.styles.topLeftHitArea[n]=o[n];var r={position:"absolute",height:e+"px",width:e+"px","border-radius":parseInt(e/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var n in r)this.selectionHandles.styles.bottomRight[n]=r[n],this.selectionHandles.styles.topLeft[n]=r[n];this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)};if(o){var i=t.eventManager(e);this.instance=e,this.settings=o,this.main=document.createElement("div"),n=this.main.style,n.position="absolute",n.top=0,n.left=0;for(var s=["top","left","bottom","right","corner"],a=0;5>a;a++){var l=s[a],c=document.createElement("DIV");c.className="wtBorder "+(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(c.className+=" hidden"),n=c.style,n.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:o.border.color,n.height=this.settings[l]&&this.settings[l].width?this.settings[l].width+"px":o.border.width+"px",n.width=this.settings[l]&&this.settings[l].width?this.settings[l].width+"px":o.border.width+"px",this.main.appendChild(c)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width="5px",this.cornerStyle.height="5px",this.cornerStyle.border="2px solid #FFF",t.mobileBrowser&&r.call(this),this.disappear(),e.wtTable.bordersHolder||(e.wtTable.bordersHolder=document.createElement("div"),e.wtTable.bordersHolder.className="htBorders",e.wtTable.hider.appendChild(e.wtTable.bordersHolder)),e.wtTable.bordersHolder.insertBefore(this.main,e.wtTable.bordersHolder.firstChild);var h=!1;i.addEventListener(document.body,"mousedown",function(){h=!0}),i.addEventListener(document.body,"mouseup",function(){h=!1});for(var u=0,d=this.main.childNodes.length;d>u;u++)i.addEventListener(this.main.childNodes[u],"mouseenter",function(t){if(h&&e.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),t.stopImmediatePropagation();var o=this.getBoundingClientRect();this.style.display="none";var n=function(e){return e.clientY<Math.floor(o.top)?!0:e.clientY>Math.ceil(o.top+o.height)?!0:e.clientX<Math.floor(o.left)?!0:e.clientX>Math.ceil(o.left+o.width)?!0:void 0},r=function(e){n(e)&&(i.removeEventListener(document.body,"mousemove",r),this.style.display="block")};i.addEventListener(document.body,"mousemove",r)}})}}function u(e,t){"undefined"!=typeof e&&"undefined"!=typeof t?(this.row=e,this.col=t):(this.row=null,this.col=null)}function d(e,t,o){this.highlight=e,this.from=t,this.to=o}function f(e,t,o){this.offset=e,this.total=t,this.countTH=o}function p(e,t,o,n){var r,i=0;for(this.instance=e,this.containerSizeFn=t,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.visibleCellCount=0,this.remainingSize=0,this.strategy=n;;){if(r=o(i),void 0===r)break;this.cellSizesSum<this.getContainerSize()&&this.visibleCellCount++,this.cellSizes.push(r),this.cellSizesSum+=r,this.cellCount++,i++}var s=this.getContainerSize();this.remainingSize=this.cellSizesSum-s}function g(e){var o=[];if(this.guid="wt_"+v(),e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new k(this,e.table),this.wtScroll=new y(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new w(this),this.selections=this.cloneSource.selections):(this.wtSettings=new D(this,e),this.wtTable=new k(this,e.table),this.wtScroll=new y(this),this.wtViewport=new H(this),this.wtEvent=new w(this),this.selections=this.getSetting("selections"),this.wtScrollbars=new E(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;r>n;n++)o.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,n){t.Dom.fastInnerText(n,o[e])}])}this.drawn=!1,this.drawInterrupted=!1}function m(e){this.instance=e,this.init(),this.clone=this.makeClone("debug"),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",this.lastTimeout=null,t.Dom.addClass(this.clone.wtTable.holder.parentNode,"wtDebugVisible")}function w(o){var n=this,r=t.eventManager(o);this.instance=o;var i=[null,null];this.dblClickTimeout=[null,null];var s,a,l=function(e){var o=n.parentCell(e.target);t.Dom.hasClass(e.target,"corner")?n.instance.getSetting("onCellCornerMouseDown",e,e.target):o.TD&&n.instance.hasSetting("onCellMouseDown")&&n.instance.getSetting("onCellMouseDown",e,o.coords,o.TD,n.instance),2!==e.button&&o.TD&&(i[0]=o.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){i[0]=null},1e3))},c=function(){n.instance.touchMoving=!0},h=function(e){r.addEventListener(this,"touchmove",c),n.checkIfTouchMove=setTimeout(function(){return 1==n.instance.touchMoving?(n.instance.touchMoving=void 0,void r.removeEventListener("touchmove",c,!1)):void l(e)},30)},u=function(e){if(n.instance.hasSetting("onCellMouseOver")){var o=n.instance.wtTable.TABLE,r=t.Dom.closest(e.target,["TD","TH"],o);r&&r!==a&&t.Dom.isChildOf(r,o)&&(a=r,n.instance.getSetting("onCellMouseOver",e,n.instance.wtTable.getCoords(r),r,n.instance))}},d=function(e){if(2!==e.button){var o=n.parentCell(e.target);o.TD===i[0]&&o.TD===i[1]?(t.Dom.hasClass(e.target,"corner")?n.instance.getSetting("onCellCornerDblClick",e,o.coords,o.TD,n.instance):n.instance.getSetting("onCellDblClick",e,o.coords,o.TD,n.instance),i[0]=null,i[1]=null):o.TD===i[0]&&(i[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){i[1]=null},500))}},f=function(e){clearTimeout(s),e.preventDefault(),d(e)};if(r.addEventListener(this.instance.wtTable.holder,"mousedown",l),r.addEventListener(this.instance.wtTable.TABLE,"mouseover",u),r.addEventListener(this.instance.wtTable.holder,"mouseup",d),this.instance.wtTable.holder.parentNode.parentNode&&t.mobileBrowser){var p="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");r.addEventListener(this.instance.wtTable.holder.parentNode.parentNode,"touchstart",function(e){n.instance.touchApplied=!0,t.Dom.isChildOf(e.target,p)&&h.call(e.target,e)}),r.addEventListener(this.instance.wtTable.holder.parentNode.parentNode,"touchend",function(e){n.instance.touchApplied=!1,t.Dom.isChildOf(e.target,p)&&f.call(e.target,e)}),n.instance.momentumScrolling||(n.instance.momentumScrolling={}),r.addEventListener(this.instance.wtTable.holder.parentNode.parentNode,"scroll",function(){clearTimeout(n.instance.momentumScrolling._timeout),n.instance.momentumScrolling.ongoing||n.instance.getSetting("onBeforeTouchScroll"),n.instance.momentumScrolling.ongoing=!0,n.instance.momentumScrolling._timeout=setTimeout(function(){n.instance.touchApplied||(n.instance.momentumScrolling.ongoing=!1,n.instance.getSetting("onAfterMomentumScroll"))},200)})}r.addEventListener(e,"resize",function(){n.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),r.clear()}}function v(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function C(e,t,o){this.offset=e,this.total=t,this.countTH=o}function y(e){this.instance=e}function b(e){this.instance=e,this.type="corner",this.init(),this.clone=this.makeClone("corner")}function R(e){this.instance=e,this.type="horizontal",this.offset=0,this.init(),this.clone=this.makeClone("left")}function S(e){this.instance=e,this.type="vertical",this.init(),this.clone=this.makeClone("top")}function E(e){this.instance=e,e.update("scrollbarWidth",t.Dom.getScrollbarWidth()),e.update("scrollbarHeight",t.Dom.getScrollbarWidth()),this.vertical=new S(e),this.horizontal=new R(e),this.corner=new b(e),e.getSetting("debug")&&(this.debug=new m(e)),this.registerListeners()}function T(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={}}function D(e,o){var n=this;this.instance=e,this.defaults={table:void 0,debug:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,o,r){var i=n.getSetting("data",e,o);t.Dom.fastInnerText(r,void 0===i||null===i?"":i)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1},this.settings={};for(var r in this.defaults)if(this.defaults.hasOwnProperty(r))if(void 0!==o[r])this.settings[r]=o[r];else{if(void 0===this.defaults[r])throw new Error('A required setting "'+r+'" was not provided');this.settings[r]=this.defaults[r]}}function k(e,o){this.instance=e,this.TABLE=o,t.Dom.removeTextNodes(this.TABLE);var n=this.TABLE.parentNode;if(!n||1!==n.nodeType||!t.Dom.hasClass(n,"wtHolder")){var r=document.createElement("DIV");r.className="wtSpreader",n&&n.insertBefore(r,this.TABLE),r.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,n=this.spreader.parentNode,!n||1!==n.nodeType||!t.Dom.hasClass(n,"wtHolder")){var i=document.createElement("DIV");i.className="wtHider",n&&n.insertBefore(i,this.spreader),i.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,this.hiderStyle=this.hider.style,this.hiderStyle.position="relative",n=this.hider.parentNode,!n||1!==n.nodeType||!t.Dom.hasClass(n,"wtHolder")){var s=document.createElement("DIV");s.style.position="relative",s.className="wtHolder",e.cloneSource||(s.className+=" ht_master"),n&&n.insertBefore(s,this.hider),s.appendChild(this.hider)}if(this.holder=this.hider.parentNode,this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative"),this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var a=document.createElement("TR");this.THEAD.appendChild(a)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null}function A(e){this.wtTable=e,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.utils=A.utils}function H(o){this.instance=o,this.oversizedRows=[],this.oversizedCols=[];var n=this,r=t.eventManager(o);r.addEventListener(e,"resize",function(){n.clientHeight=n.getWorkspaceHeight()})}function x(e,t,o,n,r,i,s){this.scrollOffset=t,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.count=0,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s;var a,l,c=0,h=!0,u=50,d=[],f=1,p=function(e){f=f||1;var t=n(e);return void 0===t&&(t=u),t};for(this.refreshStretching=function(e){for(var t,n=0,r=0;o>r;r++)t=p(r),n+=t;var i=n-e;"all"===this.stretch&&0>i?this.stretchAllRatio=e/n:"last"===this.stretch&&1/0!==e&&(this.stretchLastWidth=-i+p(o-1))},a=0;o>a;a++)if(l=p(a),t>=c&&!i&&(this.startColumn=a),c>=t&&t+e>=c+l&&(null==this.startColumn&&(this.startColumn=a),this.endColumn=a),d.push(c),c+=l,i||(this.endColumn=a),c>=t+e){h=!1;break}if(this.endColumn==o-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){var g=d[this.endColumn]+l-d[this.startColumn-1];if((e>=g||!i)&&this.startColumn--,g>e)break}null!==this.startColumn&&r&&r(this),this.startPosition=d[this.startColumn],void 0==this.startPosition&&(this.startPosition=null),null!=this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}function O(e,t,o,n,r,i){this.scrollOffset=t,this.startRow=null,this.startPosition=null,this.endRow=null,this.count=0;for(var s,a=0,l=!0,c=23,h=[],u=0;o>u;u++)if(s=n(u),void 0===s&&(s=c),t>=a&&!i&&(this.startRow=u),a>=t&&t+e>=a+s&&(null==this.startRow&&(this.startRow=u),this.endRow=u),h.push(a),a+=s,i||(this.endRow=u),a>=t+e){l=!1;break}if(this.endRow==o-1&&l)for(this.startRow=this.endRow;this.startRow>0;){var d=h[this.endRow]+s-h[this.startRow-1];if((e>=d||!i)&&this.startRow--,d>=e)break}null!==this.startRow&&r&&r(this),this.startPosition=h[this.startRow],void 0==this.startPosition&&(this.startPosition=null),null!=this.startRow&&(this.count=this.endRow-this.startRow+1)}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,o=Number(arguments[1])||0;for(o=0>o?Math.ceil(o):Math.floor(o),0>o&&(o+=t);t>o;o++)if(o in this&&this[o]===e)return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e,t){function o(e){return/NodeList/i.test(e.item)}function n(e){for(var t=[],o=0,n=e.length;n>o;o++)t[o]=e[o];return t}if("undefined"==typeof this||null===this)throw new TypeError;if("function"!=typeof e)throw new TypeError;t=t||this,o(t)&&(t=n(t));var r,i,s=t.length,a=[];for(r=0;s>r;r+=1)t.hasOwnProperty(r)&&(i=t[r],e.call(t,i,r,t)&&a.push(i));return a}),Array.isArray||(Array.isArray=function(e){return"[object Array]"==toString.call(e)}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=o.length;return function(r){if("object"!=typeof r&&("function"!=typeof r||null===r))throw new TypeError("Object.keys called on non-object");var i,s,a=[];for(i in r)e.call(r,i)&&a.push(i);if(t)for(s=0;n>s;s++)e.call(r,o[s])&&a.push(o[s]);return a}}()),"undefined"==typeof WeakMap&&!function(){var t=Object.defineProperty;try{var o=!0;t(function(){},"foo",{})}catch(n){o=!1}var r=+new Date%1e9,i=function(){this.name="__st"+(1e9*Math.random()>>>0)+(r++ +"__"),o||(this._wmCache=[])};i.prototype=o?{set:function(e,o){var n=e[this.name];n&&n[0]===e?n[1]=o:t(e,this.name,{value:[e,o],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},"delete":function(e){this.set(e,void 0)}}:{set:function(e,t){if("undefined"!=typeof e&&"undefined"!=typeof t){for(var o=0,n=this._wmCache.length;n>o;o++)if(this._wmCache[o].key==e)return void(this._wmCache[o].value=t);this._wmCache.push({key:e,value:t})}},get:function(e){if("undefined"!=typeof e)for(var t=0,o=this._wmCache.length;o>t;t++)if(this._wmCache[t].key==e)return this._wmCache[t].value},"delete":function(e){if("undefined"!=typeof e)for(var t=0,o=this._wmCache.length;o>t;t++)this._wmCache[t].key==e&&Array.prototype.slice.call(this._wmCache,t,1)}},e.WeakMap=i}(),t.activeGuid=null,t.Core=function(e,o){function n(){var e=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty())}}}function r(e,o,r){function i(){var n;e.length&&(n=t.hooks.execute(v,"beforeChange",e,o),"function"==typeof n?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):n===!1&&e.splice(0,e.length)),r()}var s=new n;s.onQueueEmpty=i;for(var a=e.length-1;a>=0;a--)if(null===e[a])e.splice(a,1);else{var l=e[a][0],c=p.propToCol(e[a][1]),h=v.runHooksAndReturn("modifyCol",c),u=v.getCellMeta(l,h);if("numeric"===u.type&&"string"==typeof e[a][3]&&e[a][3].length>0&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(e[a][3])||u.format)){var d=e[a][3].length;numeral.language("undefined"==typeof u.language?"en":e[a][3].indexOf(".")===d-3&&-1===e[a][3].indexOf(",")?"en":u.language),e[a][3]=numeral().unformat(e[a][3]||"0")}v.getCellValidator(u)&&(s.addValidatorToQueue(),v.validateCell(e[a][3],u,function(t,o){return function(n){if("boolean"!=typeof n)throw new Error("Validation error: result is not boolean");n===!1&&o.allowInvalid===!1&&(e.splice(t,1),o.valid=!0,--t),s.removeValidatorFormQueue()}}(a,u),o))}s.checkIfQueueIsEmpty()}function i(e,o){var n=e.length-1;if(!(0>n)){for(;n>=0;n--)if(null!==e[n]){if(null!=e[n][2]||null!=e[n][3]){if(f.settings.allowInsertRow)for(;e[n][0]>v.countRows()-1;)p.createRow();if("array"===v.dataType&&f.settings.allowInsertColumn)for(;p.propToCol(e[n][1])>v.countCols()-1;)p.createCol();p.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1);v.forceFullRender=!0,g.adjustRowsAndCols(),t.hooks.run(v,"beforeChangeRender",e,o),m.refreshBorders(null,!0),t.hooks.run(v,"afterChange",e,o||"edit")}}function s(e,t,o){return"object"==typeof e?e:[[e,t,o]]}function a(e){if(e.hasOwnProperty("type")){var o,n={};if("object"==typeof e.type)o=e.type;else if("string"==typeof e.type&&(o=t.cellTypes[e.type],void 0===o))throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var r in o)o.hasOwnProperty(r)&&!e.hasOwnProperty(r)&&(n[r]=o[r]);return n}}function l(e){return t.hooks.execute(v,"modifyRow",e)}function c(e){return t.hooks.execute(v,"modifyCol",e)}function h(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var f,p,g,m,w,v=this,C=function(){},y=t.eventManager(v);t.helper.extend(C.prototype,P.prototype),t.helper.extend(C.prototype,o),t.helper.extend(C.prototype,a(o)),this.rootElement=e,this.container=document.createElement("DIV"),this.container.className="htContainer",e.insertBefore(this.container,e.firstChild),this.guid="ht_"+t.helper.randomString(),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),f={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new C,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},g={alter:function(e,t,o,n,r){var i;switch(o=o||1,e){case"insert_row":i=p.createRow(t,o),i&&(m.isSelected()&&f.selRange.from.row>=t?(f.selRange.from.row=f.selRange.from.row+i,m.transformEnd(i,0)):m.refreshBorders());break;case"insert_col":if(i=p.createCol(t,o)){if(Array.isArray(v.getSettings().colHeaders)){var s=[t,0];s.length+=i,Array.prototype.splice.apply(v.getSettings().colHeaders,s)}m.isSelected()&&f.selRange.from.col>=t?(f.selRange.from.col=f.selRange.from.col+i,m.transformEnd(0,i)):m.refreshBorders()}break;case"remove_row":t=v.runHooksAndReturn("modifyCol",t),p.removeRow(t,o),f.cellSettings.splice(t,o),g.adjustRowsAndCols(),m.refreshBorders();break;case"remove_col":p.removeCol(t,o);for(var a=0,l=p.getAll().length;l>a;a++)a in f.cellSettings&&f.cellSettings[a].splice(t,o);Array.isArray(v.getSettings().colHeaders)&&("undefined"==typeof t&&(t=-1),v.getSettings().colHeaders.splice(t,o)),g.adjustRowsAndCols(),m.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}r||g.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t,o,n;if(t=v.countRows(),t<f.settings.minRows)for(e=0;e<f.settings.minRows-t;e++)p.createRow(v.countRows(),1,!0);if(o=v.countEmptyRows(!0),o<f.settings.minSpareRows)for(;o<f.settings.minSpareRows&&v.countRows()<f.settings.maxRows;o++)p.createRow(v.countRows(),1,!0);if(n=v.countEmptyCols(!0),!f.settings.columns&&v.countCols()<f.settings.minCols)for(;v.countCols()<f.settings.minCols;n++)p.createCol(v.countCols(),1,!0);if(!f.settings.columns&&"array"===v.dataType&&n<f.settings.minSpareCols)for(;n<f.settings.minSpareCols&&v.countCols()<f.settings.maxCols;n++)p.createCol(v.countCols(),1,!0);var r=v.countRows(),i=v.countCols();if((0===r||0===i)&&m.deselect(),m.isSelected()){var s,a=f.selRange.from.row,l=f.selRange.from.col,c=f.selRange.to.row,h=f.selRange.to.col;a>r-1?(a=r-1,s=!0,c>a&&(c=a)):c>r-1&&(c=r-1,s=!0,a>c&&(a=c)),l>i-1?(l=i-1,s=!0,h>l&&(h=l)):h>i-1&&(h=i-1,s=!0,l>h&&(l=h)),s&&v.selectCell(a,l,c,h)}},populateFromArray:function(e,o,n,r,i,s,a){var l,c,h,u,d=[],p={};if(c=o.length,0===c)return!1;var g,m,w,C;switch(i){case"shift_down":for(g=n?n.col-e.col+1:0,m=n?n.row-e.row+1:0,o=t.helper.translateRowsToColumns(o),h=0,u=o.length,w=Math.max(u,g);w>h;h++)if(u>h){for(l=0,c=o[h].length;m-c>l;l++)o[h].push(o[h][l%c]);o[h].unshift(e.col+h,e.row,0),v.spliceCol.apply(v,o[h])}else o[h%u][0]=e.col+h,v.spliceCol.apply(v,o[h%u]);break;case"shift_right":for(g=n?n.col-e.col+1:0,m=n?n.row-e.row+1:0,l=0,c=o.length,C=Math.max(c,m);C>l;l++)if(c>l){for(h=0,u=o[l].length;g-u>h;h++)o[l].push(o[l][h%u]);o[l].unshift(e.row+l,e.col,0),v.spliceRow.apply(v,o[l])}else o[l%c][0]=e.row+l,v.spliceRow.apply(v,o[l%c]);break;case"overwrite":default:p.row=e.row,p.col=e.col;var y={row:0,col:0},b={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1};for(-1!==["up","left"].indexOf(s)?y={row:Math.ceil(b.row/c)||1,col:Math.ceil(b.col/o[0].length)||1}:-1!==["down","right"].indexOf(s)&&(y={row:1,col:1}),l=0;c>l&&!(n&&p.row>n.row||!f.settings.allowInsertRow&&p.row>v.countRows()-1||p.row>=f.settings.maxRows);l++){for(p.col=e.col,u=o[l]?o[l].length:0,h=0;u>h&&!(n&&p.col>n.col||!f.settings.allowInsertColumn&&p.col>v.countCols()-1||p.col>=f.settings.maxCols);h++){if(!v.getCellMeta(p.row,p.col).readOnly){var R,S=o[l][h],E={row:l,col:h};"autofill"===r&&(R=v.runHooksAndReturn("beforeAutofillInsidePopulate",E,s,o,a,y,b),R&&(y="undefined"!=typeof R.iterators?R.iterators:y,S="undefined"!=typeof R.value?R.value:S)),d.push([p.row,p.col,S])}p.col++,n&&h===u-1&&(h=-1,-1!==["down","right"].indexOf(s)?y.col++:-1!==["up","left"].indexOf(s)&&y.col>1&&y.col--)}p.row++,y.col=1,n&&l===c-1&&(l=-1,-1!==["down","right"].indexOf(s)?y.row++:-1!==["up","left"].indexOf(s)&&y.row>1&&y.row--)}v.setDataAtCell(d,null,null,r||"populateFromArray")}}},this.selection=m={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(e,t){v.selection.selectedHeader.rows=e,v.selection.selectedHeader.cols=t},begin:function(){v.selection.inProgress=!0},finish:function(){var e=v.getSelected();t.hooks.run(v,"afterSelectionEnd",e[0],e[1],e[2],e[3]),t.hooks.run(v,"afterSelectionEndByProp",e[0],v.colToProp(e[1]),e[2],v.colToProp(e[3])),v.selection.inProgress=!1},isInProgress:function(){return v.selection.inProgress},setRangeStart:function(e,o){t.hooks.run(v,"beforeSetRangeStart",e),f.selRange=new d(e,e,e),m.setRangeEnd(e,null,o)},setRangeEnd:function(e,o,n){t.hooks.run(v,"beforeSetRangeEnd",e),v.selection.begin(),f.selRange.to=new u(e.row,e.col),f.settings.multiSelect||(f.selRange.from=e),v.view.wt.selections.current.clear(),v.view.wt.selections.current.add(f.selRange.highlight),v.view.wt.selections.area.clear(),m.isMultiple()&&(v.view.wt.selections.area.add(f.selRange.from),v.view.wt.selections.area.add(f.selRange.to)),(f.settings.currentRowClassName||f.settings.currentColClassName)&&(v.view.wt.selections.highlight.clear(),v.view.wt.selections.highlight.add(f.selRange.from),v.view.wt.selections.highlight.add(f.selRange.to)),t.hooks.run(v,"afterSelection",f.selRange.from.row,f.selRange.from.col,f.selRange.to.row,f.selRange.to.col),t.hooks.run(v,"afterSelectionByProp",f.selRange.from.row,p.colToProp(f.selRange.from.col),f.selRange.to.row,p.colToProp(f.selRange.to.col)),o!==!1&&v.view.mainViewIsActive()&&v.view.scrollViewport(e),m.refreshBorders(null,n)
},refreshBorders:function(e,t){t||w.destroyEditor(e),v.view.render(),m.isSelected()&&!t&&w.prepareEditor()},isMultiple:function(){var e=!(f.selRange.to.col===f.selRange.from.col&&f.selRange.to.row===f.selRange.from.row),o=t.hooks.execute(v,"afterIsMultipleSelection",e);return e?o:void 0},transformStart:function(e,t,o,n){var r=new u(e,t);v.runHooks("modifyTransformStart",r),f.selRange.highlight.row+e>v.countRows()-1?o&&f.settings.minSpareRows>0?v.alter("insert_row",v.countRows()):f.settings.autoWrapCol&&(r.row=1-v.countRows(),r.col=f.selRange.highlight.col+r.col==v.countCols()-1?1-v.countCols():1):f.settings.autoWrapCol&&f.selRange.highlight.row+r.row<0&&f.selRange.highlight.col+r.col>=0&&(r.row=v.countRows()-1,r.col=f.selRange.highlight.col+r.col==0?v.countCols()-1:-1),f.selRange.highlight.col+r.col>v.countCols()-1?o&&f.settings.minSpareCols>0?v.alter("insert_col",v.countCols()):f.settings.autoWrapRow&&(r.row=f.selRange.highlight.row+r.row==v.countRows()-1?1-v.countRows():1,r.col=1-v.countCols()):f.settings.autoWrapRow&&f.selRange.highlight.col+r.col<0&&f.selRange.highlight.row+r.row>=0&&(r.row=f.selRange.highlight.row+r.row==0?v.countRows()-1:-1,r.col=v.countCols()-1);var i=v.countRows(),s=v.countCols(),a=new u(f.selRange.highlight.row+r.row,f.selRange.highlight.col+r.col);a.row<0?a.row=0:a.row>0&&a.row>=i&&(a.row=i-1),a.col<0?a.col=0:a.col>0&&a.col>=s&&(a.col=s-1),m.setRangeStart(a,n)},transformEnd:function(e,t){var o=new u(e,t);v.runHooks("modifyTransformEnd",o);var n=v.countRows(),r=v.countCols(),i=new u(f.selRange.to.row+o.row,f.selRange.to.col+o.col);i.row<0?i.row=0:i.row>0&&i.row>=n&&(i.row=n-1),i.col<0?i.col=0:i.col>0&&i.col>=r&&(i.col=r-1),m.setRangeEnd(i)},isSelected:function(){return null!==f.selRange},inInSelection:function(e){return m.isSelected()?f.selRange.includes(e):!1},deselect:function(){m.isSelected()&&(v.selection.inProgress=!1,f.selRange=null,v.view.wt.selections.current.clear(),v.view.wt.selections.area.clear(),(f.settings.currentRowClassName||f.settings.currentColClassName)&&v.view.wt.selections.highlight.clear(),w.destroyEditor(),m.refreshBorders(),t.hooks.run(v,"afterDeselect"))},selectAll:function(){f.settings.multiSelect&&(m.setRangeStart(new u(0,0)),m.setRangeEnd(new u(v.countRows()-1,v.countCols()-1),!1))},empty:function(){if(m.isSelected()){var e,t,o=f.selRange.getTopLeftCorner(),n=f.selRange.getBottomRightCorner(),r=[];for(e=o.row;e<=n.row;e++)for(t=o.col;t<=n.col;t++)v.getCellMeta(e,t).readOnly||r.push([e,t,""]);v.setDataAtCell(r)}}},this.init=function(){t.hooks.run(v,"beforeInit"),t.mobileBrowser&&t.Dom.addClass(v.rootElement,"mobile"),this.updateSettings(f.settings,!0),this.view=new t.TableView(this),w=new t.EditorManager(v,f,m,p),this.forceFullRender=!0,this.view.render(),"object"==typeof f.firstRun&&(t.hooks.run(v,"afterChange",f.firstRun[0],f.firstRun[1]),f.firstRun=!1),t.hooks.run(v,"afterInit")},this.validateCell=function(e,o,n,r){var i=v.getCellValidator(o);"[object RegExp]"===Object.prototype.toString.call(i)&&(i=function(e){return function(t,o){o(e.test(t))}}(i)),"function"==typeof i?(e=t.hooks.execute(v,"beforeValidate",e,o.row,o.prop,r),v._registerTimeout(setTimeout(function(){return i.call(o,e,function(i){o.valid=i,i=t.hooks.execute(v,"afterValidate",i,e,o.row,o.prop,r),n(i)}),e},0))):(o.valid=!0,n(!0))},this.setDataAtCell=function(e,t,o,n){var a,l,c,h=s(e,t,o),u=[];for(a=0,l=h.length;l>a;a++){if("object"!=typeof h[a])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof h[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=p.colToProp(h[a][1]),u.push([h[a][0],c,p.get(h[a][0],c),h[a][2]])}n||"object"!=typeof e||(n=t),r(u,n,function(){i(u,n)})},this.setDataAtRowProp=function(e,t,o,n){var a,l,c=s(e,t,o),h=[];for(a=0,l=c.length;l>a;a++)h.push([c[a][0],c[a][1],p.get(c[a][0],c[a][1]),c[a][2]]);n||"object"!=typeof e||(n=t),r(h,n,function(){i(h,n)})},this.listen=function(){t.activeGuid=v.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){t.activeGuid=null},this.isListening=function(){return t.activeGuid===v.guid},this.destroyEditor=function(e){m.refreshBorders(e)},this.populateFromArray=function(e,t,o,n,r,i,s,a,l){if("object"!=typeof o||"object"!=typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return g.populateFromArray(new u(e,t),o,"number"==typeof n?new u(n,r):null,i,s,a,l)},this.spliceCol=function(){return p.spliceCol.apply(p,arguments)},this.spliceRow=function(){return p.spliceRow.apply(p,arguments)},this.getSelected=function(){return m.isSelected()?[f.selRange.from.row,f.selRange.from.col,f.selRange.to.row,f.selRange.to.col]:void 0},this.getSelectedRange=function(){return m.isSelected()?f.selRange:void 0},this.render=function(){v.view&&(v.forceFullRender=!0,m.refreshBorders(null,!0))},this.loadData=function(e){function o(){f.cellSettings.length=0}if("object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)");e=[];for(var n,r=0,i=f.settings.startRows;i>r;r++){n=[];for(var s=0,a=f.settings.startCols;a>s;s++)n.push(null);e.push(n)}}f.isPopulated=!1,C.prototype.data=e,v.dataType=Array.isArray(f.settings.dataSchema)||Array.isArray(e[0])?"array":"function"==typeof f.settings.dataSchema?"function":"object",p=new t.DataMap(v,f,C),o(),g.adjustRowsAndCols(),t.hooks.run(v,"afterLoadData"),f.firstRun?f.firstRun=[null,"loadData"]:(t.hooks.run(v,"afterChange",null,"loadData"),v.render()),f.isPopulated=!0},this.getData=function(e,t,o,n){return"undefined"==typeof e?p.getAll():p.getRange(new u(e,t),new u(o,n),p.DESTINATION_RENDERER)},this.getCopyableData=function(e,t,o,n){return p.getCopyableText(new u(e,t),new u(o,n))},this.updateSettings=function(e,o){var n,r;if("undefined"!=typeof e.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if("undefined"!=typeof e.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(n in e)"data"!==n&&(void 0!==t.hooks.hooks[n]||void 0!==t.hooks.legacy[n]?("function"==typeof e[n]||Array.isArray(e[n]))&&v.addHook(n,e[n]):!o&&e.hasOwnProperty(n)&&(C.prototype[n]=e[n]));if(void 0===e.data&&void 0===f.settings.data?v.loadData(null):void 0!==e.data?v.loadData(e.data):void 0!==e.columns&&p.createMap(),r=v.countCols(),f.cellSettings.length=0,r>0){var i,s;for(n=0;r>n;n++)f.columnSettings[n]=t.helper.columnFactory(C,f.columnsSettingConflicts),i=f.columnSettings[n].prototype,C.prototype.columns&&(s=C.prototype.columns[n],t.helper.extend(i,s),t.helper.extend(i,a(s)))}if("undefined"!=typeof e.cell)for(n in e.cell){var l=e.cell[n];v.setCellMetaObject(l.row,l.col,l)}if(t.hooks.run(v,"afterCellMetaReset"),"undefined"!=typeof e.className&&(C.prototype.className&&t.Dom.removeClass(v.rootElement,C.prototype.className),e.className&&t.Dom.addClass(v.rootElement,e.className)),"undefined"!=typeof e.height){var c=e.height;"function"==typeof c&&(c=c()),v.rootElement.style.height=c+"px"}if("undefined"!=typeof e.width){var h=e.width;"function"==typeof h&&(h=h()),v.rootElement.style.width=h+"px"}c&&(v.rootElement.style.overflow="auto"),o||t.hooks.run(v,"afterUpdateSettings"),g.adjustRowsAndCols(),v.view&&!f.firstRun&&(v.forceFullRender=!0,m.refreshBorders(null,!0))},this.getValue=function(){var e=v.getSelected();if(C.prototype.getValue){if("function"==typeof C.prototype.getValue)return C.prototype.getValue.call(v);if(e)return v.getData()[e[0]][C.prototype.getValue]}else if(e)return v.getDataAtCell(e[0],e[1])},this.getSettings=function(){return f.settings},this.clear=function(){m.selectAll(),m.empty()},this.alter=function(e,t,o,n,r){g.alter(e,t,o,n,r)},this.getCell=function(e,t,o){return v.view.getCellAtCoords(new u(e,t),o)},this.getCoords=function(e){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,e)},this.colToProp=function(e){return p.colToProp(e)},this.propToCol=function(e){return p.propToCol(e)},this.getDataAtCell=function(e,t){return p.get(e,p.colToProp(t))},this.getDataAtRowProp=function(e,t){return p.get(e,t)},this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,p.getRange(new u(0,e),new u(f.settings.data.length-1,e),p.DESTINATION_RENDERER))},this.getDataAtProp=function(e){var t=[];return t.concat.apply(t,p.getRange(new u(0,p.propToCol(e)),new u(f.settings.data.length-1,p.propToCol(e)),p.DESTINATION_RENDERER))},this.getSourceDataAtCol=function(e){for(var t=[],o=f.settings.data,n=0;n<o.length;n++)t.push(o[n][e]);return t},this.getSourceDataAtRow=function(e){return f.settings.data[e]},this.getDataAtRow=function(e){var t=p.getRange(new u(e,0),new u(e,this.countCols()-1),p.DESTINATION_RENDERER);return t[0]},this.removeCellMeta=function(e,t,o){var n=v.getCellMeta(e,t);void 0!=n[o]&&delete f.cellSettings[e][t][o]},this.setCellMetaObject=function(e,t,o){if("object"==typeof o)for(var n in o){var r=o[n];this.setCellMeta(e,t,n,r)}},this.setCellMeta=function(e,o,n,r){f.cellSettings[e]||(f.cellSettings[e]=[]),f.cellSettings[e][o]||(f.cellSettings[e][o]=new f.columnSettings[o]),f.cellSettings[e][o][n]=r,t.hooks.run(v,"afterSetCellMeta",e,o,n,r)},this.getCellMeta=function(e,o){var n,r=p.colToProp(o);if(e=l(e),o=c(o),f.columnSettings[o]||(f.columnSettings[o]=t.helper.columnFactory(C,f.columnsSettingConflicts)),f.cellSettings[e]||(f.cellSettings[e]=[]),f.cellSettings[e][o]||(f.cellSettings[e][o]=new f.columnSettings[o]),n=f.cellSettings[e][o],n.row=e,n.col=o,n.prop=r,n.instance=v,t.hooks.run(v,"beforeGetCellMeta",e,o,n),t.helper.extend(n,a(n)),n.cells){var i=n.cells.call(n,e,o,r);i&&(t.helper.extend(n,i),t.helper.extend(n,a(i)))}return t.hooks.run(v,"afterGetCellMeta",e,o,n),n};var b=t.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(e,o){var n=b.call(this,e,o);return t.renderers.getRenderer(n)},this.getCellEditor=t.helper.cellMethodLookupFactory("editor"),this.getCellValidator=t.helper.cellMethodLookupFactory("validator"),this.validateCells=function(e){var t=new n;t.onQueueEmpty=e;for(var o=v.countRows()-1;o>=0;){for(var r=v.countCols()-1;r>=0;)t.addValidatorToQueue(),v.validateCell(v.getDataAtCell(o,r),v.getCellMeta(o,r),function(){t.removeValidatorFormQueue()},"validateCells"),r--;o--}t.checkIfQueueIsEmpty()},this.getRowHeader=function(e){if(void 0===e){for(var t=[],o=0,n=v.countRows();n>o;o++)t.push(v.getRowHeader(o));return t}return Array.isArray(f.settings.rowHeaders)&&void 0!==f.settings.rowHeaders[e]?f.settings.rowHeaders[e]:"function"==typeof f.settings.rowHeaders?f.settings.rowHeaders(e):f.settings.rowHeaders&&"string"!=typeof f.settings.rowHeaders&&"number"!=typeof f.settings.rowHeaders?e+1:f.settings.rowHeaders},this.hasRowHeaders=function(){return!!f.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==f.settings.colHeaders&&null!==f.settings.colHeaders)return!!f.settings.colHeaders;for(var e=0,t=v.countCols();t>e;e++)if(v.getColHeader(e))return!0;return!1},this.getColHeader=function(e){if(void 0===e){for(var o=[],n=0,r=v.countCols();r>n;n++)o.push(v.getColHeader(n));return o}var i=e;return e=t.hooks.execute(v,"modifyCol",e),f.settings.columns&&f.settings.columns[e]&&f.settings.columns[e].title?f.settings.columns[e].title:Array.isArray(f.settings.colHeaders)&&void 0!==f.settings.colHeaders[e]?f.settings.colHeaders[e]:"function"==typeof f.settings.colHeaders?f.settings.colHeaders(e):f.settings.colHeaders&&"string"!=typeof f.settings.colHeaders&&"number"!=typeof f.settings.colHeaders?t.helper.spreadsheetColumnLabel(i):f.settings.colHeaders},this._getColWidthFromSettings=function(e){var t=v.getCellMeta(0,e),o=t.width;if((void 0===o||o===f.settings.width)&&(o=t.colWidths),void 0!==o&&null!==o){switch(typeof o){case"object":o=o[e];break;case"function":o=o(e)}"string"==typeof o&&(o=parseInt(o,10))}return o},this.getColWidth=function(e){var o=v._getColWidthFromSettings(e);return o||(o=50),o=t.hooks.execute(v,"modifyColWidth",o,e)},this._getRowHeightFromSettings=function(e){var t=f.settings.rowHeights;if(void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var o=v._getRowHeightFromSettings(e);return o=t.hooks.execute(v,"modifyRowHeight",o,e)},this.countRows=function(){return f.settings.data.length},this.countCols=function(){return"object"===v.dataType||"function"===v.dataType?f.settings.columns&&f.settings.columns.length?f.settings.columns.length:p.colToPropCache.length:"array"===v.dataType?f.settings.columns&&f.settings.columns.length?f.settings.columns.length:f.settings.data&&f.settings.data[0]&&f.settings.data[0].length?f.settings.data[0].length:0:void 0},this.rowOffset=function(){return v.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return v.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return v.view.wt.drawn?v.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return v.view.wt.drawn?v.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return v.view.wt.drawn?v.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return v.view.wt.drawn?v.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(e){for(var o,n=v.countRows()-1,r=0;n>=0;){if(o=t.hooks.execute(this,"modifyRow",n),v.isEmptyRow(o))r++;else if(e)break;n--}return r},this.countEmptyCols=function(e){if(v.countRows()<1)return 0;for(var t=v.countCols()-1,o=0;t>=0;){if(v.isEmptyCol(t))o++;else if(e)break;t--}return o},this.isEmptyRow=function(e){return f.settings.isEmptyRow.call(v,e)},this.isEmptyCol=function(e){return f.settings.isEmptyCol.call(v,e)},this.selectCell=function(e,t,o,n,r){if("number"!=typeof e||0>e||e>=v.countRows())return!1;if("number"!=typeof t||0>t||t>=v.countCols())return!1;if("undefined"!=typeof o){if("number"!=typeof o||0>o||o>=v.countRows())return!1;if("number"!=typeof n||0>n||n>=v.countCols())return!1}var i=new u(e,t);return f.selRange=new d(i,i,i),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),v.listen(),"undefined"==typeof o?m.setRangeEnd(f.selRange.from,r):m.setRangeEnd(new u(o,n),r),v.selection.finish(),!0},this.selectCellByProp=function(){return arguments[1]=p.propToCol(arguments[1]),"undefined"!=typeof arguments[3]&&(arguments[3]=p.propToCol(arguments[3])),v.selectCell.apply(v,arguments)},this.deselectCell=function(){m.deselect()},this.destroy=function(){v._clearTimeouts(),v.view&&v.view.destroy(),t.Dom.empty(v.rootElement),y.clear(),t.hooks.run(v,"afterDestroy"),t.hooks.destroy(v);for(var e in v)v.hasOwnProperty(e)&&("function"==typeof v[e]?"runHooks"!==e&&"runHooksAndReturn"!==e&&(v[e]=h):"guid"!==e&&(v[e]=null));f=null,p=null,g=null,m=null,w=null,v=null,C=null},this.getActiveEditor=function(){return w.getActiveEditor()},this.getInstance=function(){return v},this.addHook=function(e,o){t.hooks.add(e,o,v)},this.addHookOnce=function(e,o){t.hooks.once(e,o,v)},this.removeHook=function(e,o){t.hooks.remove(e,o,v)},this.runHooks=function(e,o,n,r,i,s,a){t.hooks.run(v,e,o,n,r,i,s,a)},this.runHooksAndReturn=function(e,o,n,r,i,s,a){return t.hooks.execute(v,e,o,n,r,i,s,a)},this.timeouts=[],this._registerTimeout=function(e){this.timeouts.push(e)},this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;t>e;e++)clearTimeout(this.timeouts[e])},this.version="0.12.3"};var P=function(){};if(P.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(e){for(var t,o=0,n=this.countCols();n>o;o++)if(t=this.getDataAtCell(e,o),""!==t&&null!==t&&"undefined"!=typeof t)return!1;return!0},isEmptyCol:function(e){for(var t,o=0,n=this.countRows();n>o;o++)if(t=this.getDataAtCell(o,e),""!==t&&null!==t&&"undefined"!=typeof t)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,type:"text",copyable:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,viewportRowRenderingOffset:10,viewportColumnRenderingOffset:10,groups:void 0},t.DefaultSettings=P,function(e){function t(){function e(e){return null!==e&&!o(e)&&("string"==typeof e||"number"==typeof e)}function t(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function o(e){return e!==e}var n={arrayMap:[],weakMap:new WeakMap};return{get:function(o){return e(o)?n.arrayMap[o]:t(o)?n.weakMap.get(o):void 0},set:function(o,r){if(e(o))n.arrayMap[o]=r;else{if(!t(o))throw new Error("Invalid key type");n.weakMap.set(o,r)}},"delete":function(o){e(o)?delete n.arrayMap[o]:t(o)&&n.weakMap["delete"](o)}}}e.MultiMap||(e.MultiMap=t)}(e),!e.Handsontable)var t={};if(t.Dom={},t.Dom.enableImmediatePropagation=function(e){null!=e&&null==e.isImmediatePropagationEnabled&&(e.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1,this.cancelBubble=!0},e.isImmediatePropagationEnabled=!0,e.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled})},t.Dom.closest=function(e,t,o){for(;null!=e&&e!==o;){if(1===e.nodeType&&t.indexOf(e.nodeName)>-1)return e;e=e.parentNode}return null},t.Dom.isChildOf=function(e,t){var o=e.parentNode,n=[];for("string"==typeof t?n=Array.prototype.slice.call(document.querySelectorAll(t),0):n.push(t);null!=o;){if(n.indexOf(o)>-1)return!0;o=o.parentNode}return!1},t.Dom.index=function(e){var t=0;if(e.previousSibling)for(;e=e.previousSibling;)++t;return t},document.documentElement.classList?(t.Dom.hasClass=function(e,t){return e.classList.contains(t)},t.Dom.addClass=function(e,t){t&&e.classList.add(t)},t.Dom.removeClass=function(e,t){e.classList.remove(t)}):(t.Dom.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},t.Dom.addClass=function(e,t){""==e.className?e.className=t:this.hasClass(e,t)||(e.className+=" "+t)},t.Dom.removeClass=function(e,t){if(this.hasClass(e,t)){var o=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(o," ").trim()}}),t.Dom.removeTextNodes=function(e,t){if(3===e.nodeType)t.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var o=e.childNodes,n=o.length-1;n>=0;n--)this.removeTextNodes(o[n],e)},t.Dom.empty=function(e){for(var t;t=e.lastChild;)e.removeChild(t)},t.Dom.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,t.Dom.fastInnerHTML=function(e,t){this.HTML_CHARACTERS.test(t)?e.innerHTML=t:this.fastInnerText(e,t)},t.Dom.fastInnerText=document.createTextNode("test").textContent?function(e,t){var o=e.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=t:(this.empty(e),e.appendChild(document.createTextNode(t)))}:function(e,t){var o=e.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.data=t:(this.empty(e),e.appendChild(document.createTextNode(t)))},t.Dom.isVisible=function(e){for(var o=e;o!==document.documentElement;){if(null===o)return!1;if(11===o.nodeType){if(o.host){if(o.host.impl)return t.Dom.isVisible(o.host.impl);if(o.host)return t.Dom.isVisible(o.host);throw new Error("Lost in Web Components world")}return!1}if("none"===o.style.display)return!1;o=o.parentNode}return!0},t.Dom.offset=function(t){var o,n,r,i,s;if(i=document.documentElement,this.hasCaptionProblem()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName)return s=t.getBoundingClientRect(),{top:s.top+(e.pageYOffset||i.scrollTop)-(i.clientTop||0),left:s.left+(e.pageXOffset||i.scrollLeft)-(i.clientLeft||0)};for(o=t.offsetLeft,n=t.offsetTop,r=t;(t=t.offsetParent)&&t!==document.body;)o+=t.offsetLeft,n+=t.offsetTop,r=t;return r&&"fixed"===r.style.position&&(o+=e.pageXOffset||i.scrollLeft,n+=e.pageYOffset||i.scrollTop),{left:o,top:n}},t.Dom.getWindowScrollTop=function(){var t=e.scrollY;return void 0==t&&(t=document.documentElement.scrollTop),t},t.Dom.getWindowScrollLeft=function(){var t=e.scrollX;return void 0==t&&(t=document.documentElement.scrollLeft),t},t.Dom.getScrollTop=function(o){return o===e?t.Dom.getWindowScrollTop(o):o.scrollTop},t.Dom.getScrollLeft=function(o){return o===e?t.Dom.getWindowScrollLeft(o):o.scrollLeft},t.Dom.getComputedStyle=function(e){return e.currentStyle||document.defaultView.getComputedStyle(e)},t.Dom.outerWidth=function(e){return e.offsetWidth},t.Dom.outerHeight=function(e){return this.hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight},t.Dom.innerHeight=function(e){return e.clientHeight||e.innerHeight},t.Dom.innerWidth=function(e){return e.clientWidth||e.innerWidth},t.Dom.addEvent=function(t,o,n){e.addEventListener?t.addEventListener(o,n,!1):t.attachEvent("on"+o,n)},t.Dom.removeEvent=function(t,o,n){e.removeEventListener?t.removeEventListener(o,n,!1):t.detachEvent("on"+o,n)},function(){function e(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var o=document.createElement("CAPTION");o.innerHTML="c<br>c<br>c<br>c",o.style.padding=0,o.style.margin=0,e.insertBefore(o,t),document.body.appendChild(e),n=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function o(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var o=e.offsetWidth;t.style.overflow="scroll";var n=e.offsetWidth;return o==n&&(n=t.clientWidth),(document.body||document.documentElement).removeChild(t),o-n}var n;t.Dom.hasCaptionProblem=function(){return void 0===n&&e(),n},t.Dom.getCaretPosition=function(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var o=e.createTextRange(),n=o.duplicate();return o.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",o),n.text.length}return 0},t.Dom.getSelectionEndPosition=function(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var t=document.selection.createRange();if(null==t)return 0;var o=e.createTextRange();return o.text.indexOf(t.text)+t.text.length}},t.Dom.setCaretPosition=function(e,t,o){if(void 0===o&&(o=t),e.setSelectionRange)e.focus(),e.setSelectionRange(t,o);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",o),n.moveStart("character",t),n.select()}};var r;t.Dom.getScrollbarWidth=function(){return void 0===r&&(r=o()),r};var i=!document.createTextNode("test").textContent;t.Dom.isIE8=function(){return i};var s=!!document.documentMode;t.Dom.isIE9=function(){return s};var a=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);t.Dom.isSafari=function(){return a},t.Dom.setOverlayPosition=function(e,t,o){i||s?(e.style.top=o,e.style.left=t):a?e.style["-webkit-transform"]="translate3d("+t+","+o+",0)":e.style.transform="translate3d("+t+","+o+",0)"},t.Dom.getCssTransform=function(e){var t;return e.style.transform&&""!=(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!=(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1},t.Dom.resetCssTransform=function(e){e.transform&&""!=e.transform?e.transform="":e["-webkit-transform"]&&""!=e["-webkit-transform"]&&(e["-webkit-transform"]="")}}(),!e.Handsontable)var t={};t.countEventManagerListeners=0,t.eventManager=function(o){if(!o)throw new Error("instance not defined");o.eventListeners||(o.eventListeners=[]);var n=function(n,r,i){var s=function(e){void 0==e.target&&void 0!=e.srcElement&&(e.definePoperty?e.definePoperty("target",{value:e.srcElement}):e.target=e.srcElement),void 0==e.preventDefault&&(e.definePoperty?e.definePoperty("preventDefault",{value:function(){this.returnValue=!1}}):e.preventDefault=function(){this.returnValue=!1}),i.call(this,e)};o.eventListeners.push({element:n,event:r,callback:i,callbackProxy:s}),e.addEventListener?n.addEventListener(r,s,!1):n.attachEvent("on"+r,s),t.countEventManagerListeners++},r=function(e,n,r){for(var i=o.eventListeners.length;i--;){var s=o.eventListeners[i];if(s.event==n&&s.element==e){if(r&&r!=s.callback)continue;o.eventListeners.splice(i,1),s.element.removeEventListener?s.element.removeEventListener(s.event,s.callbackProxy,!1):s.element.detachEvent("on"+s.event,s.callbackProxy),t.countEventManagerListeners--}}},i=function(){for(var e=o.eventListeners.length;e--;){var t=o.eventListeners[e];r(t.element,t.event,t.callback)}},s=function(t,o){var n,r={bubbles:!0,cancelable:"mousemove"!==o,view:e,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};document.createEvent?(n=document.createEvent("MouseEvents"),n.initMouseEvent(o,r.bubbles,r.cancelable,r.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget||document.body.parentNode)):n=document.createEventObject(),t.dispatchEvent?t.dispatchEvent(n):t.fireEvent("on"+o,n)};return{addEventListener:n,removeEventListener:r,clear:i,fireEvent:s}},t.TableView=function(o){var n=this;this.eventManager=t.eventManager(o),this.instance=o,this.settings=o.getSettings();var r=o.rootElement.getAttribute("style");r&&o.rootElement.setAttribute("data-originalstyle",r),t.Dom.addClass(o.rootElement,"handsontable");var i=document.createElement("TABLE");i.className="htCore",this.THEAD=document.createElement("THEAD"),i.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),i.appendChild(this.TBODY),o.table=i,o.container.insertBefore(i,o.container.firstChild),this.eventManager.addEventListener(o.rootElement,"mousedown",function(t){n.isTextSelectionAllowed(t.target)||(a(),t.preventDefault(),e.focus())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(e){o.selection.isInProgress()&&!e.shiftKey&&o.selection.finish()});var s;this.isMouseDown=function(){return s},this.eventManager.addEventListener(document.documentElement,"mouseup",function(e){o.selection.isInProgress()&&1===e.which&&o.selection.finish(),s=!1,t.helper.isOutsideInput(document.activeElement)&&o.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(e){var t=e.target;if(!s){if(t!==n.wt.wtTable.spreader)for(;t!==document.documentElement;){if(null===t)return;if(t===o.rootElement)return;t=t.parentNode}n.settings.outsideClickDeselects?o.deselectCell():o.destroyEditor()}}),this.eventManager.addEventListener(i,"selectstart",function(e){n.settings.fragmentSelection||e.preventDefault()});var a=function(){e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():document.selection&&document.selection.empty()},l=[new T({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&!o.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&!o.selection.isMultiple()}}}),new T({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&o.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&o.selection.isMultiple()}}}),new T({className:"highlight",highlightRowClassName:n.settings.currentRowClassName,highlightColumnClassName:n.settings.currentColClassName}),new T({className:"fill",border:{width:1,color:"red"}})];l.current=l[0],l.area=l[1],l.highlight=l[2],l.fill=l[3];var c={debug:function(){return n.settings.debug},table:i,stretchH:this.settings.stretchH,data:o.getDataAtCell,totalRows:o.countRows,totalColumns:o.countCols,fixedColumnsLeft:function(){return n.settings.fixedColumnsLeft},fixedRowsTop:function(){return n.settings.fixedRowsTop},renderAllRows:n.settings.renderAllRows,rowHeaders:function(){var e=[];return o.hasRowHeaders()&&e.push(function(e,t){n.appendRowHeader(e,t)}),t.hooks.run(o,"afterGetRowHeaderRenderers",e),e},columnHeaders:function(){var e=[];return o.hasColHeaders()&&e.push(function(e,t){n.appendColHeader(e,t)}),t.hooks.run(o,"afterGetColumnHeaderRenderers",e),e},columnWidth:o.getColWidth,rowHeight:o.getRowHeight,cellRenderer:function(e,o,r){var i=n.instance.colToProp(o),s=n.instance.getCellMeta(e,o),a=n.instance.getCellRenderer(s),l=n.instance.getDataAtRowProp(e,i);a(n.instance,r,e,o,i,l,s),t.hooks.run(n.instance,"afterRenderer",r,e,o,i,l,s)},selections:l,hideBorderOnMouseDownOver:function(){return n.settings.fragmentSelection},onCellMouseDown:function(e,r,i,a){o.listen(),n.activeWt=a,s=!0,t.hooks.run(o,"beforeOnCellMouseDown",e,r,i),t.Dom.enableImmediatePropagation(e),e.isImmediatePropagationStopped()||(2===e.button&&o.selection.inInSelection(r)||(e.shiftKey?r.row>=0&&r.col>=0&&o.selection.setRangeEnd(r):r.row<0||r.col<0?(r.row<0&&(o.selectCell(0,r.col,o.countRows()-1,r.col),o.selection.setSelectedHeaders(!1,!0)),r.col<0&&(o.selectCell(r.row,0,r.row,o.countCols()-1),o.selection.setSelectedHeaders(!0,!1))):o.selection.setRangeStart(r)),t.hooks.run(o,"afterOnCellMouseDown",e,r,i),n.activeWt=n.wt)},onCellMouseOver:function(e,r,i,a){n.activeWt=a,r.row>=0&&r.col>=0?s&&o.selection.setRangeEnd(r):s&&(r.row<0&&(o.selection.setRangeEnd(new u(o.countRows()-1,r.col)),o.selection.setSelectedHeaders(!1,!0)),r.col<0&&(o.selection.setRangeEnd(new u(r.row,o.countCols()-1)),o.selection.setSelectedHeaders(!0,!1))),t.hooks.run(o,"afterOnCellMouseOver",e,r,i),n.activeWt=n.wt},onCellCornerMouseDown:function(e){e.preventDefault(),t.hooks.run(o,"afterOnCellCornerMouseDown",e)},beforeDraw:function(e){n.beforeRender(e)},onDraw:function(e){n.onDraw(e)},onScrollVertically:function(){o.runHooks("afterScrollVertically")},onScrollHorizontally:function(){o.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(e,t){o.runHooks("beforeDrawBorders",e,t)},onBeforeTouchScroll:function(){o.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){o.runHooks("afterMomentumScroll")},viewportRowCalculatorOverride:function(e){n.settings.viewportRowRenderingOffset&&(e.startRow=Math.max(e.startRow-n.settings.viewportRowRenderingOffset,0),e.endRow=Math.min(e.endRow+n.settings.viewportRowRenderingOffset,o.countRows()-1)),o.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){n.settings.viewportColumnRenderingOffset&&(e.startColumn=Math.max(e.startColumn-n.settings.viewportColumnRenderingOffset,0),e.endColumn=Math.min(e.endColumn+n.settings.viewportColumnRenderingOffset,o.countCols()-1)),o.runHooks("afterViewportColumnCalculatorOverride",e)}};t.hooks.run(o,"beforeInitWalkontable",c),this.wt=new g(c),this.activeWt=this.wt,this.eventManager.addEventListener(n.wt.wtTable.spreader,"mousedown",function(e){e.target===n.wt.wtTable.spreader&&3===e.which&&t.helper.stopPropagation(e)
}),this.eventManager.addEventListener(n.wt.wtTable.spreader,"contextmenu",function(e){e.target===n.wt.wtTable.spreader&&3===e.which&&t.helper.stopPropagation(e)}),this.eventManager.addEventListener(document.documentElement,"click",function(){n.settings.observeDOMVisibility&&n.wt.drawInterrupted&&(n.instance.forceFullRender=!0,n.render())})},t.TableView.prototype.isTextSelectionAllowed=function(e){return t.helper.isInput(e)?!0:this.settings.fragmentSelection&&t.Dom.isChildOf(e,this.TBODY)?!0:!1},t.TableView.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},t.TableView.prototype.beforeRender=function(e){e&&t.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)},t.TableView.prototype.onDraw=function(e){e&&t.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)},t.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1},t.TableView.prototype.getCellAtCoords=function(e,t){var o=this.wt.getCell(e,t);return 0>o?null:o},t.TableView.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)},t.TableView.prototype.appendRowHeader=function(e,o){var n=document.createElement("DIV"),r=document.createElement("SPAN");n.className="relative",r.className="rowHeader",e>-1?t.Dom.fastInnerHTML(r,this.instance.getRowHeader(e)):t.Dom.fastInnerText(r,String.fromCharCode(160)),n.appendChild(r),t.Dom.empty(o),o.appendChild(n),t.hooks.run(this.instance,"afterGetRowHeader",e,o)},t.TableView.prototype.appendColHeader=function(e,o){var n=document.createElement("DIV"),r=document.createElement("SPAN");n.className="relative",r.className="colHeader",e>-1?t.Dom.fastInnerHTML(r,this.instance.getColHeader(e)):t.Dom.fastInnerText(r,String.fromCharCode(160)),n.appendChild(r),t.Dom.empty(o),o.appendChild(n),t.hooks.run(this.instance,"afterGetColHeader",e,o)},t.TableView.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth(),o=t-e;return o>0?o:0},t.TableView.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight(),o=t-e;return o>0?o:0},t.TableView.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},t.TableView.prototype.destroy=function(){this.wt.destroy(),this.eventManager.clear()},function(e){function t(e){var t,o;o={},t=e,this.getInstance=function(e){return e.guid in o||(o[e.guid]=new t(e)),o[e.guid]}}var o={},n=new WeakMap;e.editors={registerEditor:function(e,r){var i=new t(r);"string"==typeof e&&(o[e]=i),n.set(r,i)},getEditor:function(e,t){var r;if("function"==typeof e)n.get(e)||this.registerEditor(null,e),r=n.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');r=o[e]}if(!r)throw Error('No editor registered under name "'+e+'"');return r.getInstance(t)}}}(t),function(e){e.EditorManager=function(t,o,n){var r,i=this,s=e.helper.keyCode,a=!1,l=e.eventManager(t),c=function(){function c(l){if(t.isListening()&&(e.hooks.run(t,"beforeKeyDown",l),!a&&(e.Dom.enableImmediatePropagation(l),!l.isImmediatePropagationStopped()&&(o.lastKeyCode=l.keyCode,n.isSelected())))){var c=(l.ctrlKey||l.metaKey)&&!l.altKey;if(!(r.isWaiting()||e.helper.isMetaKey(l.keyCode)||c||i.isEditorOpened()))return void i.openEditor("");var h=l.shiftKey?n.setRangeEnd:n.setRangeStart;switch(l.keyCode){case s.A:c&&(n.selectAll(),l.preventDefault(),e.helper.stopPropagation(l));break;case s.ARROW_UP:i.isEditorOpened()&&!r.isWaiting()&&i.closeEditorAndSaveChanges(c),f(l.shiftKey),l.preventDefault(),e.helper.stopPropagation(l);break;case s.ARROW_DOWN:i.isEditorOpened()&&!r.isWaiting()&&i.closeEditorAndSaveChanges(c),p(l.shiftKey),l.preventDefault(),e.helper.stopPropagation(l);break;case s.ARROW_RIGHT:i.isEditorOpened()&&!r.isWaiting()&&i.closeEditorAndSaveChanges(c),g(l.shiftKey),l.preventDefault(),e.helper.stopPropagation(l);break;case s.ARROW_LEFT:i.isEditorOpened()&&!r.isWaiting()&&i.closeEditorAndSaveChanges(c),m(l.shiftKey),l.preventDefault(),e.helper.stopPropagation(l);break;case s.TAB:var w="function"==typeof o.settings.tabMoves?o.settings.tabMoves(l):o.settings.tabMoves;l.shiftKey?n.transformStart(-w.row,-w.col):n.transformStart(w.row,w.col,!0),l.preventDefault(),e.helper.stopPropagation(l);break;case s.BACKSPACE:case s.DELETE:n.empty(l),i.prepareEditor(),l.preventDefault();break;case s.F2:i.openEditor(),l.preventDefault();break;case s.ENTER:i.isEditorOpened()?(r.state!==e.EditorState.WAITING&&i.closeEditorAndSaveChanges(c),d(l.shiftKey)):t.getSettings().enterBeginsEditing?i.openEditor():d(l.shiftKey),l.preventDefault(),l.stopImmediatePropagation();break;case s.ESCAPE:i.isEditorOpened()&&i.closeEditorAndRestoreOriginalValue(c),l.preventDefault();break;case s.HOME:h(l.ctrlKey||l.metaKey?new u(0,o.selRange.from.col):new u(o.selRange.from.row,0)),l.preventDefault(),e.helper.stopPropagation(l);break;case s.END:h(l.ctrlKey||l.metaKey?new u(t.countRows()-1,o.selRange.from.col):new u(o.selRange.from.row,t.countCols()-1)),l.preventDefault(),e.helper.stopPropagation(l);break;case s.PAGE_UP:n.transformStart(-t.countVisibleRows(),0),l.preventDefault(),e.helper.stopPropagation(l);break;case s.PAGE_DOWN:n.transformStart(t.countVisibleRows(),0),l.preventDefault(),e.helper.stopPropagation(l)}}}function h(e,t,o){"TD"==o.nodeName&&i.openEditor()}function d(e){var t="function"==typeof o.settings.enterMoves?o.settings.enterMoves(event):o.settings.enterMoves;e?n.transformStart(-t.row,-t.col):n.transformStart(t.row,t.col,!0)}function f(e){e?n.transformEnd(-1,0):n.transformStart(-1,0)}function p(e){e?n.transformEnd(1,0):n.transformStart(1,0)}function g(e){e?n.transformEnd(0,1):n.transformStart(0,1)}function m(e){e?n.transformEnd(0,-1):n.transformStart(0,-1)}t.addHook("afterDocumentKeyDown",function(e){c(e)}),l.addEventListener(document,"keydown",function(e){t.runHooks("afterDocumentKeyDown",e)}),t.view.wt.update("onCellDblClick",h),t.addHook("afterDestroy",function(){a=!0})};this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return r},this.prepareEditor=function(){if(r&&r.isWaiting())return void this.closeEditor(!1,!1,function(e){e&&i.prepareEditor()});var n=o.selRange.highlight.row,s=o.selRange.highlight.col,a=t.colToProp(s),l=t.getCell(n,s),c=t.getDataAtCell(n,s),h=t.getCellMeta(n,s),u=t.getCellEditor(h);r=e.editors.getEditor(u,t),r.prepare(n,s,a,l,c,h)},this.isEditorOpened=function(){return r.isOpened()},this.openEditor=function(e){r.cellProperties.readOnly||r.beginEditing(e)},this.closeEditor=function(e,t,o){r?r.finishEditing(e,t,o):o&&o(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},c()}}(t),function(e){var t={};e.renderers={registerRenderer:function(e,o){t[e]=o},getRenderer:function(e){if("function"==typeof e)return e;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "renderer" parameter ');if(!(e in t))throw Error('No editor registered under name "'+e+'"');return t[e]}}}(t),t.helper={},t.helper.isPrintableChar=function(e){return 32==e||e>=48&&57>=e||e>=96&&111>=e||e>=186&&192>=e||e>=219&&222>=e||e>=226||e>=65&&90>=e},t.helper.isMetaKey=function(e){var o=t.helper.keyCode,n=[o.ARROW_DOWN,o.ARROW_UP,o.ARROW_LEFT,o.ARROW_RIGHT,o.HOME,o.END,o.DELETE,o.BACKSPACE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.TAB,o.PAGE_DOWN,o.PAGE_UP,o.ENTER,o.ESCAPE,o.SHIFT,o.CAPS_LOCK,o.ALT];return-1!=n.indexOf(e)},t.helper.isCtrlKey=function(e){var o=t.helper.keyCode;return-1!=[o.CONTROL_LEFT,224,o.COMMAND_LEFT,o.COMMAND_RIGHT].indexOf(e)},t.helper.stringify=function(e){switch(typeof e){case"string":case"number":return e+"";case"object":return null===e?"":e.toString();case"undefined":return"";default:return e.toString()}},t.helper.spreadsheetColumnLabel=function(e){for(var t,o=e+1,n="";o>0;)t=(o-1)%26,n=String.fromCharCode(65+t)+n,o=parseInt((o-t)/26,10);return n},t.helper.createSpreadsheetData=function(e,o){e="number"==typeof e?e:100,o="number"==typeof o?o:4;var n,r,i=[];for(n=0;e>n;n++){var s=[];for(r=0;o>r;r++)s.push(t.helper.spreadsheetColumnLabel(r)+(n+1));i.push(s)}return i},t.helper.createSpreadsheetObjectData=function(e,o){e="number"==typeof e?e:100,o="number"==typeof o?o:4;var n,r,i=[];for(n=0;e>n;n++){var s={};for(r=0;o>r;r++)s["prop"+r]=t.helper.spreadsheetColumnLabel(r)+(n+1);i.push(s)}return i},t.helper.isNumeric=function(e){var t=typeof e;return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?e.length?1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):!1:"object"==t?!(!e||"number"!=typeof e.valueOf()||e instanceof Date):!1},t.helper.randomString=function(){return v()},t.helper.inherit=function(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e},t.helper.extend=function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},t.helper.deepExtend=function(e,o){for(var n in o)o.hasOwnProperty(n)&&(o[n]&&"object"==typeof o[n]?(e[n]||(e[n]=Array.isArray(o[n])?[]:{}),t.helper.deepExtend(e[n],o[n])):e[n]=o[n])},t.helper.deepClone=function(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e},t.helper.getPrototypeOf=function(e){var t;if("object"==typeof e.__proto__)t=e.__proto__;else{var o,n=e.constructor;"function"==typeof e.constructor&&(o=n,delete e.constructor&&(n=e.constructor,e.constructor=o)),t=n?n.prototype:null}return t},t.helper.columnFactory=function(e,o){function n(){}t.helper.inherit(n,e);for(var r=0,i=o.length;i>r;r++)n.prototype[o[r]]=void 0;return n},t.helper.translateRowsToColumns=function(e){var t,o,n,r,i=[],s=0;for(t=0,o=e.length;o>t;t++)for(n=0,r=e[t].length;r>n;n++)n==s&&(i.push([]),s++),i[n].push(e[t][n]);return i},t.helper.to2dArray=function(e){for(var t=0,o=e.length;o>t;)e[t]=[e[t]],t++},t.helper.extendArray=function(e,t){for(var o=0,n=t.length;n>o;)e.push(t[o]),o++},t.helper.isInput=function(e){var t=["INPUT","SELECT","TEXTAREA"];return t.indexOf(e.nodeName)>-1},t.helper.isOutsideInput=function(e){return t.helper.isInput(e)&&-1==e.className.indexOf("handsontableInput")},t.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},t.helper.isObject=function(e){return"[object Object]"==Object.prototype.toString.call(e)},t.helper.pivot=function(e){var t=[];if(!e||0==e.length||!e[0]||0==e[0].length)return t;for(var o=e.length,n=e[0].length,r=0;o>r;r++)for(var i=0;n>i;i++)t[i]||(t[i]=[]),t[i][r]=e[r][i];return t},t.helper.proxy=function(e,t){return function(){return e.apply(t,arguments)}},t.helper.cellMethodLookupFactory=function(e,o){function n(e){var o=t.cellTypes[e];if("undefined"==typeof o)throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return o}return o="undefined"==typeof o?!0:o,function(r,i){return function s(r){if(r){if(r.hasOwnProperty(e)&&void 0!==r[e])return r[e];if(r.hasOwnProperty("type")&&r.type){var i;if("string"!=typeof r.type)throw new Error("Cell type must be a string ");if(i=n(r.type),i.hasOwnProperty(e))return i[e];if(o)return}return s(t.helper.getPrototypeOf(r))}}("number"==typeof r?this.getCellMeta(r,i):r)}},t.helper.isMobileBrowser=function(e){return e||(e=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)},t.helper.isTouchSupported=function(){return"ontouchstart"in e},t.helper.stopPropagation=function(e){"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},t.helper.pageX=function(e){if(e.pageX)return e.pageX;var o=t.Dom.getWindowScrollLeft(),n=e.clientX+o;return n},t.helper.pageY=function(e){if(e.pageY)return e.pageY;var o=t.Dom.getWindowScrollTop(),n=e.clientY+o;return n},function(e){e.DataMap=function(e,t,o){this.instance=e,this.priv=t,this.GridSettings=o,this.dataSource=this.instance.getSettings().data,this.duckSchema=this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{},this.createMap()},e.DataMap.prototype.DESTINATION_RENDERER=1,e.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,e.DataMap.prototype.recursiveDuckSchema=function(e){var t;if(Array.isArray(e))t=[];else{t={};for(var o in e)e.hasOwnProperty(o)&&(t[o]="object"!=typeof e[o]||Array.isArray(e[o])?null:this.recursiveDuckSchema(e[o]))}return t},e.DataMap.prototype.recursiveDuckColumns=function(e,t,o){var n,r;if("undefined"==typeof t&&(t=0,o=""),"object"==typeof e&&!Array.isArray(e))for(r in e)e.hasOwnProperty(r)&&(null===e[r]?(n=o+r,this.colToPropCache.push(n),this.propToColCache.set(n,t),t++):t=this.recursiveDuckColumns(e[r],t,r+"."));return t},e.DataMap.prototype.createMap=function(){var e,t,o=this.getSchema();if("undefined"==typeof o)throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new MultiMap;var n=this.instance.getSettings().columns;if(n)for(e=0,t=n.length;t>e;e++)"undefined"!=typeof n[e].data&&(this.colToPropCache[e]=n[e].data,this.propToColCache.set(n[e].data,e));else this.recursiveDuckColumns(o)},e.DataMap.prototype.colToProp=function(t){return t=e.hooks.execute(this.instance,"modifyCol",t),this.colToPropCache&&"undefined"!=typeof this.colToPropCache[t]?this.colToPropCache[t]:t},e.DataMap.prototype.propToCol=function(t){var o;return o="undefined"!=typeof this.propToColCache.get(t)?this.propToColCache.get(t):t,o=e.hooks.execute(this.instance,"modifyCol",o)},e.DataMap.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},e.DataMap.prototype.createRow=function(t,o,n){var r,i,s=this.instance.countCols(),a=0;o||(o=1),("number"!=typeof t||t>=this.instance.countRows())&&(t=this.instance.countRows()),i=t;for(var l=this.instance.getSettings().maxRows;o>a&&this.instance.countRows()<l;){if("array"===this.instance.dataType){r=[];for(var c=0;s>c;c++)r.push(null)}else"function"===this.instance.dataType?r=this.instance.getSettings().dataSchema(t):(r={},e.helper.deepExtend(r,this.getSchema()));t===this.instance.countRows()?this.dataSource.push(r):this.dataSource.splice(t,0,r),a++,i++}return e.hooks.run(this.instance,"afterCreateRow",t,a,n),this.instance.forceFullRender=!0,a},e.DataMap.prototype.createCol=function(t,o,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var r,i,s=this.instance.countRows(),a=this.dataSource,l=0;o||(o=1),i=t;for(var c=this.instance.getSettings().maxCols;o>l&&this.instance.countCols()<c;){if(r=e.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof t||t>=this.instance.countCols()){for(var h=0;s>h;h++)"undefined"==typeof a[h]&&(a[h]=[]),a[h].push(null);this.priv.columnSettings.push(r)}else{for(var h=0;s>h;h++)a[h].splice(i,0,null);this.priv.columnSettings.splice(i,0,r)}l++,i++}return e.hooks.run(this.instance,"afterCreateCol",t,l,n),this.instance.forceFullRender=!0,l},e.DataMap.prototype.removeRow=function(t,o){o||(o=1),"number"!=typeof t&&(t=-o),t=(this.instance.countRows()+t)%this.instance.countRows();var n=this.physicalRowsToLogical(t,o),r=e.hooks.execute(this.instance,"beforeRemoveRow",t,o);if(r!==!1){var i=this.dataSource,s=i.filter(function(e,t){return-1==n.indexOf(t)});i.length=0,Array.prototype.push.apply(i,s),e.hooks.run(this.instance,"afterRemoveRow",t,o),this.instance.forceFullRender=!0}},e.DataMap.prototype.removeCol=function(t,o){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");o||(o=1),"number"!=typeof t&&(t=-o),t=(this.instance.countCols()+t)%this.instance.countCols();var n=e.hooks.execute(this.instance,"beforeRemoveCol",t,o);if(n!==!1){for(var r=this.dataSource,i=0,s=this.instance.countRows();s>i;i++)r[i].splice(t,o);this.priv.columnSettings.splice(t,o),e.hooks.run(this.instance,"afterRemoveCol",t,o),this.instance.forceFullRender=!0}},e.DataMap.prototype.spliceCol=function(t,o,n){var r=4<=arguments.length?[].slice.call(arguments,3):[],i=this.instance.getDataAtCol(t),s=i.slice(o,o+n),a=i.slice(o+n);e.helper.extendArray(r,a);for(var l=0;n>l;)r.push(null),l++;return e.helper.to2dArray(r),this.instance.populateFromArray(o,t,r,null,null,"spliceCol"),s},e.DataMap.prototype.spliceRow=function(t,o,n){var r=4<=arguments.length?[].slice.call(arguments,3):[],i=this.instance.getSourceDataAtRow(t),s=i.slice(o,o+n),a=i.slice(o+n);e.helper.extendArray(r,a);for(var l=0;n>l;)r.push(null),l++;return this.instance.populateFromArray(t,o,[r],null,null,"spliceRow"),s},e.DataMap.prototype.get=function(t,o){if(t=e.hooks.execute(this.instance,"modifyRow",t),"string"==typeof o&&o.indexOf(".")>-1){var n=o.split("."),r=this.dataSource[t];if(!r)return null;for(var i=0,s=n.length;s>i;i++)if(r=r[n[i]],"undefined"==typeof r)return null;return r}return"function"==typeof o?o(this.dataSource.slice(t,t+1)[0]):this.dataSource[t]?this.dataSource[t][o]:null};var t=e.helper.cellMethodLookupFactory("copyable",!1);e.DataMap.prototype.getCopyable=function(e,o){return t.call(this.instance,e,this.propToCol(o))?this.get(e,o):""},e.DataMap.prototype.set=function(t,o,n,r){if(t=e.hooks.execute(this.instance,"modifyRow",t,r||"datamapGet"),"string"==typeof o&&o.indexOf(".")>-1){for(var i=o.split("."),s=this.dataSource[t],a=0,l=i.length-1;l>a;a++)"undefined"==typeof s[i[a]]&&(s[i[a]]={}),s=s[i[a]];s[i[a]]=n}else"function"==typeof o?o(this.dataSource.slice(t,t+1)[0],n):this.dataSource[t][o]=n},e.DataMap.prototype.physicalRowsToLogical=function(t,o){for(var n,r=this.instance.countRows(),i=(r+t)%r,s=[],a=o;r>i&&a;)n=e.hooks.execute(this.instance,"modifyRow",i),s.push(n),a--,i++;return s},e.DataMap.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},e.DataMap.prototype.getAll=function(){return this.dataSource},e.DataMap.prototype.getRange=function(e,t,o){var n,r,i,s,a,l=[],c=o===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(r=Math.max(e.row,t.row),s=Math.max(e.col,t.col),n=Math.min(e.row,t.row);r>=n;n++){for(a=[],i=Math.min(e.col,t.col);s>=i;i++)a.push(c.call(this,n,this.colToProp(i)));l.push(a)}return l},e.DataMap.prototype.getText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},e.DataMap.prototype.getCopyableText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}}(t),function(e){e.renderers.cellDecorator=function(t,o,n,r,i,s,a){a.className&&(o.className=o.className?o.className+" "+a.className:a.className),a.readOnly&&e.Dom.addClass(o,a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName&&e.Dom.addClass(o,a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&e.Dom.addClass(o,a.noWordWrapClassName),!s&&a.placeholder&&e.Dom.addClass(o,a.placeholderCellClassName)}}(t),function(e){var t=function(t,o,n,r,i,s,a){e.renderers.cellDecorator.apply(this,arguments),!s&&a.placeholder&&(s=a.placeholder);var l=e.helper.stringify(s);if(a.rendererTemplate){e.Dom.empty(o);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=t.getSourceDataAtRow(n),o.appendChild(c)}else e.Dom.fastInnerText(o,l)};e.renderers.TextRenderer=t,e.renderers.registerRenderer("text",t)}(t),function(e){var t=document.createElement("DIV");t.className="htAutocompleteWrapper";var o=document.createElement("DIV");o.className="htAutocompleteArrow",o.appendChild(document.createTextNode(String.fromCharCode(9660)));var n=function(n,r,i,s,a,l,c){var h=(t.cloneNode(!0),o.cloneNode(!0));if(e.renderers.TextRenderer(n,r,i,s,a,l,c),r.appendChild(h),e.Dom.addClass(r,"htAutocomplete"),r.firstChild||r.appendChild(document.createTextNode(String.fromCharCode(160))),!n.acArrowListener){var d=e.eventManager(n);n.acArrowListener=function(t){e.Dom.hasClass(t.target,"htAutocompleteArrow")&&n.view.wt.getSetting("onCellDblClick",null,new u(i,s),r)},d.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",function(){d.clear()})}};e.AutocompleteRenderer=n,e.renderers.AutocompleteRenderer=n,e.renderers.registerRenderer("autocomplete",n)}(t),function(e){var t=document.createElement("INPUT");t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off");var o=function(o,n,r,i,s,a,l){var c=e.eventManager(o);"undefined"==typeof l.checkedTemplate&&(l.checkedTemplate=!0),"undefined"==typeof l.uncheckedTemplate&&(l.uncheckedTemplate=!1),e.Dom.empty(n);var h=t.cloneNode(!1);a===l.checkedTemplate||a===e.helper.stringify(l.checkedTemplate)?(h.checked=!0,n.appendChild(h)):a===l.uncheckedTemplate||a===e.helper.stringify(l.uncheckedTemplate)?n.appendChild(h):null===a?(h.className+=" noValue",n.appendChild(h)):e.Dom.fastInnerText(n,"#bad value#"),l.readOnly?c.addEventListener(h,"click",function(e){e.preventDefault()}):(c.addEventListener(h,"mousedown",function(t){e.helper.stopPropagation(t)}),c.addEventListener(h,"mouseup",function(t){e.helper.stopPropagation(t)}),c.addEventListener(h,"change",function(){this.checked?o.setDataAtRowProp(r,s,l.checkedTemplate):o.setDataAtRowProp(r,s,l.uncheckedTemplate)})),o.CheckboxRenderer&&o.CheckboxRenderer.beforeKeyDownHookBound||(o.CheckboxRenderer={beforeKeyDownHookBound:!0},o.addHook("beforeKeyDown",function(t){if(e.Dom.enableImmediatePropagation(t),t.keyCode==e.helper.keyCode.SPACE||t.keyCode==e.helper.keyCode.ENTER)for(var n,r,i,s=o.getSelectedRange(),a=s.getTopLeftCorner(),l=s.getBottomRightCorner(),h=a.row;h<=l.row;h++)for(var u=a.col;u<=l.col;u++)if(n=o.getCell(h,u),i=o.getCellMeta(h,u),r=n.querySelectorAll("input[type=checkbox]"),r.length>0&&!i.readOnly){t.isImmediatePropagationStopped()||(t.stopImmediatePropagation(),t.preventDefault());for(var d=0,f=r.length;f>d;d++)r[d].checked=!r[d].checked,c.fireEvent(r[d],"change")}}))};e.CheckboxRenderer=o,e.renderers.CheckboxRenderer=o,e.renderers.registerRenderer("checkbox",o)}(t),function(e){var t=function(t,o,n,r,i,s,a){e.helper.isNumeric(s)&&("undefined"!=typeof a.language&&numeral.language(a.language),s=numeral(s).format(a.format||"0"),e.Dom.addClass(o,"htNumeric")),e.renderers.TextRenderer(t,o,n,r,i,s,a)};e.NumericRenderer=t,e.renderers.NumericRenderer=t,e.renderers.registerRenderer("numeric",t)}(t),function(e){var o=function(e,o,n,r,i,s,a){t.renderers.TextRenderer.apply(this,arguments),s=o.innerHTML;var l,c=a.hashLength||s.length,h=a.hashSymbol||"*";for(l="";l.split(h).length-1<c;l+=h);t.Dom.fastInnerHTML(o,l)};e.PasswordRenderer=o,e.renderers.PasswordRenderer=o,e.renderers.registerRenderer("password",o)}(t),function(e){function t(t,o,n,r,i,s){e.renderers.cellDecorator.apply(this,arguments),e.Dom.fastInnerHTML(o,s)}e.renderers.registerRenderer("html",t),e.renderers.HtmlRenderer=t}(t),function(e){function t(t){this.instance=t,this.state=e.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},t.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},t.prototype.init=function(){},t.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},t.prototype.setValue=function(){throw Error("Editor setValue() method unimplemented")},t.prototype.open=function(){throw Error("Editor open() method unimplemented")},t.prototype.close=function(){throw Error("Editor close() method unimplemented")},t.prototype.prepare=function(t,o,n,r,i,s){this.TD=r,this.row=t,this.col=o,this.prop=n,this.originalValue=i,this.cellProperties=s,this.state=e.EditorState.VIRGIN},t.prototype.extend=function(){function e(){o.apply(this,arguments)}function t(e,t){function o(){}return o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e,e}var o=this.constructor;return t(e,o)},t.prototype.saveValue=function(e,t){if(t){var o,n=this.instance.getSelected();n[0]>n[2]&&(o=n[0],n[0]=n[2],n[2]=o),n[1]>n[3]&&(o=n[1],n[1]=n[3],n[3]=o),this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")}else this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")},t.prototype.beginEditing=function(t){this.state==e.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new u(this.row,this.col)),this.instance.view.render(),this.state=e.EditorState.EDITING,t="string"==typeof t?t:this.originalValue,this.setValue(e.helper.stringify(t)),this.open(),this._opened=!0,this.focus(),this.instance.view.render())},t.prototype.finishEditing=function(t,o,n){if(n){var r=this._closeCallback;this._closeCallback=function(e){r&&r(e),n(e)}}if(!this.isWaiting()){if(this.state==e.EditorState.VIRGIN){var i=this;return void this.instance._registerTimeout(setTimeout(function(){i._fireCallbacks(!0)},0))}if(this.state==e.EditorState.EDITING){if(t)return this.cancelChanges(),void this.instance.view.render();var s=[[String.prototype.trim.call(this.getValue())]];if(this.state=e.EditorState.WAITING,this.saveValue(s,o),this.instance.getCellValidator(this.cellProperties)){var i=this;this.instance.addHookOnce("afterValidate",function(t){i.state=e.EditorState.FINISHED,i.discardEditor(t)})}else this.state=e.EditorState.FINISHED,this.discardEditor(!0)}}},t.prototype.cancelChanges=function(){this.state=e.EditorState.FINISHED,this.discardEditor()},t.prototype.discardEditor=function(t){this.state===e.EditorState.FINISHED&&(t===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=e.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=e.EditorState.VIRGIN,this._fireCallbacks(!0)))},t.prototype.isOpened=function(){return this._opened},t.prototype.isWaiting=function(){return this.state===e.EditorState.WAITING},e.editors.BaseEditor=t}(t),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){var t=this;this.createElements(),this.eventManager=new e.eventManager(this),this.bindEvents(),this.autoResize=N(),this.instance.addHook("afterDestroy",function(){t.destroy()})},t.prototype.getValue=function(){return this.TEXTAREA.value},t.prototype.setValue=function(e){this.TEXTAREA.value=e};var o=function(t){var o=this,n=o.getActiveEditor(),r=e.helper.keyCode,i=(t.ctrlKey||t.metaKey)&&!t.altKey;if(e.Dom.enableImmediatePropagation(t),t.target===n.TEXTAREA&&!t.isImmediatePropagationStopped()){if(17===t.keyCode||224===t.keyCode||91===t.keyCode||93===t.keyCode)return void t.stopImmediatePropagation();switch(t.keyCode){case r.ARROW_RIGHT:e.Dom.getCaretPosition(n.TEXTAREA)!==n.TEXTAREA.value.length&&t.stopImmediatePropagation();break;case r.ARROW_LEFT:0!==e.Dom.getCaretPosition(n.TEXTAREA)&&t.stopImmediatePropagation();break;case r.ENTER:var s=n.instance.getSelected(),a=!(s[0]===s[2]&&s[1]===s[3]);(i&&!a||t.altKey)&&(n.isOpened()?(n.setValue(n.getValue()+"\n"),n.focus()):n.beginEditing(n.originalValue+"\n"),t.stopImmediatePropagation()),t.preventDefault();break;case r.A:case r.X:case r.C:case r.V:i&&t.stopImmediatePropagation();break;case r.BACKSPACE:case r.DELETE:case r.HOME:case r.END:t.stopImmediatePropagation()}n.autoResize.resize(String.fromCharCode(t.keyCode))}};t.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",o)},t.prototype.close=function(){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",o)},t.prototype.focus=function(){this.TEXTAREA.focus(),e.Dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},t.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),e.Dom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),e.Dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var t=this;this.instance._registerTimeout(setTimeout(function(){t.refreshDimensions()},0))},t.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},t.prototype.getEditedCell=function(){var e,t=this.checkEditorSection();switch(t){case"top":e=this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"corner":e=this.instance.view.wt.wtScrollbars.corner.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":e=this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=e&&-2!=e?e:void 0},t.prototype.refreshDimensions=function(){if(this.state===e.EditorState.EDITING&&(this.TD=this.getEditedCell(),this.TD)){var t,o=e.Dom.offset(this.TD),n=e.Dom.offset(this.instance.rootElement),r=o.top-n.top-1,i=o.left-n.left-1,s=this.instance.getSettings(),a=s.rowHeaders===!1?0:1,l=s.colHeaders===!1?0:1,c=this.checkEditorSection();switch(c){case"top":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.holder.parentNode);break;case"left":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.holder.parentNode);break;case"corner":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.corner.clone.wtTable.holder.parentNode)}0>r&&(r=0),0>i&&(i=0),a>0&&parseInt(this.TD.style.borderTopWidth,10)>0&&(r+=1),l>0&&parseInt(this.TD.style.borderLeftWidth,10)>0&&(i+=1),t&&-1!=t?this.textareaParentStyle[t[0]]=t[1]:e.Dom.resetCssTransform(this.textareaParentStyle),this.textareaParentStyle.top=r+"px",this.textareaParentStyle.left=i+"px";var h=this.TD.offsetTop-this.instance.view.wt.wtScrollbars.vertical.getScrollPosition(),u=this.TD.offsetLeft-this.instance.view.wt.wtScrollbars.horizontal.getScrollPosition(),d=e.Dom.innerWidth(this.TD)-8,f=this.instance.view.maximumVisibleElementWidth(u)-10,p=e.Dom.outerHeight(this.TD)-4,g=this.instance.view.maximumVisibleElementHeight(h)-2;parseInt(this.TD.style.borderTopWidth,10)>0&&(p-=1),parseInt(this.TD.style.borderLeftWidth,10)>0&&a>0&&(d-=1),this.TEXTAREA.style.fontSize=e.Dom.getComputedStyle(this.TD).fontSize,this.TEXTAREA.style.fontFamily=e.Dom.getComputedStyle(this.TD).fontFamily,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(p,g),maxHeight:g,minWidth:Math.min(d,f),maxWidth:f},!0),this.textareaParentStyle.display="block"}},t.prototype.bindEvents=function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(t){e.helper.stopPropagation(t)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(t){e.helper.stopPropagation(t)}),this.instance.addHook("afterScrollVertically",function(){t.refreshDimensions()}),this.instance.addHook("afterDestroy",function(){t.eventManager.clear()
})},t.prototype.destroy=function(){this.eventManager.clear()},e.editors.TextEditor=t,e.editors.registerEditor("text",e.editors.TextEditor)}(t),function(t){var o=t.editors.BaseEditor.prototype.extend(),n={},r=function(){this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton";for(var e in this.controls)this.positionControls.appendChild(this.controls[e])};o.prototype.valueChanged=function(){return this.initValue!=this.getValue()},o.prototype.init=function(){var e=this;this.eventManager=new t.eventManager(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){e.destroy()})},o.prototype.getValue=function(){return this.TEXTAREA.value},o.prototype.setValue=function(e){this.initValue=e,this.TEXTAREA.value=e},o.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),t.Dom.addClass(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),r.call(this),document.body.appendChild(this.editorContainer)},o.prototype.onBeforeKeyDown=function(e){var o=this,n=o.getActiveEditor();if(t.Dom.enableImmediatePropagation(e),e.target===n.TEXTAREA&&!e.isImmediatePropagationStopped()){var r=t.helper.keyCode;switch(e.keyCode){case r.ENTER:n.close(),e.preventDefault();break;case r.BACKSPACE:e.stopImmediatePropagation()}}},o.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),t.Dom.addClass(this.editorContainer,"active"),t.Dom.removeClass(this.cellPointer,"hidden"),this.updateEditorPosition()},o.prototype.focus=function(){this.TEXTAREA.focus(),t.Dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},o.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),t.Dom.removeClass(this.editorContainer,"active")},o.prototype.scrollToView=function(){var e=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(e)},o.prototype.hideCellPointer=function(){t.Dom.hasClass(this.cellPointer,"hidden")||t.Dom.addClass(this.cellPointer,"hidden")},o.prototype.updateEditorPosition=function(o,r){if(o&&r)o=parseInt(o,10),r=parseInt(r,10),this.editorContainer.style.top=r+"px",this.editorContainer.style.left=o+"px";else{var i=this.instance.getSelected(),s=this.instance.getCell(i[0],i[1]);if(n.cellPointer||(n.cellPointer={height:t.Dom.outerHeight(this.cellPointer),width:t.Dom.outerWidth(this.cellPointer)}),n.editorContainer||(n.editorContainer={width:t.Dom.outerWidth(this.editorContainer)}),void 0!=s){var a=this.instance.view.wt.wtScrollbars.horizontal.scrollHandler==e?0:t.Dom.getScrollLeft(this.instance.view.wt.wtScrollbars.horizontal.scrollHandler),l=this.instance.view.wt.wtScrollbars.vertical.scrollHandler==e?0:t.Dom.getScrollTop(this.instance.view.wt.wtScrollbars.vertical.scrollHandler),c=t.Dom.offset(s),h=t.Dom.outerWidth(s),u={x:a,y:l};this.editorContainer.style.top=parseInt(c.top+t.Dom.outerHeight(s)-u.y+n.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(e.innerWidth/2-n.editorContainer.width/2,10)+"px",c.left+h/2>parseInt(this.editorContainer.style.left,10)+n.editorContainer.width?this.editorContainer.style.left=e.innerWidth-n.editorContainer.width+"px":c.left+h/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(c.left-n.cellPointer.width/2-t.Dom.offset(this.editorContainer).left+h/2-u.x,10)+"px"}}},o.prototype.updateEditorData=function(){var e=this.instance.getSelected(),t=this.instance.getDataAtCell(e[0],e[1]);this.row=e[0],this.col=e[1],this.setValue(t),this.updateEditorPosition()},o.prototype.prepareAndSave=function(){if(!this.valueChanged())return!0;var e=[[String.prototype.trim.call(this.getValue())]];this.saveValue(e)},o.prototype.bindEvents=function(){var o=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(e){o.prepareAndSave(),o.instance.selection.transformStart(0,-1,null,!0),o.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(e){o.prepareAndSave(),o.instance.selection.transformStart(0,1,null,!0),o.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(e){o.prepareAndSave(),o.instance.selection.transformStart(-1,0,null,!0),o.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(e){o.prepareAndSave(),o.instance.selection.transformStart(1,0,null,!0),o.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(e){if(1==e.touches.length){var t=e.touches[0],n={x:o.editorContainer.offsetLeft,y:o.editorContainer.offsetTop},r={x:t.pageX-n.x,y:t.pageY-n.y};o.eventManager.addEventListener(this,"touchmove",function(e){var t=e.touches[0];o.updateEditorPosition(t.pageX-r.x,t.pageY-r.y),o.hideCellPointer(),e.preventDefault()})}}),this.eventManager.addEventListener(document.body,"touchend",function(e){t.Dom.isChildOf(e.target,o.editorContainer)||t.Dom.isChildOf(e.target,o.instance.rootElement)||o.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtScrollbars.horizontal.scrollHandler,"scroll",function(){o.instance.view.wt.wtScrollbars.horizontal.scrollHandler!=e&&o.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtScrollbars.vertical.scrollHandler,"scroll",function(){o.instance.view.wt.wtScrollbars.vertical.scrollHandler!=e&&o.hideCellPointer()})},o.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},t.editors.MobileTextEditor=o,t.editors.registerEditor("mobile",t.editors.MobileTextEditor)}(t),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.beginEditing=function(){var e=this.TD.querySelector('input[type="checkbox"]');e&&e.click()},t.prototype.finishEditing=function(){},t.prototype.init=function(){},t.prototype.open=function(){},t.prototype.close=function(){},t.prototype.getValue=function(){},t.prototype.setValue=function(){},t.prototype.focus=function(){},e.editors.CheckboxEditor=t,e.editors.registerEditor("checkbox",t)}(t),function(t){var o,n=t.editors.TextEditor.prototype.extend();n.prototype.init=function(){if("undefined"==typeof jQuery)throw new Error("You need to include jQuery to your project in order to use the jQuery UI Datepicker.");if(o=jQuery,!o.datepicker)throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?");t.editors.TextEditor.prototype.init.apply(this,arguments),this.isCellEdited=!1;var e=this;this.instance.addHook("afterDestroy",function(){e.destroyElements()})},n.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments),this.datePicker=document.createElement("DIV"),t.Dom.addClass(this.datePicker,"htDatepickerHolder"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=99,document.body.appendChild(this.datePicker),this.$datePicker=o(this.datePicker);var e=this,n={dateFormat:"yy-mm-dd",showButtonPanel:!0,changeMonth:!0,changeYear:!0,onSelect:function(t){e.setValue(t),e.finishEditing(!1)}};this.$datePicker.datepicker(n);var r=t.eventManager(this);r.addEventListener(this.datePicker,"mousedown",function(e){t.helper.stopPropagation(e)}),this.hideDatepicker()},n.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy"),this.$datePicker.remove()},n.prototype.open=function(){t.editors.TextEditor.prototype.open.call(this),this.showDatepicker()},n.prototype.finishEditing=function(){this.hideDatepicker(),t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},n.prototype.showDatepicker=function(){var o,n,r=this.TD.getBoundingClientRect();this.datePickerStyle.top=e.pageYOffset+r.top+t.Dom.outerHeight(this.TD)+"px",this.datePickerStyle.left=e.pageXOffset+r.left+"px",o=function(){},o.prototype=this.cellProperties,n=new o,n.defaultDate=this.originalValue||void 0,this.$datePicker.datepicker("option",n),this.originalValue&&this.$datePicker.datepicker("setDate",this.originalValue),this.datePickerStyle.display="block"},n.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"},t.editors.DateEditor=n,t.editors.registerEditor("date",n)}(t),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);var t=document.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.htEditor=new e(t),this.assignHooks()},t.prototype.prepare=function(t,o,n,r,i,s){e.editors.TextEditor.prototype.prepare.apply(this,arguments);var a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var e=this.getValue();void 0!==e&&a.setValue(e),a.instance.destroyEditor()}};this.cellProperties.handsontable&&e.helper.extend(l,s.handsontable),this.htEditor&&this.htEditor.destroy(),this.htEditor=new e(this.htContainer,l)};var o=function(t){if(null!=t&&null==t.isImmediatePropagationEnabled&&(t.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1,this.cancelBubble=!0},t.isImmediatePropagationEnabled=!0,t.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled}),!t.isImmediatePropagationStopped()){var o,n=this.getActiveEditor(),r=n.htEditor.getInstance();if(t.keyCode==e.helper.keyCode.ARROW_DOWN)if(r.getSelected()){var i=r.getSelected()[0],s=r.countRows()-1;o=Math.min(s,i+1)}else o=0;else if(t.keyCode==e.helper.keyCode.ARROW_UP&&r.getSelected()){var i=r.getSelected()[0];o=i-1}void 0!==o&&(0>o?r.deselectCell():r.selectCell(o,0),t.preventDefault(),t.stopImmediatePropagation(),n.instance.listen(),n.TEXTAREA.focus())}};t.prototype.open=function(){this.instance.addHook("beforeKeyDown",o),e.editors.TextEditor.prototype.open.apply(this,arguments),this.htEditor.render(),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),e.Dom.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)},t.prototype.close=function(){this.instance.removeHook("beforeKeyDown",o),this.instance.listen(),e.editors.TextEditor.prototype.close.apply(this,arguments)},t.prototype.focus=function(){this.instance.listen(),e.editors.TextEditor.prototype.focus.apply(this,arguments)},t.prototype.beginEditing=function(){var t=this.instance.getSettings().onBeginEditing;t&&t()===!1||e.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},t.prototype.finishEditing=function(){if(this.htEditor.isListening()&&this.instance.listen(),this.htEditor.getSelected()){var t=this.htEditor.getInstance().getValue();void 0!==t&&this.setValue(t)}return e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},t.prototype.assignHooks=function(){var e=this;this.instance.addHook("afterDestroy",function(){e.htEditor&&e.htEditor.destroy()})},e.editors.HandsontableEditor=t,e.editors.registerEditor("handsontable",t)}(t),function(t){var o=t.editors.HandsontableEditor.prototype.extend();o.prototype.init=function(){t.editors.HandsontableEditor.prototype.init.apply(this,arguments);var e=this.htEditor.getInstance();e.updateSettings({height:1}),this.query=null,this.choices=[]},o.prototype.createElements=function(){t.editors.HandsontableEditor.prototype.createElements.apply(this,arguments);var o=function(){return-1!=e.navigator.platform.indexOf("Mac")?"htMacScroll":""};t.Dom.addClass(this.htContainer,"autocompleteEditor"),t.Dom.addClass(this.htContainer,o())};var n=!1,r=function(e){n=!1;var o=this.getActiveEditor(),r=t.helper.keyCode;if(t.helper.isPrintableChar(e.keyCode)||e.keyCode===r.BACKSPACE||e.keyCode===r.DELETE||e.keyCode===r.INSERT){var i=0;if(e.keyCode===r.C&&(e.ctrlKey||e.metaKey))return;o.isOpened()||(i+=10),o.instance._registerTimeout(setTimeout(function(){o.queryChoices(o.TEXTAREA.value),n=!0},i))}};o.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",r),t.editors.HandsontableEditor.prototype.prepare.apply(this,arguments)},o.prototype.open=function(){t.editors.HandsontableEditor.prototype.open.apply(this,arguments),this.TEXTAREA.style.visibility="visible",this.focus();var e=this.htEditor.getInstance(),o=this;e.updateSettings({colWidths:[t.Dom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(e,t,n,r,i){var s=this.getCellMeta(t,n).filteringCaseSensitive===!0;if(i){var a=s?i.indexOf(this.query):i.toLowerCase().indexOf(o.query.toLowerCase());if(-1!=a){var l=i.substr(a,o.query.length);e.innerHTML=i.replace(l,"<strong>"+l+"</strong>")}}}}),n&&(n=!1),o.instance._registerTimeout(setTimeout(function(){o.queryChoices(o.TEXTAREA.value)},0))},o.prototype.close=function(){t.editors.HandsontableEditor.prototype.close.apply(this,arguments)},o.prototype.queryChoices=function(e){if(this.query=e,"function"==typeof this.cellProperties.source){var t=this;this.cellProperties.source(e,function(e){t.updateChoicesList(e)})}else if(Array.isArray(this.cellProperties.source)){var o;if(e&&this.cellProperties.filter!==!1){var n=this.cellProperties.filteringCaseSensitive===!0,r=e.toLowerCase();o=this.cellProperties.source.filter(function(t){return n?-1!=t.indexOf(e):-1!=t.toLowerCase().indexOf(r)})}else o=this.cellProperties.source;this.updateChoicesList(o)}else this.updateChoicesList([])},o.prototype.updateChoicesList=function(e){var n,r=t.Dom.getCaretPosition(this.TEXTAREA),i=t.Dom.getSelectionEndPosition(this.TEXTAREA),s=o.sortByRelevance(this.getValue(),e,this.cellProperties.filteringCaseSensitive);if(0!=this.cellProperties.filter){for(var a=[],l=0,c=s.length;c>l;l++)a.push(e[s[l]]);n=0,e=a}else n=s[0];this.choices=e,this.htEditor.loadData(t.helper.pivot([e])),this.htEditor.updateSettings({height:this.getDropdownHeight()}),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(n),this.instance.listen(),this.TEXTAREA.focus(),t.Dom.setCaretPosition(this.TEXTAREA,r,r!=i?i:void 0)},o.prototype.finishEditing=function(e){e||this.instance.removeHook("beforeKeyDown",r),t.editors.HandsontableEditor.prototype.finishEditing.apply(this,arguments)},o.prototype.highlightBestMatchingChoice=function(e){"number"==typeof e?this.htEditor.selectCell(e,0):this.htEditor.deselectCell()},o.sortByRelevance=function(e,t,o){var n,r,i,s,a,l=[],c=e.length,h=[];if(0===c){for(s=0,a=t.length;a>s;s++)h.push(s);return h}for(s=0,a=t.length;a>s;s++)n=t[s],r=o?n.indexOf(e):n.toLowerCase().indexOf(e.toLowerCase()),-1!=r&&(i=n.length-r-c,l.push({baseIndex:s,index:r,charsLeft:i,value:n}));for(l.sort(function(e,t){return-1===t.index?-1:-1===e.index?1:e.index<t.index?-1:t.index<e.index?1:e.index===t.index?e.charsLeft<t.charsLeft?-1:e.charsLeft>t.charsLeft?1:0:void 0}),s=0,a=l.length;a>s;s++)h.push(l[s].baseIndex);return h},o.prototype.getDropdownHeight=function(){var e=this.htEditor.getInstance().getRowHeight(0)||23;return this.choices.length>=10?10*e:this.choices.length*e+8},t.editors.AutocompleteEditor=o,t.editors.registerEditor("autocomplete",o)}(t),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,e.Dom.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},e.editors.PasswordEditor=t,e.editors.registerEditor("password",t)}(t),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.select=document.createElement("SELECT"),e.Dom.addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select)},t.prototype.prepare=function(){e.editors.BaseEditor.prototype.prepare.apply(this,arguments);var t,o=this.cellProperties.selectOptions;t=this.prepareOptions("function"==typeof o?o(this.row,this.col,this.prop):o),e.Dom.empty(this.select);for(var n in t)if(t.hasOwnProperty(n)){var r=document.createElement("OPTION");r.value=n,e.Dom.fastInnerHTML(r,t[n]),this.select.appendChild(r)}},t.prototype.prepareOptions=function(e){var t={};if(Array.isArray(e))for(var o=0,n=e.length;n>o;o++)t[e[o]]=e[o];else"object"==typeof e&&(t=e);return t},t.prototype.getValue=function(){return this.select.value},t.prototype.setValue=function(e){this.select.value=e};var o=function(t){var o=this,n=o.getActiveEditor();switch(t.keyCode){case e.helper.keyCode.ARROW_UP:var r=n.select.find("option:selected").prev();1==r.length&&r.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ARROW_DOWN:var i=n.select.find("option:selected").next();1==i.length&&i.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault()}};t.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},t.prototype.open=function(){var t,n=e.Dom.outerWidth(this.TD),r=e.Dom.outerHeight(this.TD),i=e.Dom.offset(this.instance.rootElement),s=e.Dom.offset(this.TD),a=this.checkEditorSection();switch(a){case"top":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.holder.parentNode);break;case"left":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.holder.parentNode);break;case"corner":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.corner.clone.wtTable.holder.parentNode)}var l=this.select.style;t&&-1!=t?l[t[0]]=t[1]:e.Dom.resetCssTransform(this.select),l.height=r+"px",l.minWidth=n+"px",l.top=s.top-i.top+"px",l.left=s.left-i.left+"px",l.margin="0px",l.display="",this.instance.addHook("beforeKeyDown",o)},t.prototype.close=function(){this.select.style.display="none",this.instance.removeHook("beforeKeyDown",o)},t.prototype.focus=function(){this.select.focus()},e.editors.SelectEditor=t,e.editors.registerEditor("select",t)}(t),function(e){var t=e.editors.AutocompleteEditor.prototype.extend();t.prototype.prepare=function(){e.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments),this.cellProperties.filter=!1,this.cellProperties.strict=!0},e.editors.DropdownEditor=t,e.editors.registerEditor("dropdown",t)}(t),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.beginEditing=function(t){var o=e.editors.TextEditor.prototype;if("undefined"==typeof t&&this.originalValue){var n=""+this.originalValue;"undefined"!=typeof this.cellProperties.language&&numeral.language(this.cellProperties.language);var r=numeral.languageData().delimiters.decimal;n=n.replace(".",r),o.beginEditing.apply(this,[n])}else o.beginEditing.apply(this,arguments)},e.editors.NumericEditor=t,e.editors.registerEditor("numeric",t)}(t),t.NumericValidator=function(e,t){null===e&&(e=""),t(/^-?\d*(\.|\,)?\d*$/.test(e))};var L=function(e,t){var o=e,n="string"==typeof o?o.toLowerCase():null;return function(e){for(var r=!1,i=0,s=e.length;s>i;i++){if(o===e[i]){r=!0;break}if(n===e[i].toLowerCase()){r=!0;break}}t(r)}};t.AutocompleteValidator=function(e,t){this.strict&&this.source?"function"==typeof this.source?this.source(e,L(e,t)):L(e,t)(this.source):t(!0)},t.mobileBrowser=t.helper.isMobileBrowser(),t.AutocompleteCell={editor:t.editors.AutocompleteEditor,renderer:t.renderers.AutocompleteRenderer,validator:t.AutocompleteValidator},t.CheckboxCell={editor:t.editors.CheckboxEditor,renderer:t.renderers.CheckboxRenderer},t.TextCell={editor:t.mobileBrowser?t.editors.MobileTextEditor:t.editors.TextEditor,renderer:t.renderers.TextRenderer},t.NumericCell={editor:t.editors.NumericEditor,renderer:t.renderers.NumericRenderer,validator:t.NumericValidator,dataType:"number"},t.DateCell={editor:t.editors.DateEditor,renderer:t.renderers.AutocompleteRenderer},t.HandsontableCell={editor:t.editors.HandsontableEditor,renderer:t.renderers.AutocompleteRenderer},t.PasswordCell={editor:t.editors.PasswordEditor,renderer:t.renderers.PasswordRenderer,copyable:!1},t.DropdownCell={editor:t.editors.DropdownEditor,renderer:t.renderers.AutocompleteRenderer,validator:t.AutocompleteValidator},t.cellTypes={text:t.TextCell,date:t.DateCell,numeric:t.NumericCell,checkbox:t.CheckboxCell,autocomplete:t.AutocompleteCell,handsontable:t.HandsontableCell,password:t.PasswordCell,dropdown:t.DropdownCell},t.cellLookup={validator:{numeric:t.NumericValidator,autocomplete:t.AutocompleteValidator}};var N=function(){var o,n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=document.body,i=document.createTextNode(""),s=document.createElement("SPAN"),a=function(t,o,n){e.attachEvent?t.attachEvent("on"+o,n):t.addEventListener(o,n,!1)},l=function(t,o,n){e.removeEventListener?t.removeEventListener(o,n,!1):t.detachEvent("on"+o,n)},c=function(e){e?/^[a-zA-Z \.,\\\/\|0-9]$/.test(e)||(e="."):e="",void 0!==i.textContent?i.textContent=o.value+e:i.data=o.value+e,s.style.fontSize=t.Dom.getComputedStyle(o).fontSize,s.style.fontFamily=t.Dom.getComputedStyle(o).fontFamily,s.style["white-space"]="pre",r.appendChild(s);var a=s.clientWidth+2;r.removeChild(s),o.style.height=n.minHeight+"px",o.style.width=n.minWidth>a?n.minWidth+"px":a>n.maxWidth?n.maxWidth+"px":a+"px";var l=o.scrollHeight;n.minHeight>l?o.style.height=n.minHeight+"px":n.maxHeight<l?(o.style.height=n.maxHeight+"px",o.style.overflowY="visible"):o.style.height=l+"px"},h=function(){e.setTimeout(c,0)},u=function(e){if(e&&e.minHeight)if("inherit"==e.minHeight)n.minHeight=o.clientHeight;else{var t=parseInt(e.minHeight);isNaN(t)||(n.minHeight=t)}if(e&&e.maxHeight)if("inherit"==e.maxHeight)n.maxHeight=o.clientHeight;else{var r=parseInt(e.maxHeight);isNaN(r)||(n.maxHeight=r)}if(e&&e.minWidth)if("inherit"==e.minWidth)n.minWidth=o.clientWidth;else{var a=parseInt(e.minWidth);isNaN(a)||(n.minWidth=a)}if(e&&e.maxWidth)if("inherit"==e.maxWidth)n.maxWidth=o.clientWidth;else{var l=parseInt(e.maxWidth);isNaN(l)||(n.maxWidth=l)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(i))},d=function(e,t,r){o=e,u(t),"TEXTAREA"==o.nodeName&&(o.style.resize="none",o.style.overflowY="",o.style.height=n.minHeight+"px",o.style.minWidth=n.minWidth+"px",o.style.maxWidth=n.maxWidth+"px",o.style.overflowY="hidden"),r&&(a(o,"change",c),a(o,"cut",h),a(o,"paste",h),a(o,"drop",h),a(o,"keydown",h)),c()};return{init:function(e,t,o){d(e,t,o)},unObserve:function(){l(o,"change",c),l(o,"cut",h),l(o,"paste",h),l(o,"drop",h),l(o,"keydown",h)},resize:c}};!function(e){function t(e){return e.split('"').length-1}e.SheetClip={parse:function(e){var o,n,r,i,s,a,l,c=[],h=0;for(r=e.split("\n"),r.length>1&&""===r[r.length-1]&&r.pop(),o=0,n=r.length;n>o;o+=1){for(r[o]=r[o].split("	"),i=0,s=r[o].length;s>i;i+=1)c[h]||(c[h]=[]),a&&0===i?(l=c[h].length-1,c[h][l]=c[h][l]+"\n"+r[o][0],a&&1&t(r[o][0])&&(a=!1,c[h][l]=c[h][l].substring(0,c[h][l].length-1).replace(/""/g,'"'))):i===s-1&&0===r[o][i].indexOf('"')?(c[h].push(r[o][i].substring(1).replace(/""/g,'"')),a=!0):(c[h].push(r[o][i].replace(/""/g,'"')),a=!1);a||(h+=1)}return c},stringify:function(e){var t,o,n,r,i,s="";for(t=0,o=e.length;o>t;t+=1){for(n=0,r=e[t].length;r>n;n+=1)n>0&&(s+="	"),i=e[t][n],s+="string"==typeof i?i.indexOf("\n")>-1?'"'+i.replace(/"/g,'""')+'"':i:null===i||void 0===i?"":i;o-1>t&&(s+="\n")}return s}}}(e);var I=function(){var e;return{getInstance:function(){return e?e.hasBeenDestroyed()&&e.init():e=new o,e.refCounter++,e}}}();o.prototype.init=function(){var e,o,n=this;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],this._eventManager=t.eventManager(this),o=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",e=this.elDiv.style,e.position="fixed",e.top="-10000px",e.left="-10000px",o.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",this.elTextarea.onpaste=function(e){return"WebkitAppearance"in document.documentElement.style?(this.value=e.clipboardData.getData("Text"),!1):void 0},e=this.elTextarea.style,e.width="10000px",e.height="10000px",e.overflow="hidden",this.elDiv.appendChild(this.elTextarea),"undefined"!=typeof e.opacity&&(e.opacity=0)),this.keydownListener=function(e){var t=!1;if(e.metaKey?t=!0:e.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(t=!0),t){if(document.activeElement!==n.elTextarea&&(""!=n.getSelectionText()||-1!=["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)))return;n.selectNodeText(n.elTextarea),setTimeout(function(){n.selectNodeText(n.elTextarea)},0)}!t||67!==e.keyCode&&86!==e.keyCode&&88!==e.keyCode||(88===e.keyCode?setTimeout(function(){n.triggerCut(e)},0):86===e.keyCode&&setTimeout(function(){n.triggerPaste(e)},0))},this._eventManager.addEventListener(document.documentElement,"keydown",this.keydownListener,!1)},o.prototype.selectNodeText=function(e){e&&e.select()},o.prototype.getSelectionText=function(){var t="";return e.getSelection?t=e.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(t=document.selection.createRange().text),t},o.prototype.copyable=function(e){if("string"!=typeof e&&void 0===e.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=e},o.prototype.onCut=function(e){this.cutCallbacks.push(e)},o.prototype.onPaste=function(e){this.pasteCallbacks.push(e)},o.prototype.removeCallback=function(e){var t,o;for(t=0,o=this.copyCallbacks.length;o>t;t++)if(this.copyCallbacks[t]===e)return this.copyCallbacks.splice(t,1),!0;for(t=0,o=this.cutCallbacks.length;o>t;t++)if(this.cutCallbacks[t]===e)return this.cutCallbacks.splice(t,1),!0;for(t=0,o=this.pasteCallbacks.length;o>t;t++)if(this.pasteCallbacks[t]===e)return this.pasteCallbacks.splice(t,1),!0;return!1},o.prototype.triggerCut=function(e){var t=this;t.cutCallbacks&&setTimeout(function(){for(var o=0,n=t.cutCallbacks.length;n>o;o++)t.cutCallbacks[o](e)},50)},o.prototype.triggerPaste=function(e,t){var o=this;o.pasteCallbacks&&setTimeout(function(){for(var n=(t||o.elTextarea.value).replace(/\n$/,""),r=0,i=o.pasteCallbacks.length;i>r;r++)o.pasteCallbacks[r](n,e)},50)},o.prototype.destroy=function(){this.hasBeenDestroyed()||0!=--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),this._eventManager.removeEventListener(document.documentElement,"keydown",this.keydownListener,!1))},o.prototype.hasBeenDestroyed=function(){return!this.refCounter};var M;!function(t){function o(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function n(e,t){var r;for(var i in e)if(e.hasOwnProperty(i)){if(e[i]===t)return o(i)+"/";if("object"==typeof e[i]&&(r=n(e[i],t),""!=r))return o(i)+"/"+r}return""}function r(e,t){if(e===t)return"/";var o=n(e,t);if(""===o)throw new Error("Object not found in root");return"/"+o}function i(e){for(var t=0,o=v.length;o>t;t++)if(v[t].obj===e)return v[t]}function s(e,t){for(var o=0,n=e.observers.length;n>o;o++)if(e.observers[o].callback===t)return e.observers[o].observer}function a(e,t){for(var o=0,n=e.observers.length;n>o;o++)if(e.observers[o].observer===t)return void e.observers.splice(o,1)}function l(e,t){d(t),Object.observe?u(t,e):clearTimeout(t.next);var o=i(e);a(o,t)}function c(t,o){var n,a=[],l=t,c=i(t);if(c?n=s(c,o):(c=new C(t),v.push(c)),n)return n;if(Object.observe)n=function(e){u(n,t),h(n,t);for(var i=0,s=e.length;s>i;){if(("length"!==e[i].name||!R(e[i].object))&&"__Jasmine_been_here_before__"!==e[i].name){var c=e[i].type;switch(c){case"new":c="add";break;case"deleted":c="delete";break;case"updated":c="update"}w[c].call(e[i],a,r(l,e[i].object))}i++}a&&o&&o(a),n.patches=a,a=[]};else if(n={},c.value=JSON.parse(JSON.stringify(t)),o){n.callback=o,n.next=null;var f=this.intervals||[100,1e3,1e4,6e4],p=0,g=function(){d(n)},m=function(){clearTimeout(n.next),n.next=setTimeout(function(){g(),p=0,n.next=setTimeout(b,f[p++])},0)},b=function(){g(),p==f.length&&(p=f.length-1),n.next=setTimeout(b,f[p++])};"undefined"!=typeof e&&(e.addEventListener?(e.addEventListener("mousedown",m),e.addEventListener("mouseup",m),e.addEventListener("keydown",m)):(e.attachEvent("onmousedown",m),e.attachEvent("onmouseup",m),e.attachEvent("onkeydown",m))),n.next=setTimeout(b,f[p++])}return n.patches=a,n.object=t,c.observers.push(new y(o,n)),h(n,t)}function h(e,t){if(Object.observe){Object.observe(t,e);for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];n&&"object"==typeof n&&h(e,n)}}return e}function u(e,t){if(Object.observe){Object.unobserve(t,e);for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];n&&"object"==typeof n&&u(e,n)}}return e}function d(e){if(Object.observe)Object.deliverChangeRecords(e);else{for(var t,o=0,n=v.length;n>o;o++)if(v[o].obj===e.object){t=v[o];break}f(t.value,e.object,e.patches,"")}var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function f(e,t,n,r){for(var i=b(t),s=b(e),a=!1,l=!1,c=s.length-1;c>=0;c--){var h=s[c],u=e[h];if(t.hasOwnProperty(h)){var d=t[h];u instanceof Object?f(u,d,n,r+"/"+o(h)):u!=d&&(a=!0,n.push({op:"replace",path:r+"/"+o(h),value:d}),e[h]=d)}else n.push({op:"remove",path:r+"/"+o(h)}),delete e[h],l=!0}if(l||i.length!=s.length)for(var c=0;c<i.length;c++){var h=i[c];e.hasOwnProperty(h)||(n.push({op:"add",path:r+"/"+o(h),value:t[h]}),e[h]=JSON.parse(JSON.stringify(t[h])))}}function p(e,t){for(var o,n=!1,r=0,i=t.length;i>r;){o=t[r];for(var s=o.path.split("/"),a=e,l=1,c=s.length;;)if(R(a)){var h=parseInt(s[l],10);if(l++,l>=c){n=m[o.op].call(o,a,h,e);break}a=a[h]}else{var u=s[l];if(-1!=u.indexOf("~")&&(u=u.replace(/~1/g,"/").replace(/~0/g,"~")),l++,l>=c){n=g[o.op].call(o,a,u,e);break}a=a[u]}r++}return n}var g={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,o){var n={op:"_get",path:this.from};return p(o,[n]),p(o,[{op:"remove",path:this.from}]),p(o,[{op:"add",path:this.path,value:n.value}]),!0},copy:function(e,t,o){var n={op:"_get",path:this.from};return p(o,[n]),p(o,[{op:"add",path:this.path,value:n.value}]),!0},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}},m={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:g.move,copy:g.copy,test:g.test,_get:g._get},w={add:function(e,t){var n={op:"add",path:t+o(this.name),value:this.object[this.name]};
e.push(n)},"delete":function(e,t){var n={op:"remove",path:t+o(this.name)};e.push(n)},update:function(e,t){var n={op:"replace",path:t+o(this.name),value:this.object[this.name]};e.push(n)}},v=[];t.intervals;var C=function(){function e(e){this.observers=[],this.obj=e}return e}(),y=function(){function e(e,t){this.callback=e,this.observer=t}return e}();t.unobserve=l,t.observe=c,t.generate=d;var b;b=Object.keys?Object.keys:function(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(o);return t};var R;R=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},t.apply=p}(M||(M={})),"undefined"!=typeof exports&&(exports.apply=M.apply,exports.observe=M.observe,exports.unobserve=M.unobserve,exports.generate=M.generate),t.PluginHookClass=function(){function e(){this.hooks=t(),this.globalBucket={},this.legacy=o}var t=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeSetRangeEnd:[],beforeDrawBorders:[],beforeChange:[],beforeChangeRender:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeOnCellMouseDown:[],beforeTouchScroll:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterSetCellMeta:[],afterGetColHeader:[],afterGetRowHeader:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],afterCellMetaReset:[],afterIsMultipleSelectionCheck:[],afterDocumentKeyDown:[],afterMomentumScroll:[],modifyColWidth:[],modifyRowHeight:[],modifyRow:[],modifyCol:[]}},o={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};return e.prototype.getBucket=function(e){return e?(e.pluginHookBucket||(e.pluginHookBucket={}),e.pluginHookBucket):this.globalBucket},e.prototype.add=function(e,t,n){if(Array.isArray(t))for(var r=0,i=t.length;i>r;r++)this.add(e,t[r]);else{e in o&&(e=o[e]);var s=this.getBucket(n);"undefined"==typeof s[e]&&(s[e]=[]),t.skip=!1,-1==s[e].indexOf(t)&&s[e].push(t)}return this},e.prototype.once=function(e,t,o){if(Array.isArray(t))for(var n=0,r=t.length;r>n;n++)t[n].runOnce=!0,this.add(e,t[n],o);else t.runOnce=!0,this.add(e,t,o)},e.prototype.remove=function(e,t,n){var r=!1;e in o&&(e=o[e]);var i=this.getBucket(n);if("undefined"!=typeof i[e])for(var s=0,a=i[e].length;a>s;s++)if(i[e][s]==t){i[e][s].skip=!0,r=!0;break}return r},e.prototype.run=function(e,t,n,r,i,s,a,l){t in o&&(t=o[t]),this._runBucket(this.globalBucket,e,t,n,r,i,s,a,l),this._runBucket(this.getBucket(e),e,t,n,r,i,s,a,l)},e.prototype._runBucket=function(e,t,o,n,r,i,s,a,l){var c=e[o];if(c)for(var h=0,u=c.length;u>h;h++)c[h].skip||(c[h].call(t,n,r,i,s,a,l),c[h].runOnce&&this.remove(o,c[h],e===this.globalBucket?null:t))},e.prototype.destroy=function(e){var t=this.getBucket(e);for(var o in t)if(t.hasOwnProperty(o))for(var n=0,r=t[o].length;r>n;n++)this.remove(o,t[o],e)},e.prototype.execute=function(e,t,n,r,i,s,a,l){return t in o&&(t=o[t]),n=this._executeBucket(this.globalBucket,e,t,n,r,i,s,a,l),n=this._executeBucket(this.getBucket(e),e,t,n,r,i,s,a,l)},e.prototype._executeBucket=function(e,t,o,n,r,i,s,a,l){var c,h=e[o];if(h)for(var u=0,d=h.length;d>u;u++)if(!h[u].skip&&(c=h[u].call(t,n,r,i,s,a,l),void 0!==c&&(n=c),h[u].runOnce&&this.remove(o,h[u],e===this.globalBucket?null:t),c===!1))return!1;return n},e.prototype.register=function(e){this.isRegistered(e)||(this.hooks[e]=[])},e.prototype.deregister=function(e){delete this.hooks[e]},e.prototype.isRegistered=function(e){return"undefined"!=typeof this.hooks[e]},e.prototype.getRegistered=function(){return Object.keys(this.hooks)},e}(),t.hooks=new t.PluginHookClass,t.PluginHooks=t.hooks,function(e){function t(){function t(e){var t=document,o=this;o.table=t.createElement("table"),o.theadTh=t.createElement("th"),o.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(o.theadTh),o.tableStyle=o.table.style,o.tableStyle.tableLayout="auto",o.tableStyle.width="auto",o.tbody=t.createElement("tbody"),o.table.appendChild(o.tbody),o.container=t.createElement("div"),o.container.className=e.rootElement.className+" hidden",o.containerStyle=o.container.style,o.container.appendChild(o.table)}var n=this,r=5;this.beforeInit=function(){var e=this;e.autoColumnWidths=[],e.getSettings().autoColumnSize!==!1?e.autoColumnSizeTmp||(e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},e.addHook("beforeRender",o.determineIfChanged),e.addHook("modifyColWidth",o.modifyColWidth),e.addHook("afterDestroy",o.afterDestroy),e.determineColumnWidth=n.determineColumnWidth):e.autoColumnSizeTmp&&(e.removeHook("beforeRender",o.determineIfChanged),e.removeHook("modifyColWidth",o.modifyColWidth),e.removeHook("afterDestroy",o.afterDestroy),delete e.determineColumnWidth,n.afterDestroy.call(e))},this.determineIfChanged=function(e){e&&o.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(o){var n=this,i=n.autoColumnSizeTmp;i.container||t.call(i,n),i.container.className=n.rootElement.className+" htAutoColumnSize",i.table.className=n.table.className;for(var s=n.countRows(),a={},l=0,c=0;s>c;c++){var h=e.helper.stringify(n.getDataAtCell(c,o)),u=h.length;u>l&&(l=u),a[u]||(a[u]={needed:r,strings:[]}),a[u].needed&&(a[u].strings.push({value:h,row:c}),a[u].needed--)}var d=n.getSettings();d.colHeaders&&n.view.appendColHeader(o,i.theadTh),e.Dom.empty(i.tbody);for(var f in a)if(a.hasOwnProperty(f))for(var p=0,g=a[f].strings.length;g>p;p++){var m=a[f].strings[p].row,w=n.getCellMeta(m,o);w.col=o,w.row=m;var v=n.getCellRenderer(w),C=document.createElement("tr"),y=document.createElement("td");v(n,y,m,o,n.colToProp(o),a[f].strings[p].value,w),c++,C.appendChild(y),i.tbody.appendChild(C)}var b=n.rootElement.parentNode;b.appendChild(i.container);var R=e.Dom.outerWidth(i.table);return b.removeChild(i.container),R},this.determineColumnsWidth=function(){var e=this,t=this.getSettings();if(t.autoColumnSize||!t.colWidths)for(var o=this.countCols(),r=0;o>r;r++)e._getColWidthFromSettings(r)||(this.autoColumnWidths[r]=n.determineColumnWidth.call(e,r))},this.modifyColWidth=function(e,t){return this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e?this.autoColumnWidths[t]:e},this.afterDestroy=function(){var e=this;e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode&&e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container),e.autoColumnSizeTmp=null}}var o=new t;e.hooks.add("beforeInit",o.beforeInit),e.hooks.add("afterUpdateSettings",o.beforeInit)}(t);var W=new n;t.hooks.add("afterInit",function(){W.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){W.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyRow",W.translateRow),t.hooks.add("afterGetColHeader",W.getColHeader),t.hooks.register("beforeColumnSort"),t.hooks.register("afterColumnSort"),function(e){function t(o){this.instance=o;var r=this;if(r.menus=[],r.htMenus={},r.triggerRows=[],r.eventManager=e.eventManager(r),this.enabled=!0,this.instance.addHook("afterDestroy",function(){r.destroy()}),this.defaultOptions={items:[{key:"row_above",name:"Zeile oberhalb einfügen",callback:function(e,t){this.alter("insert_row",t.start.row)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]],o=t.join(",")==e.join(",");return e[0]<0||this.countRows()>=this.getSettings().maxRows||o}},{key:"row_below",name:"Zeile unterhalb einfügen",callback:function(e,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]],o=t.join(",")==e.join(",");return this.getSelected()[0]<0||this.countRows()>=this.getSettings().maxRows||o}},t.SEPARATOR,{key:"col_left",name:"Spalte links einfügen",callback:function(e,t){this.alter("insert_col",t.start.col)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1],o=t.join(",")==e.join(",");return this.getSelected()[1]<0||this.countCols()>=this.getSettings().maxCols||o}},{key:"col_right",name:"Spalte rechts einfügen",callback:function(e,t){this.alter("insert_col",t.end.col+1)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1],o=t.join(",")==e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||o}},t.SEPARATOR,{key:"remove_row",name:"Zeile entfernen",callback:function(e,t){var o=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,o)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]],o=t.join(",")==e.join(",");return e[0]<0||o}},{key:"remove_col",name:"Spalte entfernen",callback:function(e,t){var o=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,o)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1],o=t.join(",")==e.join(",");return e[1]<0||o}},t.SEPARATOR,{key:"undo",name:"Rückgängig machen",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},{key:"redo",name:"Wiederherstellen",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}]},r.options={},e.helper.extend(r.options,this.options),this.bindMouseEvents(),this.markSelected=function(e){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+e},this.checkSelectionAlignment=function(e,t){var o=!1;return e.getSelectedRange().forAll(function(n,r){var i=e.getCellMeta(n,r).className;return i&&-1!=i.indexOf(t)?(o=!0,!1):void 0}),o},!this.instance.getSettings().allowInsertRow){var i=n(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(i,1);var s=n(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(s,1),this.defaultOptions.items.splice(s,1)}if(!this.instance.getSettings().allowInsertColumn){var a=n(this.defaultOptions.items,"col_left");this.defaultOptions.items.splice(a,1);var l=n(this.defaultOptions.items,"col_right");this.defaultOptions.items.splice(l,1),this.defaultOptions.items.splice(l,1)}var c,h,u=!1,d=!1;this.instance.getSettings().allowRemoveRow||(c=n(this.defaultOptions.items,"remove_row"),this.defaultOptions.items.splice(c,1),u=!0),this.instance.getSettings().allowRemoveColumn||(h=n(this.defaultOptions.items,"remove_col"),this.defaultOptions.items.splice(h,1),d=!0),u&&d&&this.defaultOptions.items.splice(h,1),this.checkSelectionReadOnlyConsistency=function(e){var t=!1;return e.getSelectedRange().forAll(function(o,n){return e.getCellMeta(o,n).readOnly?(t=!0,!1):void 0}),t},e.hooks.run(o,"afterContextMenuDefaultOptions",this.defaultOptions)}function o(e,t){for(var o=0,n=e.length;n>o;o++)if(e[o].key===t)return e[o]}function n(e,t){for(var o=0,n=e.length;n>o;o++)if(e[o].key===t)return o}function r(){if(!this.rootElement.className.indexOf("htContextMenu")){for(var e=0,o=0,n=this.getSettings().data.length,r=0;n>r;r++)this.getSettings().data[r].name==t.SEPARATOR.name?e+=2:o+=26;this.view.wt.wtScrollbars.vertical.fixedContainer.style.height=o+e+"px"}}function i(){var o=this,n=o.getSettings().contextMenu,r=e.helper.isObject(n)?n:{};n?(o.contextMenu||(o.contextMenu=new t(o,r)),o.contextMenu.enable()):o.contextMenu&&(o.contextMenu.destroy(),delete o.contextMenu)}t.prototype.createMenu=function(t,o){t&&(t=t.replace(/ /g,"_"),t="htContextSubMenu_"+t);var n;return n=document.querySelector(t?".htContextMenu."+t:".htContextMenu"),n||(n=document.createElement("DIV"),e.Dom.addClass(n,"htContextMenu"),t&&e.Dom.addClass(n,t),document.getElementsByTagName("body")[0].appendChild(n)),this.menus.indexOf(n)<0&&(this.menus.push(n),o=o||0,this.triggerRows.push(o)),n},t.prototype.bindMouseEvents=function(){function o(o){var n=this.instance.getSettings();this.closeAll(),o.preventDefault(),e.helper.stopPropagation(o);var r=this.instance.getSettings().rowHeaders,i=this.instance.getSettings().colHeaders;if(r||i||"TD"==o.target.nodeName||e.Dom.hasClass(o.target,"current")&&e.Dom.hasClass(o.target,"wtBorder")){var s=this.createMenu(),a=this.getItems(n.contextMenu);this.show(s,a),this.setMenuPosition(o,s),this.eventManager.addEventListener(document.documentElement,"mousedown",e.helper.proxy(t.prototype.closeAll,this))}}var n=e.eventManager(this.instance);n.addEventListener(this.instance.rootElement,"contextmenu",e.helper.proxy(o,this))},t.prototype.bindTableEvents=function(){this._afterScrollCallback=function(){},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},t.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},t.prototype.performAction=function(e,o){var n=this,r=o.getSelected()[0],i=o.getData()[r];if(i.disabled!==!0&&("function"!=typeof i.disabled||i.disabled.call(this.instance)!==!0)&&!i.hasOwnProperty("submenu")){if("function"!=typeof i.callback)return;var s=this.instance.getSelectedRange(),a=t.utils.normalizeSelection(s);i.callback.call(this.instance,i.key,a,e),n.closeAll()}},t.prototype.unbindMouseEvents=function(){this.eventManager.clear();var t=e.eventManager(this.instance);t.removeEventListener(this.instance.rootElement,"contextmenu")},t.prototype.show=function(t,o){var n=this;t.removeAttribute("style"),t.style.display="block";var r={data:o,colHeaders:!1,colWidths:[200],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:e.helper.proxy(this.renderer,this)}],renderAllRows:!0,beforeKeyDown:function(e){n.onBeforeKeyDown(e,i)},afterOnCellMouseOver:function(e,t,o){n.onCellMouseOver(e,t,o,i)}},i=new e(t,r);this.eventManager.removeEventListener(t,"mousedown"),this.eventManager.addEventListener(t,"mousedown",function(e){n.performAction(e,i)}),this.bindTableEvents(),i.listen(),this.htMenus[i.guid]=i},t.prototype.close=function(e){this.hide(e),this.eventManager.clear(),this.unbindTableEvents(),this.instance.listen()},t.prototype.closeAll=function(){for(;this.menus.length>0;){var e=this.menus.pop();e&&this.close(e)}this.triggerRows=[]},t.prototype.closeLastOpenedSubMenu=function(){var e=this.menus.pop();e&&this.hide(e)},t.prototype.hide=function(e){e.style.display="none";var t=this.htMenus[e.id];t.destroy(),delete this.htMenus[e.id]},t.prototype.renderer=function(o,n,r,i,s,a){function l(e){return e.hasOwnProperty("submenu")}function c(e){return new RegExp(t.SEPARATOR.name,"i").test(e.name)}function h(e){return e.disabled===!0||"function"==typeof e.disabled&&e.disabled.call(u.instance)===!0}var u=this,d=o.getData()[r],f=document.createElement("DIV");"function"==typeof a&&(a=a.call(this.instance)),e.Dom.empty(n),n.appendChild(f),c(d)?e.Dom.addClass(n,"htSeparator"):e.Dom.fastInnerHTML(f,a),h(d)?(e.Dom.addClass(n,"htDisabled"),this.eventManager.addEventListener(f,"mouseenter",function(){o.deselectCell()})):l(d)?(e.Dom.addClass(n,"htSubmenu"),this.eventManager.addEventListener(f,"mouseenter",function(){o.selectCell(r,i)})):(e.Dom.removeClass(n,"htSubmenu"),e.Dom.removeClass(n,"htDisabled"),this.eventManager.addEventListener(f,"mouseenter",function(){o.selectCell(r,i)}))},t.prototype.onCellMouseOver=function(e,t,o,n){var r=this.menus.length;if(r>0){var i=this.menus[r-1];i.id!=n.guid&&this.closeLastOpenedSubMenu()}else this.closeLastOpenedSubMenu();if(-1!=o.className.indexOf("htSubmenu")){var s=n.getData()[t.row],a=this.getItems(s.submenu),l=this.createMenu(s.name,t.row),c=o.getBoundingClientRect();this.show(l,a),this.setSubMenuPosition(c,l)}},t.prototype.onBeforeKeyDown=function(o,n){function r(e){var o=e.getCell(0,0);t.utils.isSeparator(o)||t.utils.isDisabled(o)?s(0,0,e):e.selectCell(0,0)}function i(e){var o=e.countRows()-1,n=e.getCell(o,0);t.utils.isSeparator(n)||t.utils.isDisabled(n)?a(o,0,e):e.selectCell(o,0)}function s(e,o,n){var r=e+1,i=r<n.countRows()?n.getCell(r,o):null;i&&(t.utils.isSeparator(i)||t.utils.isDisabled(i)?s(r,o,n):n.selectCell(r,o))}function a(e,o,n){var r=e-1,i=r>=0?n.getCell(r,o):null;i&&(t.utils.isSeparator(i)||t.utils.isDisabled(i)?a(r,o,n):n.selectCell(r,o))}function l(e,t,o,n){var r=e.getData()[n],i=t.getItems(r.submenu),s=t.createMenu(r.name,n),a=o.getBoundingClientRect(),l=t.show(s,i);t.setSubMenuPosition(a,s),l.selectCell(0,0)}e.Dom.enableImmediatePropagation(o);var c=this,h=n.getSelected();switch(o.keyCode){case e.helper.keyCode.ESCAPE:c.closeAll(),o.preventDefault(),o.stopImmediatePropagation();break;case e.helper.keyCode.ENTER:h&&c.performAction(o,n);break;case e.helper.keyCode.ARROW_DOWN:h?s(h[0],h[1],n,c):r(n,c),o.preventDefault(),o.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_UP:h?a(h[0],h[1],n,c):i(n,c),o.preventDefault(),o.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_RIGHT:if(h){var u=h[0],d=n.getCell(h[0],0);t.utils.hasSubMenu(d)&&l(n,c,d,u)}o.preventDefault(),o.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_LEFT:if(h){if(-1!=n.rootElement.className.indexOf("htContextSubMenu_")){c.closeLastOpenedSubMenu();var f=c.menus.length;if(f>0){var p=c.menus[f-1],g=c.triggerRows.pop();n=this.htMenus[p.id],n.selectCell(g,0)}}o.preventDefault(),o.stopImmediatePropagation()}}},t.prototype.getItems=function(t){function n(t){"string"==typeof t?this.name=t:e.helper.extend(this,t)}var r,i;n.prototype=t,t&&t.items&&(t=t.items),t===!0&&(t=this.defaultOptions.items),r=[];for(var s in t)t.hasOwnProperty(s)&&(i="string"==typeof t[s]?o(this.defaultOptions.items,t[s]):o(this.defaultOptions.items,s),i||(i=t[s]),i=new n(i),"object"==typeof t[s]&&e.helper.extend(i,t[s]),i.key||(i.key=s),r.push(i));return r},t.prototype.setSubMenuPosition=function(t,o){var n=e.Dom.getWindowScrollTop(),r=e.Dom.getWindowScrollLeft(),i={top:n+t.top,topRelative:t.top,left:t.left,leftRelative:t.left-r,scrollTop:n,scrollLeft:r,cellHeight:t.height,cellWidth:t.width};this.menuFitsBelowCursor(i,o,document.body.clientWidth)?this.positionMenuBelowCursor(i,o,!0):this.menuFitsAboveCursor(i,o)?this.positionMenuAboveCursor(i,o,!0):this.positionMenuBelowCursor(i,o,!0),this.menuFitsOnRightOfCursor(i,o,document.body.clientWidth)?this.positionMenuOnRightOfCursor(i,o,!0):this.positionMenuOnLeftOfCursor(i,o,!0)},t.prototype.setMenuPosition=function(t,o){var n=e.Dom.getWindowScrollTop(),r=e.Dom.getWindowScrollLeft(),i=t.pageY||t.clientY+n,s=t.pageX||t.clientX+r,a={top:i,topRelative:i-n,left:s,leftRelative:s-r,scrollTop:n,scrollLeft:r,cellHeight:t.target.clientHeight,cellWidth:t.target.clientWidth};this.menuFitsBelowCursor(a,o,document.body.clientHeight)?this.positionMenuBelowCursor(a,o):this.menuFitsAboveCursor(a,o)?this.positionMenuAboveCursor(a,o):this.positionMenuBelowCursor(a,o),this.menuFitsOnRightOfCursor(a,o,document.body.clientWidth)?this.positionMenuOnRightOfCursor(a,o):this.positionMenuOnLeftOfCursor(a,o)},t.prototype.menuFitsAboveCursor=function(e,t){return e.topRelative>=t.offsetHeight},t.prototype.menuFitsBelowCursor=function(e,t,o){return e.topRelative+t.offsetHeight<=o},t.prototype.menuFitsOnRightOfCursor=function(e,t,o){return e.leftRelative+t.offsetWidth<=o},t.prototype.positionMenuBelowCursor=function(e,t){t.style.top=e.top+"px"},t.prototype.positionMenuAboveCursor=function(e,t,o){t.style.top=o?e.top+e.cellHeight-t.offsetHeight+"px":e.top-t.offsetHeight+"px"},t.prototype.positionMenuOnRightOfCursor=function(e,t,o){t.style.left=o?1+e.left+e.cellWidth+"px":1+e.left+"px"},t.prototype.positionMenuOnLeftOfCursor=function(e,t,o){t.style.left=o?e.left-t.offsetWidth+"px":e.left-t.offsetWidth+"px"},t.utils={},t.utils.normalizeSelection=function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}},t.utils.isSeparator=function(t){return e.Dom.hasClass(t,"htSeparator")},t.utils.hasSubMenu=function(t){return e.Dom.hasClass(t,"htSubmenu")},t.utils.isDisabled=function(t){return e.Dom.hasClass(t,"htDisabled")},t.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},t.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.closeAll(),this.unbindMouseEvents(),this.unbindTableEvents())},t.prototype.destroy=function(){for(this.closeAll();this.menus.length>0;){var e=this.menus.pop();this.triggerRows.pop(),e&&(this.close(e),this.isMenuEnabledByOtherHotInstance()||this.removeMenu(e))}this.unbindMouseEvents(),this.unbindTableEvents()},t.prototype.isMenuEnabledByOtherHotInstance=function(){for(var e=document.querySelectorAll(".handsontable"),t=!1,o=0,n=e.length;n>o;o++){var r=this.htMenus[e[o].id];if(r&&r.getSettings().contextMenu){t=!0;break}}return t},t.prototype.removeMenu=function(e){e.parentNode&&this.menu.parentNode.removeChild(e)},t.SEPARATOR={name:"---------"},e.hooks.add("afterInit",i),e.hooks.add("afterUpdateSettings",i),e.hooks.add("afterInit",r),e.PluginHooks.register("afterContextMenuDefaultOptions"),e.ContextMenu=t}(t);var B=function(){var e=this,o=e.getSettings().comments;o&&(t.Comments=new r(e),t.Comments.init())},V=function(e,o,n,r,i,s){s.comment&&t.Dom.addClass(e,s.commentedCellClassName)},F=function(e){var o=this;o.getSettings().comments&&(e.items.push(t.ContextMenu.SEPARATOR),e.items.push({key:"commentsAddEdit",name:function(){var e=t.Comments.checkSelectionCommentsConsistency();return e?"Edit Comment":"Add Comment"},callback:function(){t.Comments.showComment(this.getSelectedRange())},disabled:function(){return!1}}),e.items.push({key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(e,o){t.Comments.removeComment(o.start.row,o.start.col)},disabled:function(){var e=t.Comments.checkSelectionCommentsConsistency();return!e}}))};t.hooks.add("beforeInit",B),t.hooks.add("afterContextMenuDefaultOptions",F),t.hooks.add("afterRenderer",V),function(t){function o(){function o(e){d=this,f=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){u=t;var o=f.getBoundingClientRect();h=o.left,p.style.top=o.top+"px",p.style.left=h+"px",d.rootElement.appendChild(p)}}function n(e,t){var o=e.getBoundingClientRect(),n=6;p.style.left=t>0?o.left+o.width-n+"px":o.left+"px"}function r(){var e=this;t.Dom.addClass(p,"active"),t.Dom.addClass(g,"active");var o=f.getBoundingClientRect();g.style.width=o.width+"px",g.style.height=e.view.maximumVisibleElementHeight(0)+"px",g.style.top=p.style.top,g.style.left=h+"px",e.rootElement.appendChild(g)}function i(e){g.style.left=h+e+"px"}function s(){t.Dom.removeClass(p,"active"),t.Dom.removeClass(g,"active")}var a,l,c,h,u,d,f,p=document.createElement("DIV"),g=document.createElement("DIV"),m=t.eventManager(this);p.className="manualColumnMover",g.className="manualColumnMoverGuide";var w=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualColumnPositions",e.manualColumnPositions)},v=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","manualColumnPositions",o),o.value},C=function(e){return"BODY"!=e.tagName?"THEAD"==e.parentNode.tagName?!0:(e=e.parentNode,C(e)):!1},y=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:y(e.parentNode):null},b=function(){var h,d=this;m.addEventListener(d.rootElement,"mouseover",function(e){if(C(e.target)){var t=y(e.target);if(t)if(h){var r=d.view.wt.wtTable.getCoords(t).col;r>=0&&(l=r,n(e.target,l-a))}else o.call(d,t)}}),m.addEventListener(d.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualColumnMover")&&(c=t.helper.pageX(e),r.call(d),h=d,a=u,l=u)}),m.addEventListener(e,"mousemove",function(e){h&&i(t.helper.pageX(e)-c)}),m.addEventListener(e,"mouseup",function(){h&&(s(),h=!1,S(d.manualColumnPositions,d.countCols()),d.manualColumnPositions.splice(l,0,d.manualColumnPositions.splice(a,1)[0]),d.forceFullRender=!0,d.view.render(),w.call(d),t.hooks.run(d,"afterColumnMove",a,l),o.call(d,f))}),d.addHook("afterDestroy",R)},R=function(){m.clear()},S=function(e,t){if(e.length<t)for(var o=e.length;t>o;o++)e[o]=o};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualColumnMove;if(o){var n=this.getSettings().manualColumnMove,r=v.call(t);this.manualColumnPositions="undefined"!=typeof r?r:Array.isArray(n)?n:[],"afterInit"==e&&(b.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else R.call(this),this.manualColumnPositions=[]},this.modifyCol=function(e){return this.getSettings().manualColumnMove?("undefined"==typeof this.manualColumnPositions[e]&&S(this.manualColumnPositions,e+1),this.manualColumnPositions[e]):e},this.afterRemoveCol=function(e,t){if(this.getSettings().manualColumnMove){var o,n=this.manualColumnPositions;o=n.splice(e,t),n=n.map(function(e){var t,n=e;for(t=0;t<o.length;t++)e>o[t]&&n--;return n}),this.manualColumnPositions=n}},this.afterCreateCol=function(e,t){if(this.getSettings().manualColumnMove){var o=this.manualColumnPositions;if(o.length){for(var n=[],r=0;t>r;r++)n.push(e+r);e>=o.length?o.concat(n):(o=o.map(function(o){return o>=e?o+t:o}),o.splice.apply(o,[e,0].concat(n))),this.manualColumnPositions=o}}}}var n=new o;t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyCol",n.modifyCol),t.hooks.add("afterRemoveCol",n.afterRemoveCol),t.hooks.add("afterCreateCol",n.afterCreateCol),t.hooks.register("afterColumnMove")}(t),function(t){function o(){function o(e){h=this,a=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){l=t;var o=a.getBoundingClientRect();p=o.left-6,f=parseInt(o.width,10),g.style.top=o.top+"px",g.style.left=p+f+"px",h.rootElement.appendChild(g)}}function n(){g.style.left=p+c+"px"}function r(){var e=this;t.Dom.addClass(g,"active"),t.Dom.addClass(m,"active"),m.style.top=g.style.top,m.style.left=g.style.left,m.style.height=e.view.maximumVisibleElementHeight(0)+"px",e.rootElement.appendChild(m)}function i(){m.style.left=g.style.left}function s(){t.Dom.removeClass(g,"active"),t.Dom.removeClass(m,"active")}var a,l,c,h,u,d,f,p,g=document.createElement("DIV"),m=document.createElement("DIV"),w=t.eventManager(this);g.className="manualColumnResizer",m.className="manualColumnResizerGuide";var v=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualColumnWidths",e.manualColumnWidths)},C=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","manualColumnWidths",o),o.value},y=function(e){return"BODY"!=e.tagName?"THEAD"==e.parentNode.tagName?!0:(e=e.parentNode,y(e)):!1},b=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:b(e.parentNode):null},R=function(){var h,p=this,g=0,m=null;w.addEventListener(p.rootElement,"mouseover",function(e){if(y(e.target)){var t=b(e.target);t&&(h||o.call(p,t))}}),w.addEventListener(p.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualColumnResizer")&&(r.call(p),h=p,null==m&&(m=setTimeout(function(){g>=2&&(u=p.determineColumnWidth.call(p,l),E(l,u),p.forceFullRender=!0,p.view.render(),t.hooks.run(p,"afterColumnResize",l,u)),g=0,m=null},500),p._registerTimeout(m)),g++,d=t.helper.pageX(e),u=f)}),w.addEventListener(e,"mousemove",function(e){h&&(c=f+(t.helper.pageX(e)-d),u=E(l,c),n(),i())}),w.addEventListener(e,"mouseup",function(){h&&(s(),h=!1,u!=f&&(p.forceFullRender=!0,p.view.render(),v.call(p),t.hooks.run(p,"afterColumnResize",l,u)),o.call(p,a))}),p.addHook("afterDestroy",S)},S=function(){w.clear()};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualColumnResize;if(o){var n=this.getSettings().manualColumnResize,r=C.call(t);this.manualColumnWidths="undefined"!=typeof r?r:Array.isArray(n)?n:[],"afterInit"==e&&(R.call(this),this.manualColumnWidths.length>0&&(this.forceFullRender=!0,this.render()))}else S.call(this),this.manualColumnWidths=[]};var E=function(e,o){return o=Math.max(o,20),e=t.hooks.execute(h,"modifyCol",e),h.manualColumnWidths[e]=o,o};this.modifyColWidth=function(e,t){return t=this.runHooksAndReturn("modifyCol",t),this.getSettings().manualColumnResize&&this.manualColumnWidths[t]?this.manualColumnWidths[t]:e}}var n=new o;t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyColWidth",n.modifyColWidth),t.hooks.register("afterColumnResize")}(t),function(t){function o(){function o(e){h=this,a=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){l=t;var o=a.getBoundingClientRect();p=o.top-6,f=parseInt(o.height,10),g.style.left=o.left+"px",g.style.top=p+f+"px",h.rootElement.appendChild(g)}}function n(){g.style.top=p+c+"px"}function r(){var e=this;t.Dom.addClass(g,"active"),t.Dom.addClass(m,"active"),m.style.top=g.style.top,m.style.left=g.style.left,m.style.width=e.view.maximumVisibleElementWidth(0)+"px",e.rootElement.appendChild(m)}function i(){m.style.top=g.style.top}function s(){t.Dom.removeClass(g,"active"),t.Dom.removeClass(m,"active")}var a,l,c,h,u,d,f,p,g=document.createElement("DIV"),m=document.createElement("DIV"),w=t.eventManager(this);g.className="manualRowResizer",m.className="manualRowResizerGuide";var v=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualRowHeights",e.manualRowHeights)},C=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","manualRowHeights",o),o.value},y=function(e){return"BODY"!=e.tagName?"TBODY"==e.parentNode.tagName?!0:(e=e.parentNode,y(e)):!1},b=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:b(e.parentNode):null},R=function(){var h,p=this,g=0,m=null;w.addEventListener(p.rootElement,"mouseover",function(e){if(y(e.target)){var t=b(e.target);t&&(h||o.call(p,t))}}),w.addEventListener(p.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualRowResizer")&&(r.call(p),h=p,null==m&&(m=setTimeout(function(){g>=2&&(E(l,null),p.forceFullRender=!0,p.view.render(),t.hooks.run(p,"afterRowResize",l,u)),g=0,m=null},500),p._registerTimeout(m)),g++,d=t.helper.pageY(e),u=f)}),w.addEventListener(e,"mousemove",function(e){h&&(c=f+(t.helper.pageY(e)-d),u=E(l,c),n(),i())}),w.addEventListener(e,"mouseup",function(){h&&(s(),h=!1,u!=f&&(p.forceFullRender=!0,p.view.render(),v.call(p),t.hooks.run(p,"afterRowResize",l,u)),o.call(p,a))}),p.addHook("afterDestroy",S)},S=function(){w.clear()};this.beforeInit=function(){this.manualRowHeights=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualRowResize;if(o){var n=this.getSettings().manualRowResize,r=C.call(t);this.manualRowHeights="undefined"!=typeof r?r:Array.isArray(n)?n:[],"afterInit"===e?(R.call(this),this.manualRowHeights.length>0&&(this.forceFullRender=!0,this.render())):(this.forceFullRender=!0,this.render())}else S.call(this),this.manualRowHeights=[]};var E=function(e,o){return e=t.hooks.execute(h,"modifyRow",e),h.manualRowHeights[e]=o,o};this.modifyRowHeight=function(e,t){return this.getSettings().manualRowResize&&(t=this.runHooksAndReturn("modifyRow",t),void 0!==this.manualRowHeights[t])?this.manualRowHeights[t]:e}}var n=new o;t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyRowHeight",n.modifyRowHeight),t.hooks.register("afterRowResize")}(t),function(){function e(){var e=this,t=e.getSettings().observeChanges;t?(e.observer&&r.call(e),o.call(e),s.call(e)):t||r.call(e)}function o(){var e=this;e.observeChangesActive=!0,e.pauseObservingChanges=function(){e.observeChangesActive=!1},e.resumeObservingChanges=function(){e.observeChangesActive=!0
},e.observedData=e.getData(),e.observer=M.observe(e.observedData,function(t){e.observeChangesActive&&(n.call(e,t),e.render()),e.runHooks("afterChangesObserved")})}function n(e){function t(e){var t;return t=n(e),t=o(t)}function o(e){var t=[];return e.filter(function(e){var o=r(e.path);if(-1!=["add","remove"].indexOf(e.op)&&!isNaN(o.col)){if(-1!=t.indexOf(o.col))return!1;t.push(o.col)}return!0})}function n(e){return e.filter(function(e){return!/[/]length/gi.test(e.path)})}function r(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}for(var i=this,s=t(e),a=0,l=s.length;l>a;a++){var c=s[a],h=r(c.path);switch(c.op){case"add":isNaN(h.col)?i.runHooks("afterCreateRow",h.row):i.runHooks("afterCreateCol",h.col);break;case"remove":isNaN(h.col)?i.runHooks("afterRemoveRow",h.row,1):i.runHooks("afterRemoveCol",h.col,1);break;case"replace":i.runHooks("afterChange",[h.row,h.col,null,c.value],"external")}}}function r(){var e=this;e.observer&&(i.call(e),a.call(e))}function i(){var e=this;M.unobserve(e.observedData,e.observer),delete e.observeChangesActive,delete e.pauseObservingChanges,delete e.resumeObservingChanges}function s(){var e=this;e.addHook("afterDestroy",r),e.addHook("afterCreateRow",l),e.addHook("afterRemoveRow",l),e.addHook("afterCreateCol",l),e.addHook("afterRemoveCol",l),e.addHook("afterChange",function(e,t){"loadData"!=t&&l.call(this)})}function a(){var e=this;e.removeHook("afterDestroy",r),e.removeHook("afterCreateRow",l),e.removeHook("afterRemoveRow",l),e.removeHook("afterCreateCol",l),e.removeHook("afterRemoveCol",l),e.removeHook("afterChange",l)}function l(){var e=this;e.pauseObservingChanges(),e.addHookOnce("afterChangesObserved",function(){e.resumeObservingChanges()})}t.hooks.add("afterLoadData",e),t.hooks.add("afterUpdateSettings",e),t.hooks.register("afterChangesObserved")}(),function(e){function o(){function o(){var e=this;for(var t in i)i.hasOwnProperty(t)&&e.addHook(t,i[t])}function n(){var e=this;for(var t in i)i.hasOwnProperty(t)&&e.removeHook(t,i[t])}var r=this;this.init=function(){var t=this,i=t.getSettings().persistentState;return r.enabled=!!i,r.enabled?(t.storage||(t.storage=new e(t.rootElement.id)),t.resetState=r.resetValue,void o.call(t)):void n.call(t)},this.saveValue=function(e,t){var o=this;o.storage.saveValue(e,t)},this.loadValue=function(e,t){var o=this;t.value=o.storage.loadValue(e)},this.resetValue=function(e){var t=this;"undefined"!=typeof e?t.storage.reset(e):t.storage.resetAll()};var i={persistentStateSave:r.saveValue,persistentStateLoad:r.loadValue,persistentStateReset:r.resetValue};for(var s in i)i.hasOwnProperty(s)&&t.hooks.register(s)}var n=new o;t.hooks.add("beforeInit",n.init),t.hooks.add("afterUpdateSettings",n.init)}(i),function(e){e.UndoRedo=function(t){var o=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,t.addHook("afterChange",function(t){if(t){var n=new e.UndoRedo.ChangeAction(t);o.done(n)}}),t.addHook("afterCreateRow",function(t,n,r){if(!r){var i=new e.UndoRedo.CreateRowAction(t,n);o.done(i)}}),t.addHook("beforeRemoveRow",function(t,n){var r=o.instance.getData();t=(r.length+t)%r.length;var i=r.slice(t,t+n),s=new e.UndoRedo.RemoveRowAction(t,i);o.done(s)}),t.addHook("afterCreateCol",function(t,n,r){if(!r){var i=new e.UndoRedo.CreateColumnAction(t,n);o.done(i)}}),t.addHook("beforeRemoveCol",function(n,r){var i=o.instance.getData();n=(o.instance.countCols()+n)%o.instance.countCols();for(var s=[],a=0,l=i.length;l>a;a++)s[a]=i[a].slice(n,n+r);var c;Array.isArray(t.getSettings().colHeaders)&&(c=t.getSettings().colHeaders.slice(n,n+s.length));var h=new e.UndoRedo.RemoveColumnAction(n,s,c);o.done(h)})},e.UndoRedo.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},e.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();this.ignoreNewActions=!0;var t=this;e.undo(this.instance,function(){t.ignoreNewActions=!1,t.undoneActions.push(e)})}},e.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();this.ignoreNewActions=!0;var t=this;e.redo(this.instance,function(){t.ignoreNewActions=!1,t.doneActions.push(e)})}},e.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},e.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},e.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},e.UndoRedo.Action=function(){},e.UndoRedo.Action.prototype.undo=function(){},e.UndoRedo.Action.prototype.redo=function(){},e.UndoRedo.ChangeAction=function(e){this.changes=e},e.helper.inherit(e.UndoRedo.ChangeAction,e.UndoRedo.Action),e.UndoRedo.ChangeAction.prototype.undo=function(t,o){for(var n=e.helper.deepClone(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0),s=0,a=n.length;a>s;s++)n[s].splice(3,1);t.addHookOnce("afterChange",o),t.setDataAtRowProp(n,null,null,"undo");for(var s=0,a=n.length;a>s;s++)t.getSettings().minSpareRows&&n[s][0]+1+t.getSettings().minSpareRows===t.countRows()&&r==t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(n[s][0]+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&n[s][1]+1+t.getSettings().minSpareCols===t.countCols()&&i==t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(n[s][1]+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())},e.UndoRedo.ChangeAction.prototype.redo=function(t,o){for(var n=e.helper.deepClone(this.changes),r=0,i=n.length;i>r;r++)n[r].splice(2,1);t.addHookOnce("afterChange",o),t.setDataAtRowProp(n,null,null,"redo")},e.UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t},e.helper.inherit(e.UndoRedo.CreateRowAction,e.UndoRedo.Action),e.UndoRedo.CreateRowAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount)},e.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index+1,this.amount)},e.UndoRedo.RemoveRowAction=function(e,t){this.index=e,this.data=t},e.helper.inherit(e.UndoRedo.RemoveRowAction,e.UndoRedo.Action),e.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var o=[this.index,0];Array.prototype.push.apply(o,this.data),Array.prototype.splice.apply(e.getData(),o),e.addHookOnce("afterRender",t),e.render()},e.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length)},e.UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t},e.helper.inherit(e.UndoRedo.CreateColumnAction,e.UndoRedo.Action),e.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)},e.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index+1,this.amount)},e.UndoRedo.RemoveColumnAction=function(e,t,o){this.index=e,this.data=t,this.amount=this.data[0].length,this.headers=o},e.helper.inherit(e.UndoRedo.RemoveColumnAction,e.UndoRedo.Action),e.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){for(var o,n,r=0,i=e.getData().length;i>r;r++)o=e.getSourceDataAtRow(r),n=[this.index,0],Array.prototype.push.apply(n,this.data[r]),Array.prototype.splice.apply(o,n);"undefined"!=typeof this.headers&&(n=[this.index,0],Array.prototype.push.apply(n,this.headers),Array.prototype.splice.apply(e.getSettings().colHeaders,n)),e.addHookOnce("afterRender",t),e.render()},e.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)}}(t),function(e){function t(){var t=this,s="undefined"==typeof t.getSettings().undo||t.getSettings().undo;s?t.undoRedo||(t.undoRedo=new e.UndoRedo(t),r(t),t.addHook("beforeKeyDown",o),t.addHook("afterChange",n)):t.undoRedo&&(delete t.undoRedo,i(t),t.removeHook("beforeKeyDown",o),t.removeHook("afterChange",n))}function o(e){var t=this,o=(e.ctrlKey||e.metaKey)&&!e.altKey;o&&(89===e.keyCode||e.shiftKey&&90===e.keyCode?(t.undoRedo.redo(),e.stopImmediatePropagation()):90===e.keyCode&&(t.undoRedo.undo(),e.stopImmediatePropagation()))}function n(e,t){var o=this;return"loadData"==t?o.undoRedo.clear():void 0}function r(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function i(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(t),s.prototype.setBoundaries=function(e){this.boundaries=e},s.prototype.setCallback=function(e){this.callback=e},s.prototype.check=function(e,t){var o=0,n=0;t<this.boundaries.top?n=t-this.boundaries.top:t>this.boundaries.bottom&&(n=t-this.boundaries.bottom),e<this.boundaries.left?o=e-this.boundaries.left:e>this.boundaries.right&&(o=e-this.boundaries.right),this.callback(o,n)};var _,G;if("undefined"!=typeof t){var z=function(t){t.dragToScrollListening=!1;var o=t.view.wt.wtScrollbars.vertical.scrollHandler;_=new s,o!==e&&(_.setBoundaries(o.getBoundingClientRect()),_.setCallback(function(e,t){0>e?o.scrollLeft-=50:e>0&&(o.scrollLeft+=50),0>t?o.scrollTop-=20:t>0&&(o.scrollTop+=20)}),t.dragToScrollListening=!0)};t.hooks.add("afterInit",function(){var e=this,o=t.eventManager(this);o.addEventListener(document,"mouseup",function(){e.dragToScrollListening=!1}),o.addEventListener(document,"mousemove",function(){e.dragToScrollListening&&_.check(event.clientX,event.clientY)})}),t.hooks.add("afterDestroy",function(){var e=t.eventManager(this);e.clear()}),t.hooks.add("afterOnCellMouseDown",function(){z(this)}),t.hooks.add("afterOnCellCornerMouseDown",function(){z(this)}),t.plugins.DragToScroll=s}if(function(e,t,o){function n(n){function r(){n.isListening()&&n.selection.empty()}function i(e){if(n.isListening()&&n.selection.isSelected()){var t=e.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),r=o.parse(t),i=n.getSelected(),s=new u(i[0],i[1]),a=new u(i[2],i[3]),l=new d(s,s,a),c=l.getTopLeftCorner(),h=l.getBottomRightCorner(),f=c,p=new u(Math.max(h.row,r.length-1+c.row),Math.max(h.col,r[0].length-1+c.col));n.addHookOnce("afterChange",function(e){e&&e.length&&this.selectCell(f.row,f.col,p.row,p.col)}),n.populateFromArray(f.row,f.col,r,p.row,p.col,"paste",n.getSettings().pasteMode)}}function s(t){if(n.getSelected()){if(e.helper.isCtrlKey(t.keyCode))return a.setCopyableText(),void t.stopImmediatePropagation();var o=(t.ctrlKey||t.metaKey)&&!t.altKey;t.keyCode==e.helper.keyCode.A&&o&&n._registerTimeout(setTimeout(e.helper.proxy(a.setCopyableText,a),0))}}this.copyPasteInstance=t.getInstance(),this.copyPasteInstance.onCut(r),this.copyPasteInstance.onPaste(i);var a=this;n.addHook("beforeKeyDown",s),this.destroy=function(){this.copyPasteInstance.removeCallback(r),this.copyPasteInstance.removeCallback(i),this.copyPasteInstance.destroy(),n.removeHook("beforeKeyDown",s)},n.addHook("afterDestroy",e.helper.proxy(this.destroy,this)),this.triggerPaste=e.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=e.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var t=n.getSettings(),o=t.copyRowsLimit,r=t.copyColsLimit,i=n.getSelectedRange(),s=i.getTopLeftCorner(),a=i.getBottomRightCorner(),l=s.row,c=s.col,h=a.row,u=a.col,d=Math.min(h,l+o-1),f=Math.min(u,c+r-1);n.copyPaste.copyPasteInstance.copyable(n.getCopyableData(l,c,d,f)),(h!==d||u!==f)&&e.hooks.run(n,"afterCopyLimit",h-l+1,u-c+1,o,r)}}function r(){var e=this,t=e.getSettings().copyPaste!==!1;t&&!e.copyPaste?e.copyPaste=new n(e):!t&&e.copyPaste&&(e.copyPaste.destroy(),delete e.copyPaste)}e.hooks.add("afterInit",r),e.hooks.add("afterUpdateSettings",r),e.hooks.register("afterCopyLimit")}(t,I,SheetClip),function(e){function t(){var t=this,o=!!t.getSettings().search;o?t.search=new e.Search(t):delete t.search}e.Search=function(t){this.query=function(o,n,r){var i=t.countRows(),s=t.countCols(),a=[];n||(n=e.Search.global.getDefaultCallback()),r||(r=e.Search.global.getDefaultQueryMethod());for(var l=0;i>l;l++)for(var c=0;s>c;c++){var h=t.getDataAtCell(l,c),u=t.getCellMeta(l,c),d=u.search.callback||n,f=u.search.queryMethod||r,p=f(o,h);if(p){var g={row:l,col:c,data:h};a.push(g)}d&&d(t,l,c,h,p)}return a}},e.Search.DEFAULT_CALLBACK=function(e,t,o,n,r){e.getCellMeta(t,o).isSearchResult=r},e.Search.DEFAULT_QUERY_METHOD=function(e,t){return"undefined"!=typeof e&&null!=e&&e.toLowerCase&&0!=e.length?"undefined"==typeof t||null==t?!1:-1!=t.toString().toLowerCase().indexOf(e.toLowerCase()):!1},e.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",e.Search.global=function(){var t=e.Search.DEFAULT_CALLBACK,o=e.Search.DEFAULT_QUERY_METHOD,n=e.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return t},setDefaultCallback:function(e){t=e},getDefaultQueryMethod:function(){return o},setDefaultQueryMethod:function(e){o=e},getDefaultSearchResultClass:function(){return n},setDefaultSearchResultClass:function(e){n=e}}}(),e.SearchCellDecorator=function(t,o,n,r,i,s,a){var l="object"==typeof a.search&&a.search.searchResultClass||e.Search.global.getDefaultSearchResultClass();a.isSearchResult?e.Dom.addClass(o,l):e.Dom.removeClass(o,l)};var o=e.renderers.cellDecorator;e.renderers.cellDecorator=function(){o.apply(this,arguments),e.SearchCellDecorator.apply(this,arguments)},e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(t),l.prototype.canMergeRange=function(e){return!e.isSingle()},l.prototype.mergeRange=function(e){if(this.canMergeRange(e)){var t=e.getTopLeftCorner(),o=e.getBottomRightCorner(),n={};n.row=t.row,n.col=t.col,n.rowspan=o.row-t.row+1,n.colspan=o.col-t.col+1,this.mergedCellInfoCollection.setInfo(n)}},l.prototype.mergeOrUnmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col);t?this.unmergeSelection(e.from):this.mergeSelection(e)},l.prototype.mergeSelection=function(e){this.mergeRange(e)},l.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)},l.prototype.applySpanProperties=function(e,t,o){var n=this.mergedCellInfoCollection.getInfo(t,o);n?n.row===t&&n.col===o?(e.setAttribute("rowspan",n.rowspan),e.setAttribute("colspan",n.colspan)):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"))},l.prototype.modifyTransform=function(e,t,o){var n=function(e,t){return t.row>=e.row&&t.row<=e.row+e.rowspan-1?!0:!1},r=function(e,t){return t.col>=e.col&&t.col<=e.col+e.colspan-1?!0:!1},i=function(e){return new u(t.to.row+e.row,t.to.col+e.col)},s={row:o.row,col:o.col};if("modifyTransformStart"==e){this.lastDesiredCoords||(this.lastDesiredCoords=new u(null,null));for(var a,l=new u(t.highlight.row,t.highlight.col),c=this.mergedCellInfoCollection.getInfo(l.row,l.col),h=0,f=this.mergedCellInfoCollection.length;f>h;h++){var p=this.mergedCellInfoCollection[h];if(p=new u(p.row+p.rowspan-1,p.col+p.colspan-1),t.includes(p)){a=!0;break}}if(c){var g=new u(c.row,c.col),m=new u(c.row+c.rowspan-1,c.col+c.colspan-1),w=new d(g,g,m);w.includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new u(null,null)),s.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-l.row:s.row,s.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-l.col:s.col,o.row>0?s.row=c.row+c.rowspan-1-l.row+o.row:o.row<0&&(s.row=l.row-c.row+o.row),o.col>0?s.col=c.col+c.colspan-1-l.col+o.col:o.col<0&&(s.col=l.col-c.col+o.col)}var v=new u(t.highlight.row+s.row,t.highlight.col+s.col),C=this.mergedCellInfoCollection.getInfo(v.row,v.col);C&&(this.lastDesiredCoords=v,s={row:C.row-l.row,col:C.col-l.col})}else if("modifyTransformEnd"==e)for(var h=0,f=this.mergedCellInfoCollection.length;f>h;h++){var y=this.mergedCellInfoCollection[h],g=new u(y.row,y.col),m=new u(y.row+y.rowspan-1,y.col+y.colspan-1),b=new d(g,g,m),R=t.getBordersSharedWith(b);if(b.isEqual(t))t.setDirection("NW-SE");else if(R.length>0){var S=t.highlight.isEqual(b.from);R.indexOf("top")>-1?t.to.isSouthEastOf(b.from)&&S?t.setDirection("NW-SE"):t.to.isSouthWestOf(b.from)&&S&&t.setDirection("NE-SW"):R.indexOf("bottom")>-1&&(t.to.isNorthEastOf(b.from)&&S?t.setDirection("SW-NE"):t.to.isNorthWestOf(b.from)&&S&&t.setDirection("SE-NW"))}var v=i(s),E=n(y,v),T=r(y,v);t.includesRange(b)&&(b.includes(v)||E||T)&&(E&&(s.row<0?s.row-=y.rowspan-1:s.row>0&&(s.row+=y.rowspan-1)),T&&(s.col<0?s.col-=y.colspan-1:s.col>0&&(s.col+=y.colspan-1)))}0!=s.row&&(o.row=s.row),0!=s.col&&(o.col=s.col)},"undefined"==typeof t)throw new Error("Handsontable is not defined");var j=function(){var e=this,t=e.getSettings().mergeCells;t&&(e.mergeCells||(e.mergeCells=new l(t)))},U=function(){var e=this;e.mergeCells&&(e.view.wt.wtTable.getCell=function(t){if(e.getSettings().mergeCells){var o=e.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);o&&(t=o)}return k.prototype.getCell.call(this,t)})},X=function(e){if(this.mergeCells){var t=(e.ctrlKey||e.metaKey)&&!e.altKey;t&&77===e.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),e.stopImmediatePropagation())}},K=function(e){this.getSettings().mergeCells&&(e.items.push(t.ContextMenu.SEPARATOR),e.items.push({key:"mergeCells",name:function(){var e=this.getSelected(),t=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);return t?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return!1}}))},V=function(e,t,o){this.mergeCells&&this.mergeCells.applySpanProperties(e,t,o)},Y=function(e){return function(t){var o=this.getSettings().mergeCells;if(o){var n=this.getSelectedRange();if(this.mergeCells.modifyTransform(e,n,t),"modifyTransformEnd"===e){var r=this.countRows(),i=this.countCols();n.from.row<0?n.from.row=0:n.from.row>0&&n.from.row>=r&&(n.from.row=n.from-1),n.from.col<0?n.from.col=0:n.from.col>0&&n.from.col>=i&&(n.from.col=i-1)}}}},q=function(e){this.lastDesiredCoords=null;var t=this.getSettings().mergeCells;if(t){var o=this.getSelectedRange();o.highlight=new u(o.highlight.row,o.highlight.col),o.to=e;var n=!1;do{n=!1;for(var r=0,i=this.mergeCells.mergedCellInfoCollection.length;i>r;r++){var s=this.mergeCells.mergedCellInfoCollection[r],a=new u(s.row,s.col),l=new u(s.row+s.rowspan-1,s.col+s.colspan-1),c=new d(a,a,l);o.expandByRange(c)&&(e.row=o.to.row,e.col=o.to.col,n=!0)}}while(n)}},Q=function(e,t){if(t&&"area"==t){var o=this.getSettings().mergeCells;if(o)for(var n=this.getSelectedRange(),r=new d(n.from,n.from,n.from),i=new d(n.to,n.to,n.to),s=0,a=this.mergeCells.mergedCellInfoCollection.length;a>s;s++){var l=this.mergeCells.mergedCellInfoCollection[s],c=new u(l.row,l.col),h=new u(l.row+l.rowspan-1,l.col+l.colspan-1),f=new d(c,c,h);r.expandByRange(f)&&(e[0]=r.from.row,e[1]=r.from.col),i.expandByRange(f)&&(e[2]=i.from.row,e[3]=i.from.col)}}},$=function(e,t,o){var n=this.getSettings().mergeCells;if(n){var r=this.mergeCells.mergedCellInfoCollection.getInfo(e,t);!r||r.row==e&&r.col==t||(o.copyable=!1)}},J=function(e){var t=this.getSettings().mergeCells;if(t)for(var o,n=this.countCols(),r=0;n>r;r++){if(o=this.mergeCells.mergedCellInfoCollection.getInfo(e.startRow,r),o&&o.row<e.startRow)return e.startRow=o.row,J.call(this,e);if(o=this.mergeCells.mergedCellInfoCollection.getInfo(e.endRow,r)){var i=o.row+o.rowspan-1;if(i>e.endRow)return e.endRow=i,J.call(this,e)}}},Z=function(e){var t=this.getSettings().mergeCells;if(t)for(var o,n=this.countRows(),r=0;n>r;r++){if(o=this.mergeCells.mergedCellInfoCollection.getInfo(r,e.startColumn),o&&o.col<e.startColumn)return e.startColumn=o.col,Z.call(this,e);if(o=this.mergeCells.mergedCellInfoCollection.getInfo(r,e.endColumn)){var i=o.col+o.colspan-1;if(i>e.endColumn)return e.endColumn=i,Z.call(this,e)}}},et=function(e){if(e&&this.mergeCells){var t=this.mergeCells.mergedCellInfoCollection,o=this.getSelectedRange();for(var n in t)if(o.highlight.row==t[n].row&&o.highlight.col==t[n].col&&o.to.row==t[n].row+t[n].rowspan-1&&o.to.col==t[n].col+t[n].colspan-1)return!1}return e};t.hooks.add("beforeInit",j),t.hooks.add("afterInit",U),t.hooks.add("beforeKeyDown",X),t.hooks.add("modifyTransformStart",Y("modifyTransformStart")),t.hooks.add("modifyTransformEnd",Y("modifyTransformEnd")),t.hooks.add("beforeSetRangeEnd",q),t.hooks.add("beforeDrawBorders",Q),t.hooks.add("afterIsMultipleSelection",et),t.hooks.add("afterRenderer",V),t.hooks.add("afterContextMenuDefaultOptions",K),t.hooks.add("afterGetCellMeta",$),t.hooks.add("afterViewportRowCalculatorOverride",J),t.hooks.add("afterViewportColumnCalculatorOverride",Z),t.MergeCells=l,function(){function e(){}var o,n=function(e){return"boolean"==typeof e&&1==e?!0:"object"==typeof e&&e.length>0?!0:!1},r=function(){n(this.getSettings().customBorders)&&(this.customBorders||(o=this,this.customBorders=new e))},i=function(e){for(var t=0;t<o.view.wt.selections.length;t++)if(o.view.wt.selections[t].settings.className==e)return t;return-1},s=function(e){var t={row:e.row,col:e.col},n=new T(e,new d(t,t,t)),r=i(e.className);r>=0?o.view.wt.selections[r]=n:o.view.wt.selections.push(n)},a=function(e,t,o){var n=p(e,t);n=g(n,o),this.setCellMeta(e,t,"borders",n),s(n)},l=function(e){for(var t=e.range,o=t.from.row;o<=t.to.row;o++)for(var n=t.from.col;n<=t.to.col;n++){var r=p(o,n),i=0;o==t.from.row&&(i++,e.hasOwnProperty("top")&&(r.top=e.top)),o==t.to.row&&(i++,e.hasOwnProperty("bottom")&&(r.bottom=e.bottom)),n==t.from.col&&(i++,e.hasOwnProperty("left")&&(r.left=e.left)),n==t.to.col&&(i++,e.hasOwnProperty("right")&&(r.right=e.right)),i>0&&(this.setCellMeta(o,n,"borders",r),s(r))}},c=function(e,t){return"border_row"+e+"col"+t},h=function(){return{width:1,color:"#000"}},u=function(){return{hide:!0}},f=function(){return{width:1,color:"#000",cornerVisible:!1}},p=function(e,t){return{className:c(e,t),border:f(),row:e,col:t,top:u(),right:u(),bottom:u(),left:u()}},g=function(e,t){return t.hasOwnProperty("border")&&(e.border=t.border),t.hasOwnProperty("top")&&(e.top=t.top),t.hasOwnProperty("right")&&(e.right=t.right),t.hasOwnProperty("bottom")&&(e.bottom=t.bottom),t.hasOwnProperty("left")&&(e.left=t.left),e},m=function(e){for(var t=document.querySelectorAll("."+e),o=0;o<t.length;o++)if(t[o]&&"TD"!=t[o].nodeName){var n=t[o].parentNode;n.parentNode&&n.parentNode.removeChild(n)}},w=function(e,t){var o=c(e,t);m(o),this.removeCellMeta(e,t,"borders")},v=function(e,t,o,n){var r=this.getCellMeta(e,t).borders;r&&void 0!=r.border||(r=p(e,t)),r[o]=n?u():h(),this.setCellMeta(e,t,"borders",r);var i=c(e,t);m(i),s(r),this.render()},C=function(e,t,o){if(e.from.row==e.to.row&&e.from.col==e.to.col)"noBorders"==t?w.call(this,e.from.row,e.from.col):v.call(this,e.from.row,e.from.col,t,o);else switch(t){case"noBorders":for(var n=e.from.col;n<=e.to.col;n++)for(var r=e.from.row;r<=e.to.row;r++)w.call(this,r,n);break;case"top":for(var i=e.from.col;i<=e.to.col;i++)v.call(this,e.from.row,i,t,o);break;case"right":for(var s=e.from.row;s<=e.to.row;s++)v.call(this,s,e.to.col,t);break;case"bottom":for(var a=e.from.col;a<=e.to.col;a++)v.call(this,e.to.row,a,t);break;case"left":for(var l=e.from.row;l<=e.to.row;l++)v.call(this,l,e.from.col,t)}},y=function(e,t){var o=!1;return e.getSelectedRange().forAll(function(n,r){var i=e.getCellMeta(n,r).borders;if(i){if(!t)return o=!0,!1;if(!i[t].hasOwnProperty("hide"))return o=!0,!1}}),o},b=function(e){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+e},R=function(e){this.getSettings().customBorders&&(e.items.push(t.ContextMenu.SEPARATOR),e.items.push({key:"borders",name:"Borders",submenu:{items:{top:{name:function(){var e="Top",t=y(this,"top");return t&&(e=b(e)),e},callback:function(){var e=y(this,"top");C.call(this,this.getSelectedRange(),"top",e)},disabled:!1},right:{name:function(){var e="Right",t=y(this,"right");return t&&(e=b(e)),e},callback:function(){var e=y(this,"right");C.call(this,this.getSelectedRange(),"right",e)},disabled:!1},bottom:{name:function(){var e="Bottom",t=y(this,"bottom");return t&&(e=b(e)),e},callback:function(){var e=y(this,"bottom");C.call(this,this.getSelectedRange(),"bottom",e)},disabled:!1},left:{name:function(){var e="Left",t=y(this,"left");return t&&(e=b(e)),e},callback:function(){var e=y(this,"left");C.call(this,this.getSelectedRange(),"left",e)},disabled:!1},remove:{name:"Remove border(s)",callback:function(){C.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!y(this)}}}}}))};t.hooks.add("beforeInit",r),t.hooks.add("afterContextMenuDefaultOptions",R),t.hooks.add("afterInit",function(){var e=this.getSettings().customBorders;if(e){for(var t=0;t<e.length;t++)e[t].range?l.call(this,e[t]):a.call(this,e[t].row,e[t].col,e[t]);this.render(),this.view.wt.draw(!0)}}),t.CustomBorders=e}(),function(t){function o(){function o(e){G=this,d=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){u=t;var o=d.getBoundingClientRect();h=o.top,f.style.top=h+"px",f.style.left=o.left+"px",G.rootElement.appendChild(f)}}function n(e,t){var o=e.getBoundingClientRect(),n=6;f.style.top=t>0?o.top+o.height-n+"px":o.top+"px"}function r(){var e=this;t.Dom.addClass(f,"active"),t.Dom.addClass(p,"active");var o=d.getBoundingClientRect();p.style.width=e.view.maximumVisibleElementWidth(0)+"px",p.style.height=o.height+"px",p.style.top=h+"px",p.style.left=f.style.left,e.rootElement.appendChild(p)}function i(e){p.style.top=h+e+"px"}function s(){t.Dom.removeClass(f,"active"),t.Dom.removeClass(p,"active")}var a,l,c,h,u,d,f=document.createElement("DIV"),p=document.createElement("DIV"),g=t.eventManager(this);f.className="manualRowMover",p.className="manualRowMoverGuide";var m=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualRowPositions",e.manualRowPositions)},w=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","manualRowPositions",o),o.value},v=function(e){return"BODY"!=e.tagName?"TBODY"==e.parentNode.tagName?!0:(e=e.parentNode,v(e)):!1},C=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:C(e.parentNode):null},y=function(){var h,f=this;g.addEventListener(f.rootElement,"mouseover",function(e){if(v(e.target)){var t=C(e.target);t&&(h?(l=f.view.wt.wtTable.getCoords(t).row,n(t,l-a)):o.call(f,t))}}),g.addEventListener(f.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualRowMover")&&(c=t.helper.pageY(e),r.call(f),h=f,a=u,l=u)}),g.addEventListener(e,"mousemove",function(e){h&&i(t.helper.pageY(e)-c)}),g.addEventListener(e,"mouseup",function(){h&&(s(),h=!1,R(f.manualRowPositions,f.countRows()),f.manualRowPositions.splice(l,0,f.manualRowPositions.splice(a,1)[0]),f.forceFullRender=!0,f.view.render(),m.call(f),t.hooks.run(f,"afterRowMove",a,l),o.call(f,d))}),f.addHook("afterDestroy",b)},b=function(){g.clear()},R=function(e,t){if(e.length<t)for(var o=e.length;t>o;o++)e[o]=o};this.beforeInit=function(){this.manualRowPositions=[]},this.init=function(e){var t=this,o=!!t.getSettings().manualRowMove;if(o){var n=t.getSettings().manualRowMove,r=w.call(t);this.manualRowPositions="undefined"!=typeof r?r:Array.isArray(n)?n:[],"afterInit"===e&&(y.call(this),this.manualRowPositions.length>0&&(t.forceFullRender=!0,t.render()))}else b.call(this),t.manualRowPositions=[]},this.modifyRow=function(e){var t=this;return t.getSettings().manualRowMove?("undefined"==typeof t.manualRowPositions[e]&&R(this.manualRowPositions,e+1),t.manualRowPositions[e]):e}}var n=new o;t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyRow",n.modifyRow),t.hooks.register("afterRowMove")}(t),function(t){function o(o){this.instance=o,this.addingStarted=!1;var n,r,i=!1,s=this,a=t.eventManager(o),l=function(){return o.autofill?void(o.autofill.handle&&o.autofill.handle.isDragged&&(o.autofill.handle.isDragged>1&&o.autofill.apply(),o.autofill.handle.isDragged=0,i=!1)):!0};a.addEventListener(document,"mouseup",function(e){l(e)}),a.addEventListener(document,"mousemove",function(o){if(!s.instance.autofill)return 0;var n=t.Dom.offset(s.instance.table).top-(e.pageYOffset||document.documentElement.scrollTop)+t.Dom.outerHeight(s.instance.table),r=t.Dom.offset(s.instance.table).left-(e.pageXOffset||document.documentElement.scrollLeft)+t.Dom.outerWidth(s.instance.table);s.addingStarted===!1&&s.instance.autofill.handle.isDragged>0&&o.clientY>n&&o.clientX<=r?(this.mouseDragOutside=!0,s.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&setTimeout(function(){s.addingStarted=!1,s.instance.alter("insert_row")},200)}),n=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown,this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(e){o.autofill.handle.isDragged=1,i=!0,n(e)},r=this.instance.view.wt.wtSettings.settings.onCellMouseOver,this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(e,t,n,s){o.autofill&&i&&!o.view.isMouseDown()&&o.autofill.handle&&o.autofill.handle.isDragged&&(o.autofill.handle.isDragged++,o.autofill.showBorder(t),o.autofill.checkIfNewRowNeeded()),r(e,t,n,s)},this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){o.autofill.selectAdjacent()}}o.prototype.init=function(){this.handle={}},o.prototype.disable=function(){this.handle.disabled=!0},o.prototype.selectAdjacent=function(){var e,t,o,n,r;e=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),t=this.instance.getData();e:for(o=e[2]+1;o<this.instance.countRows();o++){for(r=e[1];r<=e[3];r++)if(t[o][r])break e;(t[o][e[1]-1]||t[o][e[3]+1])&&(n=o)}n&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new u(e[0],e[1])),this.instance.view.wt.selections.fill.add(new u(n,e[3])),this.apply())},o.prototype.apply=function(){var e,o,n,r,i;if(this.handle.isDragged=0,e=this.instance.view.wt.selections.fill.getCorners()){var s=function(e,t,o,n){var r,i,s,a=o.length,l=o?o[0].length:0,c=[],h=t.row-e.row,u=t.col-e.col,d=[];if(-1!==["down","up"].indexOf(n)){for(var f=0;u>=f;f++)r=parseInt(o[0][f],10),i=parseInt(o[a-1][f],10),s=("down"===n?i-r:r-i)/(a-1)||0,d.push(s);c.push(d)}if(-1!==["right","left"].indexOf(n))for(var p=0;h>=p;p++)r=parseInt(o[p][0],10),i=parseInt(o[p][l-1],10),s=("right"===n?i-r:r-i)/(l-1)||0,d=[],d.push(s),c.push(d);return c};this.instance.view.wt.selections.fill.clear(),o=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners();var a;if(e[0]===o[0]&&e[1]<o[1]?(a="left",n=new u(e[0],e[1]),r=new u(e[2],o[1]-1)):e[0]===o[0]&&e[3]>o[3]?(a="right",n=new u(e[0],o[3]+1),r=new u(e[2],e[3])):e[0]<o[0]&&e[1]===o[1]?(a="up",n=new u(e[0],e[1]),r=new u(o[0]-1,e[3])):e[2]>o[2]&&e[1]===o[1]&&(a="down",n=new u(o[2]+1,e[1]),r=new u(e[2],e[3])),n&&n.row>-1&&n.col>-1){var l={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to};i=this.instance.getData(l.from.row,l.from.col,l.to.row,l.to.col);var c=s(n,r,i,a);t.hooks.run(this.instance,"beforeAutofill",n,r,i),this.instance.populateFromArray(n.row,n.col,i,r.row,r.col,"autofill",null,a,c),this.instance.selection.setRangeStart(new u(e[0],e[1])),this.instance.selection.setRangeEnd(new u(e[2],e[3]))}else this.instance.selection.refreshBorders()}},o.prototype.showBorder=function(e){var t=this.instance.getSelectedRange().getTopLeftCorner(),o=this.instance.getSelectedRange().getBottomRightCorner();if("horizontal"!==this.instance.getSettings().fillHandle&&(o.row<e.row||t.row>e.row))e=new u(e.row,o.col);else{if("vertical"===this.instance.getSettings().fillHandle)return;e=new u(o.row,e.col)
}this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to),this.instance.view.wt.selections.fill.add(e),this.instance.view.render()},o.prototype.checkIfNewRowNeeded=function(){var e,t,o=this.instance.countRows(),n=this;this.instance.view.wt.selections.fill.cellRange&&this.addingStarted===!1&&(t=this.instance.getSelected(),e=this.instance.view.wt.selections.fill.getCorners(),t[2]<o-1&&e[2]===o-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){n.instance.alter("insert_row"),n.addingStarted=!1},200))))},t.hooks.add("afterInit",function(){var e=new o(this);"undefined"!=typeof this.getSettings().fillHandle&&(e.handle&&this.getSettings().fillHandle===!1?e.disable():e.handle||this.getSettings().fillHandle===!1||(this.autofill=e,this.autofill.init()))}),t.Autofill=o}(t);var tt=function(e){var o=[],n={rows:0,cols:0},r={rows:0,cols:0},i=[],s=[],a={groupIndicatorContainer:"htGroupIndicatorContainer",groupIndicator:function(e){return"ht"+e+"Group"},groupStart:"htGroupStart",collapseButton:"htCollapseButton",expandButton:"htExpandButton",collapseGroupId:function(e){return"htCollapse-"+e},collapseFromLevel:function(e,t){return"htCollapse"+e+"FromLevel-"+t},clickable:"clickable",levelTrigger:"htGroupLevelTrigger"},l=function(e,t){return function(o,n){return"undefined"==typeof t||"asc"===t?o[e]-n[e]:n[e]-o[e]}},c=function(e,t){for(var o=[];t>=e;)o.push(e++);return o},h=function(e,t,o){var n=[],r={row:null,col:null};if("cols"==e)for(;o>=t;)r={row:-1,col:t++},n.push(r);else for(;o>=t;)r={row:t++,col:-1},n.push(r);for(var i=d(n),s=0,a=0,l=0;l<i.length;l++)s+=i[l].filter(function(e){return e.rows}).length,a+=i[l].filter(function(e){return e.cols}).length;return{total:{rows:s,cols:a},groups:i}},d=function(e){for(var t=[],o=0;o<e.length;o++)t.push(f(e[o]));return t},f=function(e,t,n){for(var r=e.row,i=e.col,s=-1===r?0:r,a=-1===i?0:i,l=[],c=0;c<o.length;c++){var h=o[c],u=h.id,d=(h.level,h.rows||[]),f=h.cols||[];-1===l.indexOf(u)&&(-1!==d.indexOf(s)||-1!==f.indexOf(a))&&l.push(h)}-1===i?l=l.concat(w()):-1===r&&(l=l.concat(C())),t&&(l=l.filter(function(e){return e.level===t})),n&&("cols"===n?l=l.filter(function(e){return e.cols}):"rows"===n&&(l=l.filter(function(e){return e.rows})));var p=[];return l.filter(function(e){return-1===p.indexOf(e.id)?(p.push(e.id),e):void 0})},p=function(e){for(var t=0,n=o.length;n>t;t++)if(o[t].id==e)return o[t];return!1},g=function(e,t){for(var n=0,r=o.length;r>n;n++)if(o[n].level==t&&o[n].rows&&o[n].rows.indexOf(e)>-1)return o[n];return!1},m=function(e,t){for(var n=0,r=o.length;r>n;n++)if(o[n].level==t&&o[n].cols&&o[n].cols.indexOf(e)>-1)return o[n];return!1},w=function(){for(var e=[],t=0,n=o.length;n>t;t++)Array.isArray(o[t].cols)&&e.push(o[t]);return e},v=function(e){for(var t=[],n=0,r=o.length;r>n;n++)o[n].cols&&o[n].level===e&&t.push(o[n]);return t},C=function(){for(var e=[],t=0,n=o.length;n>t;t++)Array.isArray(o[t].rows)&&e.push(o[t]);return e},y=function(e){for(var t=[],n=0,r=o.length;r>n;n++)o[n].rows&&o[n].level===e&&t.push(o[n]);return t},b=function(e){var t=0;return e.length&&e.forEach(function(e){if(e=e.filter(function(e){return e.cols}),e.length){var o=e.sort(l("level","desc")),n=o[0].level;n>t&&(t=n)}}),t},R=function(e){var t=0;return e.length&&e.forEach(function(e){if(e=e.filter(function(e){return e.rows}),e.length){var o=e.sort(l("level","desc")),n=o[0].level;n>t&&(t=n)}}),t},S=function(e,t){var i=h("cols",e,t),s=b(i.groups);s===r.cols?r.cols++:s>r.cols&&(r.cols=s+1),n.cols||(n.cols=w().length),n.cols++,o.push({id:"c"+n.cols,level:s+1,cols:c(e,t),hidden:0})},E=function(e,t){var i=h("rows",e,t),s=R(i.groups);r.rows=Math.max(r.rows,s+1),n.rows||(n.rows=C().length),n.rows++,o.push({id:"r"+n.rows,level:s+1,rows:c(e,t),hidden:0})},T=function(e,t){for(var o,n=0,r=t.length;r>n;n++)if(t[n].hidden=e,o=t[n].level,i[o]||(i[o]=[]),s[o]||(s[o]=[]),t[n].rows)for(var a=0,l=t[n].rows.length;l>a;a++)i[o][t[n].rows[a]]=e>0?!0:void 0;else if(t[n].cols)for(var a=0,c=t[n].cols.length;c>a;a++)s[o][t[n].cols[a]]=e>0?!0:void 0},D=function(e,o,n,r){var i,s;switch(e){case"rows":i=g(o+1,n).id,s=t.Grouping.getGroupLevelsByRows();break;case"cols":i=m(o+1,n).id,s=t.Grouping.getGroupLevelsByCols()}return!!(s[o+1]&&s[o+1].indexOf(n)>-1&&r==i)},k=function(e,o,n,r){var i,s;switch(e){case"rows":i=g(o-1,n).id,s=t.Grouping.getGroupLevelsByRows();break;case"cols":i=m(o-1,n).id,s=t.Grouping.getGroupLevelsByCols()}return!!(s[o-1]&&s[o-1].indexOf(n)>-1&&r==i)},A=function(o,n,a,l){if(0===n)return!1;var c,h,u=k(o,n,a,l),d=D(o,n,a,l),f=!1;switch(o){case"rows":c=t.Grouping.getGroupLevelsByRows(),h=e.countRows();for(var p=0;p<=r.rows;p++)if(i[p]&&i[p][n+1]){f=!0;break}break;case"cols":c=t.Grouping.getGroupLevelsByCols(),h=e.countCols();for(var p=0;p<=r.cols;p++)if(s[p]&&s[p][n+1]){f=!0;break}}if(u){if(n==h-1)return!0;if(!d||d&&f)return!0;if(!c[n+1])return!0}return!1},H=function(t){var o;switch(t){case"rows":o=r.rows;for(var n=0;o>=n;n++)if(i[n]&&i[n][e.countRows()-1])return!0;break;case"cols":o=r.cols;for(var n=0;o>=n;n++)if(s[n]&&s[n][e.countCols()-1])return!0}return!1},x=function(o,n,a,l){var c,h,u,d=p(l),f=!1,g=function(e){for(var t=!1,o="rows"==e?i:s,a=0;a<=r[e];a++){for(u=n;d[e].indexOf(u)>-1;)t=!(!o[a]||!o[a][u]),u--;if(t)break}return t},m=k(o,n,a,l),w=D(o,n,a,l);switch(o){case"rows":c=t.Grouping.getGroupLevelsByRows(),h=e.countRows(),f=g(o);break;case"cols":c=t.Grouping.getGroupLevelsByCols(),h=e.countCols(),f=g(o)}if(n==h-1)return!1;if(0==n){if(w)return!0}else if(!m||m&&f){if(w)return!0}else if(!c[n-1]&&w)return!0;return!1},O=function(e,o,n,r,i){var s;switch(e){case"rows":s=g(o-1,n).id;break;case"cols":s=m(o-1,n).id}if(!s)return null;if(o>0&&k(e,o-1,n,s)&&s!=r){var l=document.createElement("DIV");return t.Dom.addClass(l,a.expandButton),l.id="htExpand-"+s,l.appendChild(document.createTextNode("+")),l.setAttribute("data-level",n),l.setAttribute("data-type",e),l.setAttribute("data-hidden","1"),i.appendChild(l),l}return null},P=function(e){for(var t=C(),o=w(),n=0,r=t.length;r>n;n++)if(t[n].rows.indexOf(e.row)>-1&&t[n].hidden)return!0;if(null===e.col)return!1;for(var n=0,i=o.length;i>n;n++)if(o[n].cols.indexOf(e.col)>-1&&o[n].hidden)return!0;return!1};return{getGroups:function(){return o},getLevels:function(){return r},instance:e,baseSpareRows:e.getSettings().minSpareRows,baseSpareCols:e.getSettings().minSpareCols,getRowGroups:C,getColGroups:w,init:function(){var o=e.getSettings().groups;o&&Array.isArray(o)&&t.Grouping.initGroups(o)},initGroups:function(e){o=[],e.forEach(function(e){var t=[],o=!1,n=!1;Array.isArray(e.rows)?(t=e.rows,o=!0):Array.isArray(e.cols)&&(t=e.cols,n=!0);var r=t[0],i=t[t.length-1];o?E(r,i):n&&S(r,i)})},resetGroups:function(){o=[],n={rows:0,cols:0},r={rows:0,cols:0};var e;for(var i in a)if("function"!=typeof a[i]){e=document.querySelectorAll("."+a[i]);for(var s=0,l=e.length;l>s;s++)t.Dom.removeClass(e[s],a[i])}for(var c=["htGroupColClosest","htGroupCol"],i=0,h=c.length;h>i;i++){e=document.querySelectorAll("."+c[i]);for(var s=0,l=e.length;l>s;s++)t.Dom.removeClass(e[s],c[i])}},updateGroups:function(){var e=this.getSettings().groups;t.Grouping.resetGroups(),t.Grouping.initGroups(e)},afterGetRowHeader:function(e,o){for(var n=!1,r=0,s=i.length;s>r;r++)i[r]&&i[r][e]===!0&&(n=!0);n?t.Dom.addClass(o.parentNode,"hidden"):!n&&t.Dom.hasClass(o.parentNode,"hidden")&&t.Dom.removeClass(o.parentNode,"hidden")},afterGetColHeader:function(o){var n=this.view.wt.wtSettings.getSetting("rowHeaders").length,r=e.rootElement.querySelectorAll("colgroup col:nth-child("+parseInt(o+n+1,10)+")");if(0!==r.length){for(var i=!1,a=0,l=s.length;l>a;a++)s[a]&&s[a][o]===!0&&(i=!0);if(i)for(var a=0,c=r.length;c>a;a++)t.Dom.addClass(r[a],"hidden");else if(!i&&t.Dom.hasClass(r[0],"hidden"))for(var a=0,c=r.length;c>a;a++)t.Dom.removeClass(r[a],"hidden")}},groupIndicatorsFactory:function(e,o){var i,s,l,c,h,u,d,f;switch(o){case"horizontal":i=t.Grouping.getGroupLevelsByCols(),s=function(e){return Array.prototype.indexOf.call(e.parentNode.parentNode.childNodes,e.parentNode)+1},l=function(e,t){return m(e,t).id},c="cols",h=function(e,t){return m(e-1,t)},u="columnHeaders",d=function(e){if(1===e.length){var o=e[0];e[0]=function(e,n,r){-1>e?w()(e,n,r):(t.Dom.removeClass(n,a.groupIndicatorContainer),o(e,n,r))}}return function(){return e}},f=!0;break;case"vertical":i=t.Grouping.getGroupLevelsByRows(),s=function(e){return t.Dom.index(e)+1},l=function(e,t){return g(e,t).id},c="rows",h=function(e,t){return g(e-1,t)},u="rowHeaders",d=function(e){return e}}var p=function(e){var o=document.createElement("div");return e.appendChild(o),{button:o,addClass:function(e){t.Dom.addClass(o,e)}}},w=function(){var e=o.charAt(0).toUpperCase()+o.slice(1);return function(o,n,r){r++;for(var s,u;s=n.lastChild;)n.removeChild(s);t.Dom.addClass(n,a.groupIndicatorContainer);var d=l(o,r);if(o>-1&&i[o]&&i[o].indexOf(r)>-1&&(u=p(n),u.addClass(a.groupIndicator(e)),x(c,o,r,d)&&u.addClass(a.groupStart),A(c,o,r,d)&&(u.button.appendChild(document.createTextNode("-")),u.addClass(a.collapseButton),u.button.id=a.collapseGroupId(d),u.button.setAttribute("data-level",r),u.button.setAttribute("data-type",c))),f){var g=t.Dom.index(n.parentNode);if(-1===o||-1>o&&g===t.Grouping.getLevels().cols+1||0==g&&0==t.Grouping.getLevels().cols)if(u=p(n),u.addClass(a.levelTrigger),-1===o)u.button.id=a.collapseFromLevel("Cols",r),u.button.appendChild(document.createTextNode(r));else if(-1>o&&g===t.Grouping.getLevels().cols+1||0==g&&0==t.Grouping.getLevels().cols){var m=t.Dom.index(n)+1;u.button.id=a.collapseFromLevel("Rows",m),u.button.appendChild(document.createTextNode(m))}}var w=O(c,o,r,d,n);if(o>0){var v=h(o-1,r);w&&v.hidden&&t.Dom.addClass(w,a.clickable)}ot()}};if(e=d(e),n[c]>0)for(var v=0;v<r[c]+1;v++)Array.isArray(e)||(e="function"==typeof e?e():new Array(e)),e.unshift(w())},getGroupLevelsByRows:function(){for(var e=C(),t=[],o=0,n=e.length;n>o;o++)if(e[o].rows)for(var r=0,i=e[o].rows.length;i>r;r++)t[e[o].rows[r]]||(t[e[o].rows[r]]=[]),t[e[o].rows[r]].push(e[o].level);return t},getGroupLevelsByCols:function(){for(var e=w(),t=[],o=0,n=e.length;n>o;o++)if(e[o].cols)for(var r=0,i=e[o].cols.length;i>r;r++)t[e[o].cols[r]]||(t[e[o].cols[r]]=[]),t[e[o].cols[r]].push(e[o].level);return t},toggleGroupVisibility:function(o){if(t.Dom.hasClass(o.target,a.expandButton)||t.Dom.hasClass(o.target,a.collapseButton)||t.Dom.hasClass(o.target,a.levelTrigger)){var n,i,s,l,c=o.target,h=c.id.split("-"),u=[],d=function(e){e&&(c=e),h=c.id.split("-"),n=h[1],i=parseInt(c.getAttribute("data-level"),10),s=c.getAttribute("data-type"),l=parseInt(c.getAttribute("data-hidden")),l=isNaN(l)?1:l?0:1,c.setAttribute("data-hidden",l.toString()),u.push(p(n))};if(c.className.indexOf(a.levelTrigger)>-1){for(var f,g=[],m=[],w=c.id.indexOf("Rows")>-1?"rows":"cols",C=1,b=r[w];b>=C;C++)if(f="rows"==w?y(C):v(C),C>=parseInt(h[1],10))for(var R=0,S=f.length;S>R;R++)m.push(f[R]);else for(var R=0,S=f.length;S>R;R++)g.push(f[R]);T(!0,m),T(!1,g)}else d(),T(l,u);s=s||w;var E=H(s),D=s.charAt(0).toUpperCase()+s.slice(1),k=t.Grouping["baseSpare"+D];E?0==k&&(e.alter("insert_"+s.slice(0,-1),e["count"+D]()),t.Grouping["dummy"+s.slice(0,-1)]=!0):0==k&&t.Grouping["dummy"+s.slice(0,-1)]&&(e.alter("remove_"+s.slice(0,-1),e["count"+D]()-1),t.Grouping["dummy"+s.slice(0,-1)]=!1),e.render(),o.stopImmediatePropagation()}},modifySelectionFactory:function(e){var t,o=this.instance,n=new u(0,0),r=function(e,t){var o=0;switch(e){case"down":for(;P(t);)o++,t.row+=1;break;case"up":for(;P(t);)o--,t.row-=1;break;case"right":for(;P(t);)o++,t.col+=1;break;case"left":for(;P(t);)o--,t.col-=1}return o},i=function(e,t){e.row>0?P(t)&&(e.row+=r("down",t)):e.row<0&&P(t)&&(e.row+=r("up",t)),e.col>0?P(t)&&(e.col+=r("right",t)):e.col<0&&P(t)&&(e.col+=r("left",t))};switch(e){case"start":return function(e){t=o.getSelected(),n.row=t[0]+e.row,n.col=t[1]+e.col,i(e,n)};case"end":return function(e){t=o.getSelected(),n.row=t[2]+e.row,n.col=t[3]+e.col,i(e,n)}}},modifyRowHeight:function(t,o){return e.view.wt.wtTable.rowFilter&&P({row:o,col:null})?0:void 0},validateGroups:function(){for(var t=function(e,t){return e[0]<t[0]&&e[1]<t[1]&&t[0]<=e[1]||e[0]>t[0]&&t[1]<e[1]&&e[0]<=t[1]?!0:void 0},o=e.getSettings().groups,n=[],r=[],i=0,s=o.length;s>i;i++)if(o[i].rows){if(1===o[i].rows.length)throw new Error("Grouping error:  Group {"+o[i].rows[0]+"} is invalid. Cannot define single-entry groups.");if(0===o[i].rows.length)throw new Error("Grouping error:  Cannot define empty groups.");r.push(o[i].rows);for(var a=0,l=r.length;l>a;a++)if(t(o[i].rows,r[a]))throw new Error("Grouping error:  ranges {"+o[i].rows[0]+", "+o[i].rows[1]+"} and {"+r[a][0]+", "+r[a][1]+"} are overlapping.")}else if(o[i].cols){if(1===o[i].cols.length)throw new Error("Grouping error:  Group {"+o[i].cols[0]+"} is invalid. Cannot define single-entry groups.");if(0===o[i].cols.length)throw new Error("Grouping error:  Cannot define empty groups.");n.push(o[i].cols);for(var a=0,c=n.length;c>a;a++)if(t(o[i].cols,n[a]))throw new Error("Grouping error:  ranges {"+o[i].cols[0]+", "+o[i].cols[1]+"} and {"+n[a][0]+", "+n[a][1]+"} are overlapping.")}return!0},afterGetRowHeaderRenderers:function(e){t.Grouping.groupIndicatorsFactory(e,"vertical")},afterGetColumnHeaderRenderers:function(e){t.Grouping.groupIndicatorsFactory(e,"horizontal")},hookProxy:function(o,n){return function(){return e.getSettings().groups?n?t.Grouping[o](n).apply(this,arguments):t.Grouping[o].apply(this,arguments):void 0}}}},B=function(){var e=this,o=!!e.getSettings().groups;if(o){var n={};t.Grouping=new tt(e),e.getSettings().rowHeaders||(n.rowHeaders=!0),e.getSettings().colHeaders||(n.colHeaders=!0),(n.colHeaders||n.rowHeaders)&&e.updateSettings(n);var r=t.Grouping.validateGroups();if(!r)return;e.addHook("beforeInit",t.Grouping.hookProxy("init")),e.addHook("afterUpdateSettings",t.Grouping.hookProxy("updateGroups")),e.addHook("afterGetColumnHeaderRenderers",t.Grouping.hookProxy("afterGetColumnHeaderRenderers")),e.addHook("afterGetRowHeaderRenderers",t.Grouping.hookProxy("afterGetRowHeaderRenderers")),e.addHook("afterGetRowHeader",t.Grouping.hookProxy("afterGetRowHeader")),e.addHook("afterGetColHeader",t.Grouping.hookProxy("afterGetColHeader")),e.addHook("beforeOnCellMouseDown",t.Grouping.hookProxy("toggleGroupVisibility")),e.addHook("modifyTransformStart",t.Grouping.hookProxy("modifySelectionFactory","start")),e.addHook("modifyTransformEnd",t.Grouping.hookProxy("modifySelectionFactory","end")),e.addHook("modifyRowHeight",t.Grouping.hookProxy("modifyRowHeight"))}},ot=function(){for(var e=document.querySelectorAll("colgroup"),o=0,n=e.length;n>o;o++){var r=e[o].querySelectorAll("col.rowHeader");if(0==r.length)return;for(var i=0,s=r.length+1;s>i;i++){if(2==s)return;i<t.Grouping.getLevels().rows+1&&(i==t.Grouping.getLevels().rows?t.Dom.addClass(r[i],"htGroupColClosest"):t.Dom.addClass(r[i],"htGroupCol"))}}};t.hooks.add("beforeInit",B),t.hooks.add("afterUpdateSettings",function(){this.getSettings().groups&&!t.Grouping?B.call(this,arguments):!this.getSettings().groups&&t.Grouping&&(t.Grouping.resetGroups(),t.Grouping=void 0)}),t.plugins.Grouping=tt,function(e){function t(){this.zeroClipboardInstance=null,this.instance=null}t.prototype.prepareZeroClipboard=function(){this.swfPath&&ZeroClipboard.config({swfPath:this.swfPath})},t.prototype.copy=function(){return this.instance.copyPaste.setCopyableText(),this.instance.copyPaste.copyPasteInstance.elTextarea.value},t.prototype.addToContextMenu=function(t){this.getSettings().contextMenuCopyPaste&&t.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},e.ContextMenu.SEPARATOR)},t.prototype.setupZeroClipboard=function(t){var n=this;if(this.cmInstance=t,e.Dom.hasClass(this.cmInstance.rootElement,"htContextMenu"))for(var r=t.getData(),i=0,s=r.length;s>i;i++)if("copy"===r[i].key){this.zeroClipboardInstance=new ZeroClipboard(t.getCell(i,0)),this.zeroClipboardInstance.off(),this.zeroClipboardInstance.on("copy",function(e){var t=e.clipboardData;t.setData("text/plain",n.copy()),n.instance.getSettings().outsideClickDeselects=n.outsideClickDeselectsCache}),o.bindEvents();break}},t.prototype.bindEvents=function(){var t=this;if(t.cmInstance){var o=new e.eventManager(this.instance),n=function(){var o=t.cmInstance.rootElement.querySelector("td.current");o&&e.Dom.removeClass(o,"current"),t.outsideClickDeselectsCache=t.instance.getSettings().outsideClickDeselects,t.instance.getSettings().outsideClickDeselects=!1},r=function(){var o=t.cmInstance.rootElement.querySelector("td.zeroclipboard-is-hover");o&&e.Dom.removeClass(o,"zeroclipboard-is-hover"),t.instance.getSettings().outsideClickDeselects=t.outsideClickDeselectsCache};o.removeEventListener(document,"mouseenter",function(){n()}),o.addEventListener(document,"mouseenter",function(){n()}),o.removeEventListener(document,"mouseleave",function(){r()}),o.addEventListener(document,"mouseleave",function(){r()})}},t.prototype.init=function(){if(this.getSettings().contextMenuCopyPaste){if("object"==typeof this.getSettings().contextMenuCopyPaste&&(o.swfPath=this.getSettings().contextMenuCopyPaste.swfPath),"undefined"==typeof ZeroClipboard)throw new Error("To be able to use the Copy/Paste feature from the context menu, you need to manualy include ZeroClipboard.js file to your website.");try{{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}}catch(e){if("undefined"==typeof navigator.mimeTypes["application/x-shockwave-flash"])throw new Error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}o.instance=this,o.prepareZeroClipboard()}};var o=new t;e.hooks.add("afterRender",function(){o.setupZeroClipboard(this)}),e.hooks.add("afterInit",o.init),e.hooks.add("afterContextMenuDefaultOptions",o.addToContextMenu),e.ContextMenuCopyPaste=t}(t),function(e){function t(t){this.instance=t,this.dragged=[],this.eventManager=e.eventManager(t),this.bindTouchEvents()}t.prototype.getCurrentRangeCoords=function(e,t,o,n,r){var i=e.getTopLeftCorner(),s=e.getBottomRightCorner(),a=e.getBottomLeftCorner(),l=e.getTopRightCorner(),c={start:null,end:null};switch(o){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":c="topLeft"==r?{start:new u(t.row,e.highlight.col),end:new u(a.row,t.col)}:{start:new u(e.highlight.row,t.col),end:new u(t.row,i.col)};break;case"SE-NW":"bottomRight"==r&&(c={start:new u(s.row,t.col),end:new u(t.row,i.col)})}break;case"NW-SE":switch(n){case"NE-SW":"topLeft"==r?c={start:t,end:a}:c.end=t;break;case"NW-SE":"topLeft"==r?c={start:t,end:s}:c.end=t;break;case"SE-NW":"topLeft"==r?c={start:t,end:i}:c.end=t;break;case"SW-NE":"topLeft"==r?c={start:t,end:l}:c.end=t}break;case"SW-NE":switch(n){case"NW-SE":c="bottomRight"==r?{start:new u(t.row,i.col),end:new u(a.row,t.col)}:{start:new u(i.row,t.col),end:new u(t.row,s.col)};break;case"SW-NE":c="topLeft"==r?{start:new u(e.highlight.row,t.col),end:new u(t.row,s.col)}:{start:new u(t.row,i.col),end:new u(i.row,t.col)};break;case"SE-NW":"bottomRight"==r?c={start:new u(t.row,l.col),end:new u(i.row,t.col)}:"topLeft"==r&&(c={start:a,end:t})}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"==r&&(c.end=t);break;case"SE-NW":"topLeft"==r?c.end=t:c={start:t,end:i}}}return c},t.prototype.bindTouchEvents=function(){var t=this,o=function(e){if(1==this.dragged.length)return this.dragged=[],!0;var t=this.dragged.indexOf(e);return-1==t?!1:void(0==t?this.dragged=this.dragged.slice(0,1):1==t&&(this.dragged=this.dragged.slice(-1)))};this.eventManager.addEventListener(this.instance.rootElement,"touchstart",function(o){if(e.Dom.hasClass(o.target,"topLeftSelectionHandle-HitArea")){t.dragged.push("topLeft");var n=t.instance.getSelectedRange();return t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},o.preventDefault(),!1}if(e.Dom.hasClass(o.target,"bottomRightSelectionHandle-HitArea")){t.dragged.push("bottomRight");var n=t.instance.getSelectedRange();return t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},o.preventDefault(),!1}}),this.eventManager.addEventListener(this.instance.rootElement,"touchend",function(n){return e.Dom.hasClass(n.target,"topLeftSelectionHandle-HitArea")?(o.call(t,"topLeft"),t.touchStartRange=void 0,n.preventDefault(),!1):e.Dom.hasClass(n.target,"bottomRightSelectionHandle-HitArea")?(o.call(t,"bottomRight"),t.touchStartRange=void 0,n.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.instance.rootElement,"touchmove",function(o){var n=e.Dom.getWindowScrollTop(),r=e.Dom.getWindowScrollLeft();if(t.dragged.length>0){var i=document.elementFromPoint(o.touches[0].screenX-r,o.touches[0].screenY-n);if(!i)return;if("TD"==i.nodeName||"TH"==i.nodeName){var s=t.instance.getCoords(i);-1==s.col&&(s.col=0);var a=t.instance.getSelectedRange(),l=a.getWidth(),c=a.getHeight(),h=a.getDirection();1==l&&1==c&&t.instance.selection.setRangeEnd(s);var u=t.getCurrentRangeCoords(a,s,t.touchStartRange.direction,h,t.dragged[0]);null!=u.start&&t.instance.selection.setRangeStart(u.start),t.instance.selection.setRangeEnd(u.end)}o.preventDefault()}})},t.prototype.isDragged=function(){return 0==this.dragged.length?!1:!0};var o=function(){var o=this;e.plugins.multipleSelectionHandles=new t(o)};e.hooks.add("afterInit",o)}(t);var nt=function(){function e(){}return e.prototype.init=function(e){this.instance=e,this.bindEvents(),this.scrollbars=[this.instance.view.wt.wtScrollbars.vertical,this.instance.view.wt.wtScrollbars.horizontal,this.instance.view.wt.wtScrollbars.corner],this.clones=[this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.holder.parentNode,this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.holder.parentNode,this.instance.view.wt.wtScrollbars.corner.clone.wtTable.holder.parentNode]},e.prototype.bindEvents=function(){var e=this;this.instance.addHook("beforeTouchScroll",function(){t.freezeOverlays=!0;for(var o=0,n=e.clones.length;n>o;o++)t.Dom.addClass(e.clones[o],"hide-tween")}),this.instance.addHook("afterMomentumScroll",function(){t.freezeOverlays=!1;for(var o=0,n=e.clones.length;n>o;o++)t.Dom.removeClass(e.clones[o],"hide-tween");for(var o=0,n=e.clones.length;n>o;o++)t.Dom.addClass(e.clones[o],"show-tween");setTimeout(function(){for(var o=0,n=e.clones.length;n>o;o++)t.Dom.removeClass(e.clones[o],"show-tween")},400);for(var o=0,n=e.scrollbars.length;n>o;o++)e.scrollbars[o].refresh(),e.scrollbars[o].resetFixedPosition()})},e}(),rt=new nt;if(t.hooks.add("afterInit",function(){rt.init.call(rt,this)}),c.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE,this.fixed=this.instance.wtTable.hider,this.fixedContainer=this.instance.wtTable.holder,this.scrollHandler=this.getScrollableElement(this.TABLE)},c.prototype.makeClone=function(e){var t=document.createElement("DIV");t.className="ht_clone_"+e+" handsontable",t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.overflow="hidden";var o=document.createElement("TABLE");return o.className=this.instance.wtTable.TABLE.className,t.appendChild(o),this.instance.wtTable.holder.parentNode.appendChild(t),new g({cloneSource:this.instance,cloneOverlay:this,table:o})},c.prototype.getScrollableElement=function(t){for(var o=t.parentNode;o&&o.style;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;if(this instanceof R&&"visible"!==o.style.overflowX&&""!==o.style.overflowX)return o;o=o.parentNode}return e},c.prototype.refresh=function(e){this.clone&&this.clone.draw(e)},c.prototype.destroy=function(){var e=t.eventManager(this.clone);e.clear()},h.prototype.appear=function(e){var o,n,r,i,s,a,l,c,h,d,f,p;if(!this.disabled){var g,m,w,v,C,y,R,E=this.instance,T=function(){return!this.instance.selections.area.cellRange||w==this.instance.selections.area.cellRange.to.row&&v==this.instance.selections.area.cellRange.to.col?!1:!0},D=function(e,t,o,n){var r=parseInt(this.selectionHandles.styles.topLeft.width,10),i=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(e-r,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(t-r,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(e-i/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(t-i/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(e+n,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(t+o,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(e+n-i/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(t+o-i/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",T.call(this)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),g==this.instance.wtSettings.getSetting("fixedRowsTop")||m==this.instance.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")};for(y=E.cloneOverlay instanceof S||E.cloneOverlay instanceof b?E.getSetting("fixedRowsTop"):E.wtTable.getRenderedRowsCount(),C=0;y>C;C++)if(R=E.wtTable.rowFilter.renderedToSource(C),R>=e[0]&&R<=e[2]){g=R;break}for(C=y-1;C>=0;C--)if(R=E.wtTable.rowFilter.renderedToSource(C),R>=e[0]&&R<=e[2]){w=R;break}for(y=E.wtTable.getRenderedColumnsCount(),C=0;y>C;C++)if(R=E.wtTable.columnFilter.renderedToSource(C),R>=e[1]&&R<=e[3]){m=R;break}for(C=y-1;C>=0;C--)if(R=E.wtTable.columnFilter.renderedToSource(C),R>=e[1]&&R<=e[3]){v=R;break}if(void 0===g||void 0===m)return void this.disappear();o=g!==w||m!==v,n=E.wtTable.getCell(new u(g,m)),r=o?E.wtTable.getCell(new u(w,v)):n,i=t.Dom.offset(n),s=o?t.Dom.offset(r):i,a=t.Dom.offset(E.wtTable.TABLE),c=i.top,f=s.top+t.Dom.outerHeight(r)-c,d=i.left,p=s.left+t.Dom.outerWidth(r)-d,l=c-a.top-1,h=d-a.left-1;var k=t.Dom.getComputedStyle(n);parseInt(k.borderTopWidth,10)>0&&(l+=1,f=f>0?f-1:0),parseInt(k.borderLeftWidth,10)>0&&(h+=1,p=p>0?p-1:0),this.topStyle.top=l+"px",this.topStyle.left=h+"px",this.topStyle.width=p+"px",this.topStyle.display="block",this.leftStyle.top=l+"px",this.leftStyle.left=h+"px",this.leftStyle.height=f+"px",this.leftStyle.display="block";var A=Math.floor(this.settings.border.width/2);this.bottomStyle.top=l+f-A+"px",this.bottomStyle.left=h+"px",this.bottomStyle.width=p+"px",this.bottomStyle.display="block",this.rightStyle.top=l+"px",this.rightStyle.left=h+p-A+"px",this.rightStyle.height=f+1+"px",this.rightStyle.display="block",t.mobileBrowser||!this.hasSetting(this.settings.border.cornerVisible)||T.call(this)?this.cornerStyle.display="none":(this.cornerStyle.top=l+f-4+"px",this.cornerStyle.left=h+p-4+"px",this.cornerStyle.display="block"),t.mobileBrowser&&D.call(this,l,h,p,f)}},h.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",t.mobileBrowser&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")},h.prototype.hasSetting=function(e){return"function"==typeof e?e():!!e},u.prototype.isValid=function(e){return this.row<0||this.col<0?!1:this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns")?!1:!0},u.prototype.isEqual=function(e){return e===this?!0:this.row===e.row&&this.col===e.col},u.prototype.isSouthEastOf=function(e){return this.row>=e.row&&this.col>=e.col},u.prototype.isNorthWestOf=function(e){return this.row<=e.row&&this.col<=e.col},u.prototype.isSouthWestOf=function(e){return this.row>=e.row&&this.col<=e.col},u.prototype.isNorthEastOf=function(e){return this.row<=e.row&&this.col>=e.col},e.WalkontableCellCoords=u,d.prototype.isValid=function(e){return this.from.isValid(e)&&this.to.isValid(e)},d.prototype.isSingle=function(){return this.from.row===this.to.row&&this.from.col===this.to.col},d.prototype.getHeight=function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},d.prototype.getWidth=function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},d.prototype.includes=function(e){var t=this.getTopLeftCorner(),o=this.getBottomRightCorner();return e.row<0&&(e.row=0),e.col<0&&(e.col=0),t.row<=e.row&&o.row>=e.row&&t.col<=e.col&&o.col>=e.col},d.prototype.includesRange=function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())},d.prototype.isEqual=function(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)},d.prototype.overlaps=function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())},d.prototype.isSouthEastOf=function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)},d.prototype.isNorthWestOf=function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)},d.prototype.expand=function(e){var t=this.getTopLeftCorner(),o=this.getBottomRightCorner();return e.row<t.row||e.col<t.col||e.row>o.row||e.col>o.col?(this.from=new u(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new u(Math.max(o.row,e.row),Math.max(o.col,e.col)),!0):!1},d.prototype.expandByRange=function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getTopLeftCorner(),o=this.getBottomRightCorner(),n=(this.getTopRightCorner(),this.getBottomLeftCorner(),e.getTopLeftCorner()),r=e.getBottomRightCorner(),i=Math.min(t.row,n.row),s=Math.min(t.col,n.col),a=Math.max(o.row,r.row),l=Math.max(o.col,r.col),c=new u(i,s),h=new u(a,l),f=new d(c,c,h).isCorner(this.from,e),p=e.isEqual(new d(c,c,h));return f&&!p&&(this.from.col>c.col&&(c.col=l,h.col=s),this.from.row>c.row&&(c.row=a,h.row=i)),this.from=c,this.to=h,!0},d.prototype.getDirection=function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},d.prototype.setDirection=function(e){switch(e){case"NW-SE":this.from=this.getTopLeftCorner(),this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner(),this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner(),this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner(),this.to=this.getTopRightCorner()}},d.prototype.getTopLeftCorner=function(){return new u(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},d.prototype.getBottomRightCorner=function(){return new u(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},d.prototype.getTopRightCorner=function(){return new u(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},d.prototype.getBottomLeftCorner=function(){return new u(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},d.prototype.isCorner=function(e,t){return t&&t.includes(e)&&(this.getTopLeftCorner().isEqual(new u(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new u(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new u(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new u(t.to.row,t.to.col)))?!0:e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner())
},d.prototype.getOppositeCorner=function(e,t){if(!(e instanceof u))return!1;if(t&&t.includes(e)){if(this.getTopLeftCorner().isEqual(new u(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new u(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new u(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new u(t.to.row,t.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},d.prototype.getBordersSharedWith=function(e){if(!this.includesRange(e))return[];var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},n=[];return t.top==o.top&&n.push("top"),t.right==o.right&&n.push("right"),t.bottom==o.bottom&&n.push("bottom"),t.left==o.left&&n.push("left"),n},d.prototype.getInner=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),o=[],n=e.row;n<=t.row;n++)for(var r=e.col;r<=t.col;r++)this.from.row===n&&this.from.col===r||this.to.row===n&&this.to.col===r||o.push(new u(n,r));return o},d.prototype.getAll=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),o=[],n=e.row;n<=t.row;n++)for(var r=e.col;r<=t.col;r++)o.push(e.row===n&&e.col===r?e:t.row===n&&t.col===r?t:new u(n,r));return o},d.prototype.forAll=function(e){for(var t=this.getTopLeftCorner(),o=this.getBottomRightCorner(),n=t.row;n<=o.row;n++)for(var r=t.col;r<=o.col;r++){var i=e(n,r);if(i===!1)return}},e.WalkontableCellRange=d,f.prototype.offsetted=function(e){return e+this.offset},f.prototype.unOffsetted=function(e){return e-this.offset},f.prototype.renderedToSource=function(e){return this.offsetted(e)},f.prototype.sourceToRendered=function(e){return this.unOffsetted(e)},f.prototype.offsettedTH=function(e){return e-this.countTH},f.prototype.unOffsettedTH=function(e){return e+this.countTH},f.prototype.visibleRowHeadedColumnToSourceColumn=function(e){return this.renderedToSource(this.offsettedTH(e))},f.prototype.sourceColumnToVisibleRowHeadedColumn=function(e){return this.unOffsettedTH(this.sourceToRendered(e))},p.prototype.getContainerSize=function(){return"function"==typeof this.containerSizeFn?this.containerSizeFn():this.containerSizeFn},p.prototype.getSize=function(e){return this.cellSizes[e]+(this.cellStretch[e]||0)},p.prototype.stretch=function(){var e=this.getContainerSize(),t=0;if(this.remainingSize=this.cellSizesSum-e,this.cellStretch.length=0,"all"===this.strategy){if(this.remainingSize<0){for(var o,n=e/this.cellSizesSum;t<this.cellCount-1;)o=Math.floor(n*this.cellSizes[t]),this.remainingSize+=o-this.cellSizes[t],this.cellStretch[t]=o-this.cellSizes[t],t++;this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0}}else"last"===this.strategy&&this.remainingSize<0&&1/0!==e&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)},p.prototype.countVisible=function(){return this.visibleCellCount},p.prototype.isLastIncomplete=function(){var e=this.instance.wtTable.getFirstVisibleRow(),o=this.instance.wtTable.getLastVisibleColumn(),n=this.instance.wtTable.getCell(new u(e,o)),r=t.Dom.offset(n),i=t.Dom.outerWidth(n),s=r.left+i,a=this.instance.wtScrollbars.vertical.getScrollPosition(),l=this.instance.wtViewport.getViewportWidth(),c=a+l;return c>=s},g.prototype.draw=function(e){return this.drawInterrupted=!1,e||t.Dom.isVisible(this.wtTable.TABLE)?(this.wtTable.draw(e),this):void(this.drawInterrupted=!0)},g.prototype.getCell=function(e,t){if(t){var o=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedColumnsLeft");return e.row<o&&e.col<n?this.wtScrollbars.corner.clone.wtTable.getCell(e):e.row<o?this.wtScrollbars.vertical.clone.wtTable.getCell(e):e.col<n?this.wtScrollbars.horizontal.clone.wtTable.getCell(e):this.wtTable.getCell(e)}return this.wtTable.getCell(e)},g.prototype.update=function(e,t){return this.wtSettings.update(e,t)},g.prototype.scrollVertical=function(e){return this.wtScrollbars.vertical.scrollTo(e),this.getSetting("onScrollVertically"),this},g.prototype.scrollHorizontal=function(e){return this.wtScrollbars.horizontal.scrollTo(e),this.getSetting("onScrollHorizontally"),this},g.prototype.scrollViewport=function(e){return this.wtScroll.scrollViewport(e),this},g.prototype.getViewport=function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},g.prototype.getSetting=function(e,t,o,n,r){return this.wtSettings.getSetting(e,t,o,n,r)},g.prototype.hasSetting=function(e){return this.wtSettings.has(e)},g.prototype.destroy=function(){this.wtScrollbars.destroy(),this.wtEvent&&this.wtEvent.destroy()},m.prototype=new c,m.prototype.destroy=function(){c.prototype.destroy.call(this),clearTimeout(this.lastTimeout)},w.prototype.parentCell=function(e){var o={},n=this.instance.wtTable.TABLE,r=t.Dom.closest(e,["TD","TH"],n);return r&&t.Dom.isChildOf(r,n)?(o.coords=this.instance.wtTable.getCoords(r),o.TD=r):t.Dom.hasClass(e,"wtBorder")&&t.Dom.hasClass(e,"current")?(o.coords=this.instance.selections.current.cellRange.highlight,o.TD=this.instance.wtTable.getCell(o.coords)):t.Dom.hasClass(e,"wtBorder")&&t.Dom.hasClass(e,"area")&&this.instance.selections.area.cellRange&&(o.coords=this.instance.selections.area.cellRange.to,o.TD=this.instance.wtTable.getCell(o.coords)),o},e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){return e.setTimeout(t,1e3/60)}}(),e.cancelRequestAnimFrame=function(){return e.cancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}(),e.getComputedStyle||!function(){var t,o={getPropertyValue:function(e){return"float"==e&&(e="styleFloat"),t.currentStyle[e.toUpperCase()]||null}};e.getComputedStyle=function(e){return t=e,o}}(),!String.prototype.trim){var it=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(it,"")}}C.prototype.offsetted=function(e){return e+this.offset},C.prototype.unOffsetted=function(e){return e-this.offset},C.prototype.renderedToSource=function(e){return this.offsetted(e)},C.prototype.sourceToRendered=function(e){return this.unOffsetted(e)},C.prototype.offsettedTH=function(e){return e-this.countTH},C.prototype.visibleColHeadedRowToSourceRow=function(e){return this.renderedToSource(this.offsettedTH(e))},C.prototype.sourceRowToVisibleColHeadedRow=function(e){return this.unOffsettedTH(this.sourceToRendered(e))},y.prototype.scrollViewport=function(e){if(this.instance.drawn){var t=this.instance.getSetting("totalRows"),o=this.instance.getSetting("totalColumns");if(e.row<0||e.row>t-1)throw new Error("row "+e.row+" does not exist");if(e.col<0||e.col>o-1)throw new Error("column "+e.col+" does not exist");e.row>this.instance.wtTable.getLastVisibleRow()?this.instance.wtScrollbars.vertical.scrollTo(e.row,!0):e.row>=this.instance.getSetting("fixedRowsTop")&&e.row<this.instance.wtTable.getFirstVisibleRow()&&this.instance.wtScrollbars.vertical.scrollTo(e.row),e.col>=this.instance.wtTable.getLastVisibleColumn()?this.instance.wtScrollbars.horizontal.scrollTo(e.col,!0):e.col>=this.instance.getSetting("fixedColumnsLeft")&&e.col<this.instance.wtTable.getFirstVisibleColumn()&&this.instance.wtScrollbars.horizontal.scrollTo(e.col)}},b.prototype=new c,b.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var o=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){var n,r,i=this.instance.wtTable.holder.getBoundingClientRect(),s=Math.ceil(i.top),a=Math.ceil(i.left),l=Math.ceil(i.bottom),c=Math.ceil(i.right);n=0>a&&c-o.offsetWidth>0?-a+"px":"0",r=0>s&&l-o.offsetHeight>0?-s+"px":"0"}else t.freezeOverlays||(n=this.instance.wtScrollbars.horizontal.getScrollPosition()+"px",r=this.instance.wtScrollbars.vertical.getScrollPosition()+"px");t.Dom.setOverlayPosition(o,n,r),o.style.width=t.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px",o.style.height=t.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},R.prototype=new c,R.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var o=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){var n,r,i=this.instance.wtTable.holder.getBoundingClientRect(),s=Math.ceil(i.left),a=Math.ceil(i.right);n=0>s&&a-o.offsetWidth>0?-s+"px":"0",r=this.instance.wtTable.hider.style.top}else t.freezeOverlays||(n=this.getScrollPosition()+"px",r=this.instance.wtTable.hider.style.top);t.Dom.setOverlayPosition(o,n,r),o.style.height=t.Dom.outerHeight(this.clone.wtTable.TABLE)+"px",o.style.width=t.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px"}},R.prototype.refresh=function(e){this.applyToDOM(),c.prototype.refresh.call(this,e)},R.prototype.getScrollPosition=function(){return t.Dom.getScrollLeft(this.scrollHandler)},R.prototype.setScrollPosition=function(o){this.scrollHandler===e?e.scrollTo(o,t.Dom.getWindowScrollTop()):this.scrollHandler.scrollLeft=o},R.prototype.onScroll=function(){this.instance.getSetting("onScrollHorizontally")},R.prototype.sumCellSizes=function(e,t){for(var o=0;t>e;)o+=this.instance.wtTable.getStretchedColumnWidth(e)||this.instance.wtSettings.defaultColumnWidth,e++;return o},R.prototype.applyToDOM=function(){var e=this.instance.getSetting("totalColumns"),t=this.instance.wtViewport.getRowHeaderWidth();if(this.fixedContainer.style.width=t+this.sumCellSizes(0,e)+"px","number"==typeof this.instance.wtViewport.columnsRenderCalculator.startPosition)this.fixed.style.left=this.instance.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.fixed.style.left="0"}this.fixed.style.right=""},R.prototype.scrollTo=function(e,t){var o=this.getTableParentOffset();if(t)o+=this.sumCellSizes(0,e+1),o-=this.instance.wtViewport.getViewportWidth();else{var n=this.instance.getSetting("fixedColumnsLeft");o+=this.sumCellSizes(n,e)}this.setScrollPosition(o)},R.prototype.getTableParentOffset=function(){return this.scrollHandler===e?this.instance.wtTable.holderOffset.left:0},S.prototype=new c,S.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var o=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){var n,r,i=this.instance.wtTable.holder.getBoundingClientRect(),s=Math.ceil(i.top),a=Math.ceil(i.bottom);n=this.instance.wtTable.hider.style.left,r=0>s&&a-o.offsetHeight>0?-s+"px":"0"}else t.freezeOverlays||(r=this.getScrollPosition()+"px",n=this.instance.wtTable.hider.style.left);t.Dom.setOverlayPosition(o,n,r),o.style.width=this.instance.wtScrollbars.horizontal.scrollHandler===e?this.instance.wtViewport.getWorkspaceActualWidth()+"px":t.Dom.outerWidth(this.clone.wtTable.TABLE)+"px",o.style.height=t.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},S.prototype.getScrollPosition=function(){return t.Dom.getScrollTop(this.scrollHandler)},S.prototype.setScrollPosition=function(o){this.scrollHandler===e?e.scrollTo(t.Dom.getWindowScrollLeft(),o):this.scrollHandler.scrollTop=o},S.prototype.onScroll=function(){this.instance.getSetting("onScrollVertically")},S.prototype.sumCellSizes=function(e,t){for(var o=0;t>e;)o+=this.instance.wtTable.getRowHeight(e)||this.instance.wtSettings.settings.defaultRowHeight,e++;return o},S.prototype.refresh=function(e){this.applyToDOM(),c.prototype.refresh.call(this,e)},S.prototype.applyToDOM=function(){var e=this.instance.getSetting("totalRows"),t=this.instance.wtViewport.getColumnHeaderHeight();if(this.fixedContainer.style.height=t+this.sumCellSizes(0,e)+"px","number"==typeof this.instance.wtViewport.rowsRenderCalculator.startPosition)this.fixed.style.top=this.instance.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.fixed.style.top="0"}this.fixed.style.bottom=""},S.prototype.scrollTo=function(e,t){var o=this.getTableParentOffset();if(t)o+=this.sumCellSizes(0,e+1),o-=this.instance.wtViewport.getViewportHeight();else{var n=this.instance.getSetting("fixedRowsTop");o+=this.sumCellSizes(n,e)}this.setScrollPosition(o)},S.prototype.getTableParentOffset=function(){return this.scrollHandler===e?this.instance.wtTable.holderOffset.top:0},E.prototype.registerListeners=function(){var o=this;this.refreshAll=function(){if(o.instance.drawn){if(!o.instance.wtTable.holder.parentNode)return void o.destroy();o.instance.draw(!0),o.vertical.onScroll(),o.horizontal.onScroll()}};var n=t.eventManager(o.instance);n.addEventListener(this.vertical.scrollHandler,"scroll",this.refreshAll),this.vertical.scrollHandler!==this.horizontal.scrollHandler&&n.addEventListener(this.horizontal.scrollHandler,"scroll",this.refreshAll),this.vertical.scrollHandler!==e&&this.horizontal.scrollHandler!==e&&n.addEventListener(e,"scroll",this.refreshAll)},E.prototype.destroy=function(){var o=t.eventManager(this.instance);this.vertical&&(this.vertical.destroy(),o.removeEventListener(this.vertical.scrollHandler,"scroll",this.refreshAll)),this.horizontal&&(this.horizontal.destroy(),o.removeEventListener(this.horizontal.scrollHandler,"scroll",this.refreshAll)),o.removeEventListener(e,"scroll",this.refreshAll),this.corner&&this.corner.destroy(),this.debug&&this.debug.destroy()},E.prototype.refresh=function(e){this.horizontal&&this.horizontal.refresh(e),this.vertical&&this.vertical.refresh(e),this.corner&&this.corner.refresh(e),this.debug&&this.debug.refresh(e)},E.prototype.applyToDOM=function(){this.horizontal&&this.horizontal.applyToDOM(),this.vertical&&this.vertical.applyToDOM()},T.prototype.getBorder=function(e){return this.instanceBorders[e.guid]?this.instanceBorders[e.guid]:void(this.instanceBorders[e.guid]=new h(e,this.settings))},T.prototype.isEmpty=function(){return null===this.cellRange},T.prototype.add=function(e){this.isEmpty()?this.cellRange=new d(e,e,e):this.cellRange.expand(e)},T.prototype.replace=function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1},T.prototype.clear=function(){this.cellRange=null},T.prototype.getCorners=function(){var e=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]},T.prototype.addClassAtCoords=function(e,o,n,r){var i=e.wtTable.getCell(new u(o,n));"object"==typeof i&&t.Dom.addClass(i,r)},T.prototype.draw=function(e){var o,n,r,i,s,a=this,l=e.wtTable.getRenderedRowsCount(),c=e.wtTable.getRenderedColumnsCount();if(this.isEmpty())return void(this.settings.border&&(i=this.getBorder(e),i&&i.disappear()));o=this.getCorners();for(var h=0;c>h;h++)r=e.wtTable.columnFilter.renderedToSource(h),r>=o[1]&&r<=o[3]&&(s=e.wtTable.getColumnHeader(r),s&&a.settings.highlightColumnClassName&&t.Dom.addClass(s,a.settings.highlightColumnClassName));for(var u=0;l>u;u++){n=e.wtTable.rowFilter.renderedToSource(u),n>=o[0]&&n<=o[2]&&(s=e.wtTable.getRowHeader(n),s&&a.settings.highlightRowClassName&&t.Dom.addClass(s,a.settings.highlightRowClassName));for(var h=0;c>h;h++)r=e.wtTable.columnFilter.renderedToSource(h),n>=o[0]&&n<=o[2]&&r>=o[1]&&r<=o[3]?a.settings.className&&a.addClassAtCoords(e,n,r,a.settings.className):n>=o[0]&&n<=o[2]?a.settings.highlightRowClassName&&a.addClassAtCoords(e,n,r,a.settings.highlightRowClassName):r>=o[1]&&r<=o[3]&&a.settings.highlightColumnClassName&&a.addClassAtCoords(e,n,r,a.settings.highlightColumnClassName)}e.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&(i=this.getBorder(e),i&&i.appear(o))},D.prototype.update=function(e,t){if(void 0===t)for(var o in e)e.hasOwnProperty(o)&&(this.settings[o]=e[o]);else this.settings[e]=t;return this.instance},D.prototype.getSetting=function(e,t,o,n,r){return"function"==typeof this.settings[e]?this.settings[e](t,o,n,r):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]},D.prototype.has=function(e){return!!this.settings[e]},k.prototype.isWorkingOnClone=function(){return!!this.instance.cloneSource},k.prototype.draw=function(e){if(this.isWorkingOnClone()||(this.holderOffset=t.Dom.offset(this.holder),e=this.instance.wtViewport.createRenderCalculators(e)),e)this.isWorkingOnClone()||this.instance.wtViewport.createVisibleCalculators(),this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!0);else{this.tableOffset=this.isWorkingOnClone()?this.instance.cloneSource.wtTable.tableOffset:t.Dom.offset(this.TABLE);var o;o=this.instance.cloneOverlay instanceof m||this.instance.cloneOverlay instanceof S||this.instance.cloneOverlay instanceof b?0:this.instance.wtViewport.rowsRenderCalculator.startRow;var n;n=this.instance.cloneOverlay instanceof m||this.instance.cloneOverlay instanceof R||this.instance.cloneOverlay instanceof b?0:this.instance.wtViewport.columnsRenderCalculator.startColumn,this.rowFilter=new C(o,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length),this.columnFilter=new f(n,this.instance.getSetting("totalColumns"),this.instance.getSetting("rowHeaders").length),this._doDraw()}return this.refreshSelections(e),this.isWorkingOnClone()||(this.instance.wtScrollbars.vertical.resetFixedPosition(),this.instance.wtScrollbars.horizontal.resetFixedPosition(),this.instance.wtScrollbars.corner.resetFixedPosition()),this.instance.drawn=!0,this},k.prototype._doDraw=function(){var e=new A(this);e.render()},k.prototype.removeClassFromCells=function(e){for(var o=this.TABLE.querySelectorAll("."+e),n=0,r=o.length;r>n;n++)t.Dom.removeClass(o[n],e)},k.prototype.refreshSelections=function(e){var t,o;if(this.instance.selections){if(o=this.instance.selections.length,e)for(t=0;o>t;t++)this.instance.selections[t].settings.className&&this.removeClassFromCells(this.instance.selections[t].settings.className),this.instance.selections[t].settings.highlightRowClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightRowClassName),this.instance.selections[t].settings.highlightColumnClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightColumnClassName);for(t=0;o>t;t++)this.instance.selections[t].draw(this.instance,e)}},k.prototype.getCell=function(e){if(this.isRowBeforeRenderedRows(e.row))return-1;if(this.isRowAfterRenderedRows(e.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e.row)];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]:void 0},k.prototype.getColumnHeader=function(e){var t=this.THEAD.childNodes[0];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]:void 0},k.prototype.getRowHeader=function(e){if(0==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return t?t.childNodes[0]:void 0},k.prototype.getCoords=function(e){var o=e.parentNode,n=t.Dom.index(o);return n=o.parentNode===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(n):this.rowFilter.renderedToSource(n),new u(n,this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex))},k.prototype.getTrForRow=function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]},k.prototype.getFirstRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.startRow},k.prototype.getFirstVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.startRow},k.prototype.getFirstRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.startColumn},k.prototype.getFirstVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.startColumn},k.prototype.getLastRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.endRow},k.prototype.getLastVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.endRow},k.prototype.getLastRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.endColumn},k.prototype.getLastVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.endColumn},k.prototype.isRowBeforeRenderedRows=function(e){return this.rowFilter.sourceToRendered(e)<0&&e>=0},k.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()},k.prototype.isRowAfterRenderedRows=function(e){return e>this.getLastRenderedRow()},k.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToRendered(e)<0&&e>=0},k.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()},k.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.getLastRenderedRow()},k.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn},k.prototype.getRenderedColumnsCount=function(){return this.instance.cloneOverlay instanceof m?this.instance.getSetting("totalColumns"):this.instance.cloneOverlay instanceof R||this.instance.cloneOverlay instanceof b?this.instance.getSetting("fixedColumnsLeft"):this.instance.wtViewport.columnsRenderCalculator.count},k.prototype.getRenderedRowsCount=function(){return this.instance.cloneOverlay instanceof m?this.instance.getSetting("totalRows"):this.instance.cloneOverlay instanceof S||this.instance.cloneOverlay instanceof b?this.instance.getSetting("fixedRowsTop"):this.instance.wtViewport.rowsRenderCalculator.count},k.prototype.getVisibleRowsCount=function(){return this.instance.wtViewport.rowsVisibleCalculator.count},k.prototype.allRowsInViewport=function(){return this.instance.getSetting("totalRows")==this.getVisibleRowsCount()},k.prototype.getRowHeight=function(e){var t=this.instance.wtSettings.settings.rowHeight(e),o=this.instance.wtViewport.oversizedRows[e];return void 0!==o&&(t=t?Math.max(t,o):o),t},k.prototype.getVisibleColumnsCount=function(){return this.instance.wtViewport.columnsVisibleCalculator.count},k.prototype.allColumnsInViewport=function(){return this.instance.getSetting("totalColumns")==this.getVisibleColumnsCount()},k.prototype.getColumnWidth=function(e){var t=this.instance.wtSettings.settings.columnWidth;"function"==typeof t?t=t(e):"object"==typeof t&&(t=t[e]);var o=this.instance.wtViewport.oversizedCols[e];return void 0!==o&&(t=t?Math.max(t,o):o),t},k.prototype.getStretchedColumnWidth=function(e){var t=this.instance.getSetting("totalColumns"),o=this.getColumnWidth(e)||this.instance.wtSettings.settings.defaultColumnWidth;return this.instance.wtViewport.columnsRenderCalculator&&(0!=this.instance.wtViewport.columnsRenderCalculator.stretchAllRatio?o*=this.instance.wtViewport.columnsRenderCalculator.stretchAllRatio:0!=this.instance.wtViewport.columnsRenderCalculator.stretchLastWidth&&e==t-1&&(o=this.instance.wtViewport.columnsRenderCalculator.stretchLastWidth)),o},A.prototype.render=function(){this.wtTable.isWorkingOnClone()||this.instance.getSetting("beforeDraw",!0),this.rowHeaders=this.instance.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.instance.getSetting("fixedRowsTop"),this.columnHeaders=this.instance.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var e,t,o=this.instance.getSetting("totalRows"),n=this.instance.getSetting("totalColumns"),r=!1,i=this.wtTable.getRenderedRowsCount();if(n>0&&(this.adjustAvailableNodes(),r=!0,this.renderColGroups(),this.renderColumnHeaders(),e=this.wtTable.getRenderedColumnsCount(),this.renderRows(o,i,e),this.wtTable.isWorkingOnClone()||(t=this.instance.wtViewport.getWorkspaceWidth(),this.instance.wtViewport.containerWidth=null),this.adjustColumnWidths(e)),r||this.adjustAvailableNodes(),this.removeRedundantRows(i),!this.wtTable.isWorkingOnClone()){if(this.markOversizedRows(),this.instance.wtViewport.createVisibleCalculators(),this.instance.wtScrollbars.applyToDOM(),t!==this.instance.wtViewport.getWorkspaceWidth()){this.instance.wtViewport.containerWidth=null;for(var s=this.wtTable.getFirstRenderedColumn(),a=this.wtTable.getLastRenderedColumn(),l=s;a>l;l++){var c=this.wtTable.getStretchedColumnWidth(l),h=this.columnFilter.sourceToRendered(l);this.COLGROUP.childNodes[h+this.rowHeaderCount].style.width=c+"px"}}this.instance.wtScrollbars.refresh(!1),this.instance.getSetting("onDraw",!0)}},A.prototype.removeRedundantRows=function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},A.prototype.renderRows=function(e,t,o){for(var n,r,i=0,s=this.rowFilter.renderedToSource(i),a=this.wtTable.isWorkingOnClone();e>s&&s>=0;){if(i>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==t&&i===t)break;if(r=this.getOrCreateTrForRow(i,r),this.renderRowHeaders(s,r),this.adjustColumns(r,o+this.rowHeaderCount),n=this.renderCells(s,r,o),a||this.resetOversizedRow(s),r.firstChild){var l=this.instance.wtTable.getRowHeight(s);r.firstChild.style.height=l?l+"px":""}i++,s=this.rowFilter.renderedToSource(i)}},A.prototype.resetOversizedRow=function(e){this.instance.wtViewport.oversizedRows&&this.instance.wtViewport.oversizedRows[e]&&(this.instance.wtViewport.oversizedRows[e]=void 0)},A.prototype.markOversizedRows=function(){for(var e,o,n,r,i=this.instance.wtTable.TBODY.childNodes.length;i;)i--,n=this.instance.wtTable.rowFilter.renderedToSource(i),e=this.instance.wtTable.getRowHeight(n),r=this.instance.wtTable.getTrForRow(n),o=t.Dom.innerHeight(r)-1,(!e&&this.instance.wtSettings.settings.defaultRowHeight<o||o>e)&&(this.instance.wtViewport.oversizedRows[n]=o)},A.prototype.renderCells=function(e,o,n){for(var r,i,s=0;n>s;s++)i=this.columnFilter.renderedToSource(s),r=0===s?o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)]:r.nextSibling,"TH"==r.nodeName&&(r=this.utils.replaceThWithTd(r,o)),t.Dom.hasClass(r,"hide")||(r.className=""),r.removeAttribute("style"),this.instance.wtSettings.settings.cellRenderer(e,i,r);return r},A.prototype.adjustColumnWidths=function(e){var t;this.instance.wtViewport.columnsRenderCalculator.refreshStretching(this.instance.wtViewport.getViewportWidth());for(var o=0;e>o;o++)t=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(o)),this.COLGROUP.childNodes[o+this.rowHeaderCount].style.width=t+"px"},A.prototype.appendToTbody=function(e){this.TBODY.appendChild(e),this.wtTable.tbodyChildrenLength++},A.prototype.getOrCreateTrForRow=function(e,t){var o;return e>=this.wtTable.tbodyChildrenLength?(o=this.createRow(),this.appendToTbody(o)):o=0===e?this.TBODY.firstChild:t.nextSibling,o},A.prototype.createRow=function(){for(var e=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)e.appendChild(document.createElement("TH"));return e},A.prototype.renderRowHeader=function(e,t,o){o.className="",o.removeAttribute("style"),this.rowHeaders[t](e,o,t)},A.prototype.renderRowHeaders=function(e,t){for(var o=t.firstChild,n=0;n<this.rowHeaderCount;n++)o?"TD"==o.nodeName&&(o=this.utils.replaceTdWithTh(o,t)):(o=document.createElement("TH"),t.appendChild(o)),this.renderRowHeader(e,n,o),o=o.nextSibling},A.prototype.adjustAvailableNodes=function(){this.adjustColGroups(),this.adjustThead()},A.prototype.renderColumnHeaders=function(){if(this.columnHeaderCount)for(var e,t,o=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(e=this.getTrForColumnHeaders(n),t=-1*this.rowHeaderCount;o>t;t++){var r=this.columnFilter.renderedToSource(t);this.renderColumnHeader(n,r,e.childNodes[t+this.rowHeaderCount])}},A.prototype.adjustColGroups=function(){for(var e=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--},A.prototype.adjustThead=function(){var e=this.wtTable.getRenderedColumnsCount(),o=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,r=this.columnHeaders.length;r>n;n++){for(o=this.THEAD.childNodes[n],o||(o=document.createElement("TR"),this.THEAD.appendChild(o)),this.theadChildrenLength=o.childNodes.length;this.theadChildrenLength<e+this.rowHeaderCount;)o.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+this.rowHeaderCount;)o.removeChild(o.lastChild),this.theadChildrenLength--}var i=this.THEAD.childNodes.length;if(i>this.columnHeaders.length)for(var n=this.columnHeaders.length;i>n;n++)this.THEAD.removeChild(this.THEAD.lastChild)}else o&&t.Dom.empty(o)},A.prototype.getTrForColumnHeaders=function(e){var t=this.THEAD.childNodes[e];return t},A.prototype.renderColumnHeader=function(e,t,o){return o.className="",o.removeAttribute("style"),this.columnHeaders[e](t,o,e)},A.prototype.renderColGroups=function(){for(var e=0;e<this.wtTable.colgroupChildrenLength;e++)e<this.rowHeaderCount?t.Dom.addClass(this.COLGROUP.childNodes[e],"rowHeader"):t.Dom.removeClass(this.COLGROUP.childNodes[e],"rowHeader")},A.prototype.adjustColumns=function(e,t){for(var o=e.childNodes.length;t>o;){var n=document.createElement("TD");e.appendChild(n),o++}for(;o>t;)e.removeChild(e.lastChild),o--},A.prototype.removeRedundantColumns=function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},A.utils={},A.utils.replaceTdWithTh=function(e,t){var o;return o=document.createElement("TH"),t.insertBefore(o,e),t.removeChild(e),o},A.utils.replaceThWithTd=function(e,t){var o=document.createElement("TD");return t.insertBefore(o,e),t.removeChild(e),o},H.prototype.getWorkspaceHeight=function(){var o=this.instance.wtScrollbars.vertical.scrollHandler;if(o===e)return document.documentElement.clientHeight;var n=t.Dom.outerHeight(o),r=n>0&&o.clientHeight>0?o.clientHeight:1/0;return r},H.prototype.getWorkspaceWidth=function(){var o,n=this.instance.getSetting("totalColumns"),r=this.instance.wtScrollbars.horizontal.scrollHandler;if(o=t.freezeOverlays?Math.min(document.documentElement.offsetWidth-this.getWorkspaceOffset().left,document.documentElement.offsetWidth):Math.min(this.getContainerFillWidth(),document.documentElement.offsetWidth-this.getWorkspaceOffset().left,document.documentElement.offsetWidth),r===e&&n>0&&this.sumColumnWidths(0,n-1)>o)return document.documentElement.clientWidth;if(r!==e){var i=this.instance.wtScrollbars.horizontal.scrollHandler.style.overflow;if("scroll"==i||"hidden"==i||"auto"==i)return Math.max(o,r.clientWidth)}return Math.max(o,t.Dom.outerWidth(this.instance.wtTable.TABLE))},H.prototype.sumColumnWidths=function(e,t){for(var o=0;t>e;)o+=this.instance.wtTable.getColumnWidth(e)||this.instance.wtSettings.defaultColumnWidth,e++;return o},H.prototype.getContainerFillWidth=function(){if(this.containerWidth)return this.containerWidth;for(var e,t,o=this.instance.wtTable.holder;o.parentNode!=document.body&&null!=o.parentNode&&-1===o.className.indexOf("handsontable");)o=o.parentNode;return t=document.createElement("DIV"),t.style.width="100%",t.style.height="1px",o.appendChild(t),e=t.offsetWidth,this.containerWidth=e,o.removeChild(t),e},H.prototype.getWorkspaceOffset=function(){return t.Dom.offset(this.instance.wtTable.TABLE)},H.prototype.getWorkspaceActualHeight=function(){return t.Dom.outerHeight(this.instance.wtTable.TABLE)},H.prototype.getWorkspaceActualWidth=function(){return t.Dom.outerWidth(this.instance.wtTable.TABLE)||t.Dom.outerWidth(this.instance.wtTable.TBODY)||t.Dom.outerWidth(this.instance.wtTable.THEAD)
},H.prototype.getColumnHeaderHeight=function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=t.Dom.outerHeight(this.instance.wtTable.THEAD)),this.columnHeaderHeight},H.prototype.getViewportHeight=function(){var e=this.getWorkspaceHeight();if(1/0===e)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e},H.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource)return this.instance.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length){var o=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var n=0,r=e.length;r>n;n++)o?(this.rowHeaderWidth+=t.Dom.outerWidth(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth},H.prototype.getViewportWidth=function(){var e=this.getWorkspaceWidth();if(1/0===e)return e;var t=this.getRowHeaderWidth();return t>0?e-t:e},H.prototype.createRowsCalculator=function(e){this.rowHeaderWidth=0/0;var t;t=this.instance.wtSettings.settings.renderAllRows?1/0:this.getViewportHeight();var o=this.instance.wtScrollbars.vertical.getScrollPosition()-this.instance.wtScrollbars.vertical.getTableParentOffset();0>o&&(o=0);var n=this.instance.getSetting("fixedRowsTop");if(n){var r=this.instance.wtScrollbars.vertical.sumCellSizes(0,n);o+=r,t-=r}var i=this;return new O(t,o,this.instance.getSetting("totalRows"),function(e){return i.instance.wtTable.getRowHeight(e)},e?null:this.instance.wtSettings.settings.viewportRowCalculatorOverride,e?!0:!1)},H.prototype.createColumnsCalculator=function(e){this.columnHeaderHeight=0/0;var t=this.getViewportWidth(),o=this.instance.wtScrollbars.horizontal.getScrollPosition()-this.instance.wtScrollbars.vertical.getTableParentOffset();0>o&&(o=0);var n=this.instance.getSetting("fixedColumnsLeft");if(n){var r=this.instance.wtScrollbars.horizontal.sumCellSizes(0,n);o+=r,t-=r}var i=this;return new x(t,o,this.instance.getSetting("totalColumns"),function(e){return i.instance.wtTable.getColumnWidth(e)},e?null:this.instance.wtSettings.settings.viewportColumnCalculatorOverride,e?!0:!1,this.instance.getSetting("stretchH"))},H.prototype.createRenderCalculators=function(e){if(e){var t=this.createRowsCalculator(!0),o=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e},H.prototype.createVisibleCalculators=function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},H.prototype.areAllProposedVisibleRowsAlreadyRendered=function(e){return this.rowsVisibleCalculator?e.startRow<this.rowsRenderCalculator.startRow||e.startRow===this.rowsRenderCalculator.startRow&&e.startRow>0?!1:e.endRow>this.rowsRenderCalculator.endRow||e.endRow===this.rowsRenderCalculator.endRow&&e.endRow<this.instance.getSetting("totalRows")-1?!1:!0:!1},H.prototype.areAllProposedVisibleColumnsAlreadyRendered=function(e){return this.columnsVisibleCalculator?e.startColumn<this.columnsRenderCalculator.startColumn||e.startColumn===this.columnsRenderCalculator.startColumn&&e.startColumn>0?!1:e.endColumn>this.columnsRenderCalculator.endColumn||e.endColumn===this.columnsRenderCalculator.endColumn&&e.endColumn<this.instance.getSetting("totalColumns")-1?!1:!0:!1},e.jQuery&&!function(e,t,o){t.fn.handsontable=function(e){var t,n,r,i,s,a=this.first(),l=a.data("handsontable");if("string"!=typeof e)return s=e||{},l?l.updateSettings(s):(l=new o.Core(a[0],s),a.data("handsontable",l),l.init()),a;if(r=[],arguments.length>1)for(t=1,n=arguments.length;n>t;t++)r.push(arguments[t]);if(l){if("undefined"==typeof l[e])throw new Error("Handsontable do not provide action: "+e);i=l[e].apply(l,r),"destroy"===e&&a.removeData()}return i}}(e,jQuery,t)}(window,Handsontable);